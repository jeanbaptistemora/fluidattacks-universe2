---
id: r046
title: Manage the integrity of critical files
sidebar_label: Manage the integrity of critical files
slug: /criteria/files/046
---

## Requirement

The system must verify and log changes
in the integrity of critical system files.

## References

- [CAPEC-13: Subverting Environment Variable Values:](https://capec.mitre.org/data/definitions/13.html)
The attacker directly or indirectly modifies environment variables
used by or controlling the target software.

- [CAPEC-23: File Content Injection:](https://capec.mitre.org/data/definitions/23.html)
An attack of this type exploits the host’s trust in executing remote content,
including binary files. The files are poisoned with a malicious payload
(targeting the file systems accessible by the target software) by the adversary
and may be passed through standard channels such as via email,
and standard web content like PDF and multimedia files.

- [CAPEC-35: Leverage Executable Code in Non-Executable Files:](https://capec.mitre.org/data/definitions/35.html)
An attack of this type exploits a system’s trust in configuration
and resource files. When the executable loads the resource
(such as an image file or configuration file) the attacker has modified
the file to either execute malicious code directly
or manipulate the target process (e.g., application server)
to execute based on the malicious configuration parameters.

- [CAPEC-38: Leveraging/Manipulating Configuration File Search Paths:](https://capec.mitre.org/data/definitions/38.html)
This pattern of attack sees an adversary load a malicious resource
into a program’s standard path so that when a known command is executed
then the system instead executes the malicious component.
The adversary can either modify the search path a program uses,
like a **PATH** variable or classpath, or they can manipulate resources
on the path to point to their malicious components.

- [CAPEC-154: Resource Location Spoofing:](https://capec.mitre.org/data/definitions/154.html)
An adversary deceives an application or user
and convinces them to request a resource from an unintended location.
By spoofing the location, the adversary can cause an alternate resource
to be used, often one that the adversary controls
and can be used to help them achieve their malicious goals.

- [CAPEC-176: Configuration/Environment Manipulation:](https://capec.mitre.org/data/definitions/176.html)
An attacker manipulates files or settings external to a target application
which affect the behavior of that application.

- [CIS Controls. 5.3 Securely Store Master Images:](https://www.cisecurity.org/controls/)
Store the master images and templates on securely configured servers,
validated with integrity monitoring tools, to ensure that
only authorized changes to the images are possible.

- [CWE-778: Insufficient Logging:](https://cwe.mitre.org/data/definitions/778.html)
When a security-critical event occurs, the software either does not record
the event or omits important details about the event when logging it.

- [OWASP-ASVS v4.0.1 V14.1 Build.(14.1.5):](https://owasp.org/www-project-application-security-verification-standard/)
Verify that authorized administrators can verify the integrity
of all security-relevant configurations to detect tampering.

- [PCI DSS v3.2.1 - Requirement 10.2.2:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
Implement automated audit trails for all system components to reconstruct
all actions taken by any individual with root or administrative privileges.

- [PCI DSS v3.2.1 - Requirement 10.2.6:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
Implement automated audit trails for all system components
to reconstruct creation and deletion of system-level objects.

- [PCI DSS v3.2.1 - Requirement 10.4.2:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
Time data is protected.

- [PCI DSS v3.2.1 - Requirement 10.5.5:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
Use file-integrity monitoring or change-detection software on logs to ensure
that existing log data cannot be changed without generating alerts.
