---
id: r161
title: Define secure default options
sidebar_label: Define secure default options
slug: /criteria/requirements/161
---

## Requirement

The source code must have secure default options
ensuring secure failures in the application
(**try, catch/except**; *default* for *switches*).

## Description

The organization must ensure
that its own systems and those of third parties
are safe and fully comply with the functions
for which they were implemented.
For this,
baselines must be implemented from the design
and development phase,
in order to avoid bad practices in the development cycles,
e.g., the use of a conditional
without a default option,
which can cause unexpected behaviors in the system.

The system's source code
is safer when good programming practices
are implemented from the development stage,
ensuring the portability
and maintenance of the application.
If a system is difficult to maintain,
vulnerabilities are more prone to arise.

## Implementation

1. Definition of baselines
from design/architecture stages
in order to guarantee the implementation
of good programming practices
in the development of the source code.

2. Quality code and source code vulnerability scanners:
These are tools that perform code revision
using lexical and syntactical analyzers.
They process it,
suggest improvements and highlight possible vulnerabilities
in the development stage.
Using this kind of tools
during the development process
helps improve performance,
detect excessively complex logic
and detect potential security issues.

## Attacks

1. Cause unexpected behaviors in the application.
2. Leak sensitive information from unexpected errors.

## Attributes

- Layer: Application layer
- Asset: Source code
- Scope: Maturity
- Phase: Building
- Type of control: Recommendation

## Vulnerabilities

- [060. Insecure exceptions](/criteria/vulnerabilities/060)

- [061. Errors without traceability](/criteria/vulnerabilities/061)

- [073. Conditional statement without a default option](/criteria/vulnerabilities/073)

## References

- [CAPEC-24: Filter Failure through Buffer Overflow:](http://capec.mitre.org/data/definitions/24.html)
In this attack,
the idea is to cause an active filter
to fail by causing an oversized transaction.
An attacker may try
to feed overly long input strings
to the program in an attempt to overwhelm the filter
(by causing a buffer overflow)
and hoping that the filter does not fail securely
(i.e., the user input is let into the system unfiltered).

- [CAPEC-28: Fuzzing:](http://capec.mitre.org/data/definitions/28.html)
In this attack pattern,
the adversary leverages fuzzing
to try to identify weaknesses in the system.
Fuzzing is a software security
and functionality testing method
that feeds randomly constructed input to the system
and looks for an indication
that a failure in response to that input has occurred.

- [CWE-396: Declaration of Catch for Generic Exception:](https://cwe.mitre.org/data/definitions/396.html)
Catching overly broad exceptions
promotes complex error handling code
that is more likely to contain security vulnerabilities.

- [CWE-397: Declaration of Throws for Generic Exception:](https://cwe.mitre.org/data/definitions/397.html)
Throwing overly broad exceptions
promotes complex error handling code
that is more likely to contain security vulnerabilities.

- [CWE-478: Missing Default Case in Switch Statement:](https://cwe.mitre.org/data/definitions/478.html)
The code does not have a default case
in a switch statement,
which might lead to complex logical errors
and resultant weaknesses.

- [CWE-544: Missing Standardized Error Handling Mechanism:](https://cwe.mitre.org/data/definitions/544.html)
The software does not use a standardized method
for handling errors throughout the code,
which might introduce inconsistent error handling
and resultant weaknesses.

- [IEEE: Standard for Software Reviews and Audits:](https://standards.ieee.org/findstds/standard/1028-2008.html)
Five types of software reviews and audits,
together with procedures required
for the execution of each type,
are defined in this standard.

- [OWASP-ASVS v4.0.1 V4.1 General Access Control Design.(4.1.5):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
Verify that access controls fail securely
including when an exception occurs.

- [OWASP-ASVS v4.0.1 V6.2 Algorithms.(6.2.1):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
Verify that all cryptographic modules fail securely,
and errors are handled
in a way that does not enable **Padding Oracle** attacks.

- [OWASP-ASVS v4.0.1 V7.4 Error Handling.(7.4.2):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
Verify that exception handling (or a functional equivalent)
is used across the codebase to account
for expected and unexpected error conditions.

- [OWASP-ASVS v4.0.1 V7.4 Error Handling.(7.4.3):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
Verify that a "last resort" error handler
is defined which will catch all unhandled exceptions.

- [PCI DSS v3.2.1 - Requirement 6.5.5:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
Address common coding vulnerabilities
in software-development processes
such as improper error handling.
