---
id: r347
title: Invalidate previous OTPs
sidebar_label: Invalidate previous OTPs
slug: /criteria/requirements/347
---

## Requirement

The system must invalidate previously generated **OTP**s
when the generation of a new one
is triggered.

## Description

One-time passwords (*OTP*) are secrets used
during operations that need added security
or as part of user enrollment processes.
Despite their short lifespan,
only one *OTP* should be valid at any given time,
and therefore,
all previous **OTP**s
should be invalidated
whenever a new one is generated.

## References

- [CWE-287: Improper Authentication:](https://cwe.mitre.org/data/definitions/287.html)
  When an actor claims to have
  a given identity,
  the software does not prove
  or insufficiently proves
  that the claim is correct.

- [CWE-307: Improper Restriction of Excessive Authentication Attempts:](https://cwe.mitre.org/data/definitions/307.html)
  The software does not implement
  sufficient measures to prevent
  multiple failed authentication attempts
  within a short time frame,
  making it more susceptible
  to brute force attacks.

- [OWASP Top 10 A2:2017-Broken Authentication:](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication)
  Application functions related to authentication
  and session management
  are often implemented incorrectly,
  allowing attackers to compromise passwords,
  keys, or session tokens,
  or to exploit other implementation flaws
  'to assume other users' identities
  temporarily or permanently.

- [OWASP-ASVS v4.0.1 V2.2 General Authenticator Requirements.(2.2.1):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
  Verify that anti-automation controls
  are effective at mitigating breached
  credential testing, brute force,
  and account lockout attacks.
  Such controls include blocking
  the most common breached passwords,
  soft lockouts, rate limiting, CAPTCHA,
  ever increasing delays between attempts,
  IP address restrictions,
  or risk-based restrictions such as location,
  first login on a device,
  recent attempts to unlock the account,
  or similar.
  Verify that no more than
  100 failed attempts per hour
  is possible on a single account.

- [OWASP-ASVS v4.0.1 V2.6 Look-up Secret Verifier Requirements.(2.6.1):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
  Verify that lookup secrets can be used only once.

- [OWASP-ASVS v4.0.1 V2.8 Single or Multi Factor One Time Verifier Requirements.(2.8.4):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
  Verify that time-based **OTP**s
  can be used only once
  within the validity period.

- [OWASP-ASVS v4.0.1 V3.2 Session Binding Requirements.(3.2.1):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
  Verify the application generates
  a new session token on user authentication.

- [PCI DSS v3.2.1 - Requirement 6.5.10:](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)
  Address common coding vulnerabilities
  in software-development processes
  such as broken authentication
  and session management.
