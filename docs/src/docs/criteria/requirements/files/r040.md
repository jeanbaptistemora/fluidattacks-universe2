---
id: r040
title: Compare file format and extension
sidebar_label: Compare file format and extension
slug: /criteria/requirements/040
---

## Requirement

The system must validate
that the format (structure) of the files
corresponds to their extension.

## Vulnerabilities

- [027. Insecure file upload](/criteria/vulnerabilities/027)

## References

- [CAPEC-11: Cause Web Server Misclassification:](http://capec.mitre.org/data/definitions/11.html)
An attack of this type exploits
a Web server's decision to take action
based on filename or file extension.
Because different file types
are handled by different server processes,
misclassification may force the Web server
to take unexpected action,
or expected actions
in an unexpected sequence.

- [CAPEC-165: File Manipulation:](http://capec.mitre.org/data/definitions/165.html)
An attacker modifies file contents
or attributes (such as extensions or names)
of files in a manner to cause incorrect processing
by an application.

- [CWE-434: Unrestricted Upload of File with Dangerous Type:](https://cwe.mitre.org/data/definitions/434.html)
The software allows the attacker to upload
or transfer files of dangerous types
that can be automatically processed
within the product's environment.

- [CWE-646: Reliance on File Name or Extension of Externally-Supplied File:](https://cwe.mitre.org/data/definitions/646.html)
The software allows a file to be uploaded,
but it relies on the file name
or extension of the file to determine
the appropriate behaviors.
This could be used by attackers
to cause the file to be misclassified
and processed in a dangerous fashion.

- [OWASP-ASVS v4.0.1 V12.2 File Integrity Requirements.(12.2.1):](https://owasp.org/www-pdf-archive/OWASP_Application_Security_Verification_Standard_4.0-en.pdf)
Verify that files obtained
from untrusted sources are validated to be
of expected type based
on the file's content.
