---
id: sca
title: SCA
sidebar_label: SCA
slug: /development/skims/guidelines/sca
---

To detect vulnerable packages,
a DynamoDB table has been built
that contains the reports
or advisories of vulnerable packages versions
for multiple package managers
(such as pip, maven, npm, etc),
given this,
the SCA module has the task of querying
and returning these advisories given a package and its version.

For cases external to the organization,
a bucket was also created in S3
which contains the basic information of the advisories,
this allows the SCA module to work
when there are no valid credentials present to use the table in DynamoDB.

## Scheduler

A scheduler (skims_update_sca_table) was created to fetch reports
from multiple sources
and store them in our database
and S3 bucket in our format for the SCA module to use.
Each advisory has the following attributes:

- associated_advisory (the advisory id obtained from the source)
- package_name (the package name)
- package_manager (such as pip, npm, maven, etc)
- vulnerable_version (vulnerable versions or ranges separated by `||`)
- severity ([CVSS v3.\* Base Metrics](https://www.first.org/cvss/v3.1/specification-document#Base-Metrics))
- source (the source of the data. It is `MANUAL` if is a manual advisory)
- created_at (Automatically generated creation date)
- modified_at (Automatically generated update date)

This scheduler runs every day at 5 am Colombian time.

## Manual Reports

Manual reports will have priority over those generated by the scheduler,
so if there is a generated report with the same identifier as a manual report
(except for the `source` attribute) then it will be ignored.

Manual reports are used to:

- Add additional advisories that are not present in our supported sources.
- Fix advisories generated by the scheduler that contain incorrect information.
- Fix false positives generated by the scheduler.

For false positive cases, the report must be added to the database
with `vulnerable_version='<0'`,
so the vulnerability will no longer be reported
since there are no versions lower than 0.

### How to create Manual Reports

The following command allows you to create, update or remove reports.
To execute this command you must have the role of `prod_skims`,
otherwise, you will not be able to use it:

```sh
$ m . /skims/sca/patch <add | update | remove> <path_to_file>
```

The last parameter of the command is the path to a `.json` file
that contains the information of the advisories for each action,
which must contain a list with said advisories given the following structure:

```json
[
  {
    "associated_advisory": "CVE-ADVISORY-1",
    "package_name": "package_name_1",
    "package_manager": "gem",
    "vulnerable_version": ">=2.0 <=2.3.2 || >=2.4.0 <2.12.2 || >=2.13.0 <2.15.0",
    "source": "MANUAL",
    "severity": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  },
  {
    "associated_advisory": "CVE-ADVISORY-2",
    "package_name": "package_name_2",
    "package_manager": "npm",
    "vulnerable_version": "<0",
    "source": "MANUAL",
    "severity": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  }
]
```

Depending on the action it is not necessary to use all the attributes
(`created_at` and `modified_at` are not required in any case):

- `add` or `update`: You can omit the `source` attribute
  since it is only allowed to use the command for manual reports,
  so that attribute will take the value of `MANUAL`.
- `remove`: To remove an advisory, only those attributes
  that identify it are needed (`package_name`, `package_manager`,
  `associated_advisory` and `source`),
  for this case, it is possible to remove those generated by the scheduler
  (for the special case that it has been removed from the source)
  that is the reason why the `source` attribute is needed.
