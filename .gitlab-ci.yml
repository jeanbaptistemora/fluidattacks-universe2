image: registry.gitlab.com/fluidsignal/blog

before_script:
  - cd content/
  - if egrep -r 'Fluid|Fluidsignal\ Group|fluidsignal'; then echo "El Ãºnico nombre aceptado es FLUID"; exit 1; fi
  - cd ../

deploy:
  environment: production	
  script:
    - pelican --fatal errors content/
    - aws s3 rm --recursive s3://blog.fluid.la
    - aws s3 cp --recursive --acl=public-read-write output/ s3://blog.fluid.la
  only:
     - master

pages:
  environment: staging
  script:
    - sed -i 's/https:\/\/fluid.la\/site/\/blog/' pelicanconf.py
    - pelican --fatal errors -o public/ content/
  artifacts:
    paths:
      - public/
  except:
    - master
