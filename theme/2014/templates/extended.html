{% extends "base.html" %}

{% block meta %}
<meta name="description"
      content="{{ page.description }}">
<meta name="keywords"
      content="{{ page.keywords }}">
{% endblock meta %}

{% block title %}
  {% set TITLE = 0 %}
  {% if DEFAULT_LANG == "en" %}
    {% if page.title|length < 23 %}
{{ page.title }} | {{ SITENAME }}
      {% set TITLE = 1 %}
    {% endif %}
  {% elif DEFAULT_LANG == "es" %}
    {% if page.title|length < 11 %}
{{ page.title }} | {{ SITENAME }}
      {% set TITLE =1 %}
    {% endif %}
  {% endif %}
  {% if TITLE == 0 %}
{{ page.title }} | {{ AUTHOR }}
  {% endif %}
{% endblock title %}

{% block breadcrumb%}
  <!-- navcontent-container -->
  <div class="pv0 ph2 shadow-4">
    <!-- navcontent-info -->
    <div class="df ma-auto">
      <div class="montsy f6-l f7 tl ttc w-70-l w-100 ma-auto">
        <ul class="dib list w-100">
          <li class="dib mt0">
            <a class="c-fluid-bk hv-fluid-dkred"
               href="{{ SITEURL }}/">
              <strong>{{ gettext('Breadcrumb-0') }}</strong>&nbsp;
            </a>
            <span class="c-fluid-red v-mid b">&gt;</span>
          </li>
          <li class="dib mt0">
            <a class="c-fluid-bk hv-fluid-dkred"
               href="{{ SITEURL }}/rules/">
              <strong>rules</strong>&nbsp;
            </a>
            <span class="c-fluid-red v-mid b">&gt;</span>
          </li>
          <li class="dib mt0">
            <a class="c-fluid-bk hv-fluid-dkred"
               href=".">&nbsp;{{ page.title }}</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
{% endblock breadcrumb %}

{% block canonical %}
  <link rel="canonical"
        href="{{ SITEURL }}/{{ page.url }}">
{% endblock canonical %}

{% block content %}
  <article class="ma-auto tl mw8 pb4">
    <h1 class="tc pb3">
      {{ page.title }}
    </h1>
    {{ page.content }}
    {% set rendered = [] %}
    {% for rulepath in pages if rulepath.rules and rulepath.extended %}
      {% if loop.first %}
        {% do rendered.append( rulepath.category ) %}
          <div class="rulescat hover-bg-light-gray flex">
            <h3 class="w-90">{{ rulepath.category |replace('-', ' ') | capitalize }}</h3>
            <img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/arrow.svg"
                 alt="Fluid Arrow">
          </div>
        {% set cat = rulepath.category %}
        <div class="ruleslist dn">
        {% for ruleart in pages if ruleart.rules and ruleart.category == cat %}
          <ul class="pl4">
             <li>
               <a class="f4 montsy"
                  href="../{{ ruleart.slug }}">
                  {{ ruleart.title }}
               </a><br>
             </li>
           </ul>
        {% endfor %}
        </div>
      {% else %}
        {% if rulepath.category != loop.previtem.category and rulepath.category not in rendered %}
          {% do rendered.append( rulepath.category ) %}
          <div class="rulescat hover-bg-light-gray flex">
            <h3 class="w-90">{{ rulepath.category |replace('-', ' ') | capitalize }}</h3>
            <img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/arrow.svg"
                 alt="Fluid Arrow">
          </div>
          {% set cat = rulepath.category %}
          <div class="ruleslist dn">
          {% for ruleart in pages if ruleart.rules and ruleart.extended and ruleart.category == cat %}
           <ul class="pl4">
              <li>
                <a class="f4 montsy"
                 href="../../{{ ruleart.slug }}">
                    {{ ruleart.title }}
                </a><br>
              </li>
            </ul>
          {% endfor %}
          </div>
        {% endif %}
      {% endif %}
    {% endfor %}
    {% assets filters="uglifyjs", output="static/js/rules.min.js", "js/rules.js" %}
      <script src="{{ SITEURL }}/{{ ASSET_URL }}"></script>
    {% endassets %}
  </article>
{% endblock content %}
