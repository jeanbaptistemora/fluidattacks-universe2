{% extends "index.html" %}

{% block meta %}
  <meta name="description" content="{{ page.description }}">
  <meta name="keywords" content="{{ page.keywords }}">
{% endblock meta %}

{% block title %}
  {% set TITLE = 0 %}
  {% if page.defends %}
{{ page.title }} | {{ page.category|capitalize }}
  {% set TITLE = 1 %}
  {% endif %}
  {% if DEFAULT_LANG == "en" and not TITLE %}
    {% if page.title|length < 23 %}
{{ page.title }} | {{ SITENAME }}
      {% set TITLE = 1 %}
    {% endif %}
  {% elif DEFAULT_LANG == "es" %}
    {% if page.title|length < 11 and not TITLE %}
{{ page.title }} | {{ SITENAME }}
      {% set TITLE =1 %}
    {% endif %}
  {% endif %}
  {% if TITLE == 0 %}
{{ page.title }} | {{ AUTHOR }}
  {% endif %}
{% endblock title %}

{% block canonical %}<link rel="canonical" href="{{ SITEURL }}/{{ page.url }}">{% endblock canonical %}

{% block language %}
  {% if DEFAULT_LANG == "en" %}
    <link rel="alternate" href="{{ SITEURL }}/{{ page.url }}" hreflang="en-us" />
    {% if page.translate %}
      <link rel="alternate" href="{{ SUBSITEURL }}/{{ page.translate }}" hreflang="es" />
    {% endif %}
  {% elif DEFAULT_LANG == "es" %}
    <link rel="alternate" href="{{ SITEURL }}/{{ page.url }}" hreflang="es" />
    {% if page.translate %}
      <link rel="alternate" href="{{ SUBSITEURL }}/{{ page.translate }}" hreflang="en-us" />
    {% endif %}
  {% endif %}
{% endblock language %}

{% block content %}
  <div class="divpage">
    <article>
      <div class="nav-info">
        <div class="breadcrumbs">
          <ul>
            <li><a href="{{ SITEURL }}/">{{ gettext('Breadcrumb-0') }} >>&nbsp;</a></li>
              {% if page.defends %}
                <li><a href="{{ SITEURL }}/defends/">Defends >>&nbsp;</a></li>
                <li><a href="{{ SITEURL }}/defends/#{{ page.category.name }}">{{ page.category }}</a></li>
              {% elif "misc" not in page.category.name %}
                {% if page.category2 %}
                  <li><a href="{{ SITEURL }}/{{ page.category.name }}/">{{ page.category }} >>&nbsp;</a></li>
                  <li><a href="{{ SITEURL }}/{{ page.category.name }}/{{ page.category2 }}/">{{ page.category2|replace('-', ' ') }}</a></li>
                {% else %}
                  <li><a href="{{ SITEURL }}/{{ page.category.name }}/">{{ page.category }}</a></li>
                {% endif %}
              {% endif %}
          </ul>
        </div>
        {% if DEFAULT_LANG == "en" %}
          {% if page.translate %}
            <div class="translate">
              <a href="{{ SITEURL }}/{{ page.url }}"><img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/en.png" alt="United States flag"></a>
              <a href="{{ SUBSITEURL }}/{{ page.translate }}"><img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/es.png" alt="Spain flag" class="translate-inactive"></a>
            </div>
          {% endif %}
        {% elif DEFAULT_LANG == "es" %}
          {% if page.translate %}
            <div class="translate">
              <a href="{{ SUBSITEURL }}/{{ page.translate }}"><img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/en.png" alt="United States flag" class="translate-inactive"></a>
              <a href="{{ SITEURL }}/{{ page.url }}"><img src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/images/es.png" alt="Spain flag"></a>
            </div>
          {% endif %}
        {% endif %}
      </div>
      <h1>{{ page.title }}</h1>
      {% if page.subtitle %}
        <span class="subtitle"><strong>{{ page.subtitle }}</strong></span>
      {% endif %}
      {% if page.rules or page.defends %}
        <div class="description">
          {{ page.description }}
        </div>
      {% endif %}
      {{ page.content }}
      {% if page.defendsindex %}
        {% include 'defends.html'%}
      {% endif %}
      <br>
      {% if page.defends %}
        {% for defendspage in pages if defendspage.defends and defendspage.category == page.category %}
          {% if defendspage.slug == page.slug and (loop.previtem != undefined or loop.nextitem != undefined) %}
            <div class="article-nav">
              <div class="prev-article">
                {% if loop.previtem != undefined %}
                  <div class="button"><a href="../../../{{ loop.previtem.slug }}"><< {{ loop.previtem.title }}</a></div>
                {% endif %}
              </div>
              <div class="next-article">
                {% if loop.nextitem != undefined %}
                  <div class="button"><a href="../../../{{ loop.nextitem.slug }}">{{ loop.nextitem.title }} >></a></div>
                {% endif %}
              </div>
            </div>
            <br>
          {% endif %}
        {% endfor %}
      {% endif %}
      {% if page.toc %}
        {% assets filters="uglifyjs", output="static/js/toc.min.js", "js/toc.js" %}
          <script type="text/javascript" src="{{ SITEURL }}/{{ ASSET_URL }}"></script>
      {% endassets %}
      {% endif %}
      {% if DISQUS_SITENAME and SITEURL and   page.defends %}
        <hr class="hrcoments">
        <div class="comments">
          <h3>{{ gettext('Page-disqus-sect') }}</h3>
          <div id="disqus_thread"></div>
          {% if DEFAULT_LANG == "es" %}
            <script type="text/javascript">
              var disqus_config = function () {
                this.page.identifier = "{{ page.slug }}";
                this.page.url = "{{ SITEURL }}/{{ page.url }}";
                this.language = "es_AR";
              };
              (function() {
                var d = document, dsq = d.createElement('script');
                dsq.src = 'https://{{ DISQUS_SITENAME }}.disqus.com/embed.js';
                dsq.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(dsq);
              })();
            </script>
          {% elif DEFAULT_LANG == "en" %}
            <script type="text/javascript">
              var disqus_config = function () {
                this.page.identifier = "{{ page.slug }}";
                this.page.url = "{{ SITEURL }}/{{ page.url }}";
              };
              (function() {
                var d = document, dsq = d.createElement('script');
                dsq.src = 'https://{{ DISQUS_SITENAME }}.disqus.com/embed.js';
                dsq.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(dsq);
              })();
            </script>
          {% endif %}
        </div>
        <script id="dsq-count-scr" src="//{{ DISQUS_SITENAME }}.disqus.com/count.js" async></script>
      {% endif %}
      {% if page.rules or page.defends %}
        <script type="application/ld+json">
          {
            "@context": "http://schema.org",
            "@type": "Article",
            "headline": "{{ page.title }}",
            "author": "{{ AUTHOR }}",
            "publisher": [{
              "@type": "Organization",
              "name": "{{ AUTHOR}}",
              "logo": "{{ SITEURL }}/theme/images/fluid-logo.png"
            }],
            "mainEntityOfPage": "{{ SITEURL }}/{{ page.url }}"
          }
        </script>
      {% endif %}
      <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "BreadcrumbList",
          "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "item": {
              "@id": "{{ SITEURL }}/",
              "name": "{{ gettext('Breadcrumb-0') }}"
            }
        {% if page.defends %}
          },{
            "@type": "ListItem",
            "position": 2,
            "item": {
              "@id": "{{ SITEURL }}/defends/",
              "name": "Defends"
            }
          },{
            "@type": "ListItem",
            "position": 3,
            "item": {
              "@id": "{{ SITEURL }}/defends/#{{ page.category.name }}/",
              "name": "{{ page.category|capitalize }}"
            }
        {% elif "misc" not in page.category.name %}
          {% if page.category2 %}
          },{
            "@type": "ListItem",
            "position": 2,
            "item": {
              "@id": "{{ SITEURL }}/{{ page.category.name }}/",
              "name": "{{ page.category|capitalize }}"
            }
          },{
            "@type": "ListItem",
            "position": 3,
            "item": {
              "@id": "{{ SITEURL }}//{{ page.category.name }}/{{ page.category2 }}/",
              "name": "{{ page.category2|capitalize }}/"
            }
          {% else %}
          },{
            "@type": "ListItem",
            "position": 2,
            "item": {
              "@id": "{{ SITEURL }}/{{ page.category.name }}/",
              "name": "{{ page.category|capitalize }}"
            }
          {% endif %}
        {% endif %}
          }]
        }
      </script>
    </article>
  </div>
{% endblock content %}
