import os
from fluidasserts.cloud import aws_iam
from fluidasserts.cloud import aws_ec2
from fluidasserts.cloud import aws_cloudtrail

KEY = os.environ['AWS_ACCESS_KEY_ID']
SECRET = os.environ['AWS_SECRET_ACCESS_KEY']

aws_iam.has_mfa_disabled(KEY, SECRET)
aws_iam.have_old_creds_enabled(KEY, SECRET)
aws_iam.have_old_access_keys(KEY, SECRET)
aws_iam.root_has_access_keys(KEY, SECRET)
aws_iam.not_requires_uppercase(KEY, SECRET)
aws_iam.not_requires_lowercase(KEY, SECRET)
aws_iam.not_requires_symbols(KEY, SECRET)
aws_iam.not_requires_numbers(KEY, SECRET)
aws_iam.min_password_len_unsafe(KEY, SECRET)
aws_iam.password_reuse_unsafe(KEY, SECRET)
aws_iam.password_expiration_unsafe(KEY, SECRET)
aws_iam.root_without_mfa(KEY, SECRET)
aws_iam.policies_attached_to_users(KEY, SECRET)

aws_ec2.seggroup_allows_anyone_to_ssh(KEY, SECRET)
aws_ec2.seggroup_allows_anyone_to_rdp(KEY, SECRET)
aws_ec2.default_seggroup_allows_all_traffic(KEY, SECRET)
aws_ec2.has_unencrypted_volumes(KEY, SECRET)

aws_cloudtrail.trails_not_multiregion(KEY, SECRET)

