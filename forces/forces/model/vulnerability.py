# SPDX-FileCopyrightText: 2022 Fluid Attacks <development@fluidattacks.com>
#
# SPDX-License-Identifier: MPL-2.0

from enum import (
    Enum,
)
from typing import (
    NamedTuple,
    Optional,
)


class VulnerabilityStateStatus(str, Enum):
    """Data structure to represent the Vulnerability state status"""

    CLOSED: str = "CLOSED"
    DELETED: str = "DELETED"
    OPEN: str = "OPEN"


class VulnerabilityTreatmentStatus(str, Enum):
    """Data structure to represent the Vulnerability treatment status"""

    ACCEPTED: str = "ACCEPTED"
    ACCEPTED_UNDEFINED: str = "ACCEPTED_UNDEFINED"
    IN_PROGRESS: str = "IN_PROGRESS"
    NEW: str = "NEW"


class VulnerabilityType(str, Enum):
    """Data structure to represent the Vulnerability type"""

    INPUTS: str = "INPUTS"
    LINES: str = "LINES"
    PORTS: str = "PORTS"


class VulnerabilityZeroRiskStatus(str, Enum):
    """Data structure to represent a Vulnerability"""

    CONFIRMED: str = "CONFIRMED"
    REJECTED: str = "REJECTED"
    REQUESTED: str = "REQUESTED"


class Vulnerability(NamedTuple):
    """Data structure to represent a Vulnerability"""

    finding_id: str
    current_state: VulnerabilityStateStatus
    treatment: VulnerabilityTreatmentStatus
    vulnerability_type: VulnerabilityType
    where: str
    severity: Optional[str]
    specific: str
    report_date: str
    root_nickname: str
    zero_risk: VulnerabilityZeroRiskStatus
