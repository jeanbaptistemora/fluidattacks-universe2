{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/criteria/vulnerabilities",
  "title": "Vulnerabilities",
  "description": "This is a standardization of the set of vulnerabilities that serve as a basis for the security analysis",
  "type": "object",
  "additionalProperties": false,
  "propertyNames": { "pattern": "^[0-9]+$" },
  "patternProperties": {
    "^[0-9]+$": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "en", "es", "score", "requirements", "metadata" ],
      "properties": {
        "en": { "$ref": "#/definitions/language" },
        "es": { "$ref": "#/definitions/language" },
        "score": { "$ref": "#/definitions/cvss" },
        "requirements": {
          "uniqueItems": true,
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[0-9]+$"
          }
        },
        "metadata": { "type": "object" }
      }
    }
  },
  "definitions": {
    "language": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "title", "description", "impact", "recommendation", "threat" ],
      "properties": {
        "title": { "type": "string" },
        "description": { "type": "string" },
        "impact": { "type": "string" },
        "recommendation": { "type": "string" },
        "threat": { "type": "string" }
      }
    },
    "cvss": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "base", "temporal" ],
      "properties": {
        "base": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "attack_vector",
            "attack_complexity",
            "privileges_required",
            "user_interaction",
            "scope",
            "confidentiality",
            "integrity",
            "availability"
          ],
          "properties": {
            "attack_vector": {
              "type": "string",
              "pattern": "^[NALP]$"
            },
            "attack_complexity": {
              "type": "string",
              "pattern": "^[LH]$"
            },
            "privileges_required": {
              "type": "string",
              "pattern": "^[NLH]$"
            },
            "user_interaction": {
              "type": "string",
              "pattern": "^[NR]$"
            },
            "scope": {
              "type": "string",
              "pattern": "^[UC]$"
            },
            "confidentiality": {
              "type": "string",
              "pattern": "^[NLH]$"
            },
            "integrity": {
              "type": "string",
              "pattern": "^[NLH]$"
            },
            "availability": {
              "type": "string",
              "pattern": "^[NLH]$"
            }
          }
        },
        "temporal": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "exploit_code_maturity",
            "remediation_level",
            "report_confidence"
          ],
          "properties": {
            "exploit_code_maturity": {
              "type": "string",
              "pattern": "^[XUPFH]$"
            },
            "remediation_level": {
              "type": "string",
              "pattern": "^[XOTWU]$"
            },
            "report_confidence": {
              "type": "string",
              "pattern": "^[XURC]$"
            }
          }
        }
      }
    }
  }
}
