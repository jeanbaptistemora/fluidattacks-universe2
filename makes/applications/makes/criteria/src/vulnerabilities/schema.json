{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "/criteria/vulnerabilities",
    "title": "Vulnerabilities",
    "description": "This is a standardization of the set of vulnerabilities that serve as a basis for the security analysis",
    "type": "object",
    "properties": {
        "id": {
            "description": "Vulnerability ID",
            "type": "string",
            "examples": ["055, 121, 001"],
            "minLength": 1,
            "maxLength": 3
        },
        "name": {
            "description": "Name of the vulnerability",
            "type": "string",
            "examples": ["Insecure service configuration"],
            "minLength": 1
        },
        "textDescription": {
            "description": "Description text about vulnerability",
            "type": "string",
            "minLength": 1
        },
        "details": {
            "type": "object",
            "properties": {
                "title":{
                    "description": "Title of vulnerability in details section",
                    "type": "string",
                    "examples": ["AWS EBS Encryption, AWS S3 Server Side Encryption"],
                    "minLength": 1
                },
                "detailDescription": {
                    "description": "Description of vulnerability in details section",
                    "type": "string",
                    "minLength": 1
                }
            },
            "additionalProperties": {"type": "string"}
        },
        "requirements": {
            "type": "object",
            "minProperties": 1,
            "properties": {
                "id": {
                    "description": "Requirement(s) associated to the vulnerability",
                    "type": "string",
                    "minLength": 1
                }
            }
        },
        "metadata": {
            "type": "object",
            "properties": {
                "id":{
                    "description": "Vulnerability name",
                    "type": "string",
                    "examples": ["insecure-service-configuration, insecure-functionality, etc"],
                    "minLength": 1
                },
                "sidebar_label": {
                    "description": "Sidebar label title",
                    "type": "string",
                    "examples": ["Insecure service configuration, Insecure functionality, etc"],
                    "minLength": 1
                },
                "slug": {
                    "description": "Slug's path",
                    "type": "string",
                    "examples": ["/criteria/vulnerability/002"],
                    "minLength": 1
                }
            }
        }
    },
    "required": ["id","name","textDescription","requirements", "metadata"],
    "additionalProperties": {"type": "string"},
    "minProperties": 4
}
