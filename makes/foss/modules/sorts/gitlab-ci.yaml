/deployTerraform/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  resource_group: $CI_JOB_NAME
  rules:
    - if: $CI_COMMIT_BRANCH != "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /deployTerraform/sorts
  stage: deploy-infra
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/lintPython/dirOfModules/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /lintPython/dirOfModules/sorts
  stage: lint-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/lintPython/imports/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /lintPython/imports/sorts
  stage: lint-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/lintPython/module/sortsTests:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /lintPython/module/sortsTests
  stage: lint-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/lintPython/module/sortsTraining:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /lintPython/module/sortsTraining
  stage: lint-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/lintTerraform/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /lintTerraform/sorts
  stage: lint-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/sorts/execute:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: false
  needs: []
  parallel: 15
  rules:
    - if: $CI_PIPELINE_SOURCE != "schedule"
      when: never
    - if: $sorts_execute == null
      when: never
    - when: always
  script:
    - m . /sorts/execute
  stage: test-code
  tags:
    - autoscaling-large
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/sorts/extract-features:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: false
  needs: []
  parallel: 15
  rules:
    - if: $CI_PIPELINE_SOURCE != "schedule"
      when: never
    - if: $sorts_extract_features == null
      when: never
    - when: always
  script:
    - m . /sorts/extract-features
  stage: pre-build
  tags:
    - autoscaling-large
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/sorts/merge-features:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: false
  needs:
    - /sorts/extract-features
  parallel: 15
  rules:
    - if: $CI_PIPELINE_SOURCE != "schedule"
      when: never
    - if: $sorts_extract_features == null
      when: never
    - when: always
  script:
    - m . /sorts/merge-features
  stage: build
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/sorts/train:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: false
  needs: []
  rules:
    - if: $CI_PIPELINE_SOURCE != "schedule"
      when: never
    - if: $sorts_train == null
      when: never
    - when: always
  script:
    - m . /sorts/train
  stage: deploy-app
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/sorts/tune:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: false
  needs:
    - /sorts/train
  rules:
    - if: $CI_PIPELINE_SOURCE != "schedule"
      when: never
    - if: $sorts_train == null
      when: never
    - when: always
  script:
    - m . /sorts/tune
  stage: post-deploy
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/testPython/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /testPython/sorts
  stage: test-code
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
/testTerraform/sorts:
  image: ghcr.io/fluidattacks/makes:21.12
  interruptible: true
  needs: []
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      when: never
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: never
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: never
    - if: $CI_PIPELINE_SOURCE == "trigger"
      when: never
    - if: $CI_COMMIT_TITLE =~ /^(all|sorts)/
  script:
    - m . /testTerraform/sorts
  stage: test-infra
  tags:
    - autoscaling
  variables:
    GIT_DEPTH: 1
    MAKES_GIT_DEPTH: 1
