import os
from fluidasserts.cloud.aws import iam
from fluidasserts.cloud.aws import ec2
from fluidasserts.cloud.aws import cloudtrail
from fluidasserts.cloud.aws import s3

KEY = os.environ['AWS_ACCESS_KEY_ID']
SECRET = os.environ['AWS_SECRET_ACCESS_KEY']

iam.has_mfa_disabled(KEY, SECRET)
iam.have_old_creds_enabled(KEY, SECRET)
iam.have_old_access_keys(KEY, SECRET)
iam.root_has_access_keys(KEY, SECRET)
iam.not_requires_uppercase(KEY, SECRET)
iam.not_requires_lowercase(KEY, SECRET)
iam.not_requires_symbols(KEY, SECRET)
iam.not_requires_numbers(KEY, SECRET)
iam.min_password_len_unsafe(KEY, SECRET)
iam.password_reuse_unsafe(KEY, SECRET)
iam.password_expiration_unsafe(KEY, SECRET)
iam.root_without_mfa(KEY, SECRET)
iam.policies_attached_to_users(KEY, SECRET)

ec2.seggroup_allows_anyone_to_ssh(KEY, SECRET)
ec2.seggroup_allows_anyone_to_rdp(KEY, SECRET)
ec2.default_seggroup_allows_all_traffic(KEY, SECRET)
ec2.has_unencrypted_volumes(KEY, SECRET)

cloudtrail.trails_not_multiregion(KEY, SECRET)

s3.has_server_access_logging_disabled(KEY, SECRET)
