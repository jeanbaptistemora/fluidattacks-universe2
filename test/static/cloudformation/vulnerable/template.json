{
  "Description": "vulnerable",
  "Resources": {
    "cluster1": {
      "Properties": {
        "BackupRetentionPeriod": 0,
        "Engine": "postgres",
        "StorageEncrypted": "false"
      },
      "Type": "AWS::RDS::DBCluster"
    },
    "instance1": {
      "Properties": {
        "BackupRetentionPeriod": "0",
        "DBInstanceClass": "t2.micro",
        "Engine": "postgres",
        "MasterUserPassword": "pass",
        "MasterUsername": "user",
        "PubliclyAccessible": "true",
        "StorageEncrypted": "false"
      },
      "Type": "AWS::RDS::DBInstance"
    },
    "key1": {
      "Properties": {
        "EnableKeyRotation": "false",
        "KeyPolicy": {}
      },
      "Type": "AWS::KMS::Key"
    },
    "mangedPolicy1": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "ecr:*"
              ],
              "Effect": "Allow",
              "Resource": [
                "*"
              ]
            },
            {
              "Action": "ecr:*",
              "Effect": "Allow",
              "Resource": "*"
            },
            {
              "Effect": "Allow",
              "NotAction": []
            },
            {
              "Effect": "Allow",
              "NotResource": []
            }
          ],
          "Version": "2012-10-17"
        },
        "Users": [
          "user1"
        ]
      },
      "Type": "AWS::IAM::ManagedPolicy"
    },
    "policy1": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "ecr:*"
              ],
              "Effect": "Allow",
              "Resource": [
                "*"
              ]
            },
            {
              "Action": "ecr:*",
              "Effect": "Allow",
              "Resource": "*"
            },
            {
              "Effect": "Allow",
              "NotAction": []
            },
            {
              "Effect": "Allow",
              "NotResource": []
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "policy1",
        "Users": [
          "user1"
        ]
      },
      "Type": "AWS::IAM::Policy"
    },
    "role1": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": [
                "ecr:*"
              ],
              "Effect": "Allow",
              "Resource": [
                "*"
              ]
            },
            {
              "Effect": "Allow",
              "NotAction": []
            },
            {
              "Effect": "Allow",
              "NotPrincipal": []
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          "arn:aws:iam::aws:policy/AdministratorAccess"
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "ecr:*"
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*"
                  ]
                },
                {
                  "Action": "ecr:*",
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Effect": "Allow",
                  "NotAction": []
                },
                {
                  "Effect": "Allow",
                  "NotResource": []
                }
              ],
              "Version": "2012-10-17"
            },
            "PolicyName": "policy1"
          }
        ]
      },
      "Type": "AWS::IAM::Role"
    },
    "secret1": {
      "Properties": {
        "GenerateSecretString": {
          "ExcludeCharacters": "01234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",
          "ExcludeLowercase": "true",
          "ExcludeNumbers": "true",
          "ExcludePunctuation": "true",
          "ExcludeUppercase": "true",
          "PasswordLength": 10,
          "RequireEachIncludedType": "false"
        }
      },
      "Type": "AWS::SecretsManager::Secret"
    },
    "securityGroup1": {
      "Properties": {
        "GroupDescription": "groupDescription1",
        "SecurityGroupIngress": [
          {
            "CidrIpv6": "::/0",
            "FromPort": 1,
            "IpProtocol": "-1",
            "ToPort": 65536
          },
          {
            "CidrIpv6": "123.123.123.0/24",
            "FromPort": 22,
            "IpProtocol": "-1",
            "ToPort": 22
          }
        ]
      },
      "Type": "AWS::EC2::SecurityGroup"
    },
    "user1": {
      "Properties": {
        "Policies": [
          {
            "Ref": "policy1"
          }
        ]
      },
      "Type": "AWS::IAM::User"
    }
  }
}