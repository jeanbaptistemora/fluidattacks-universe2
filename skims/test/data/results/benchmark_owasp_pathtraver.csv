finding,kind,what,where,cwe,stream,title,description,snippet
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00001.java,71,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00001.java,"
   61 |                     break;
   62 |                 }
   63 |             }
   64 |         }
   65 |
   66 |         String fileName = null;
   67 |         java.io.FileInputStream fis = null;
   68 |
   69 |         try {
   70 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + param;
>  71 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   72 |             byte[] b = new byte[1000];
   73 |             int size = fis.read(b);
   74 |             response.getWriter()
   75 |                     .println(
   76 |                             ""The beginning of file: '""
   77 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   78 |                                     + ""' is:\n\n""
   79 |                                     + org.owasp
   80 |                                             .esapi
   81 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00001.java,71,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00001.java,"
   61 |    break;
   62 |
   63 |
   64 |
   65 |
   66 | leName = null;
   67 | ileInputStream fis = null;
   68 |
   69 |
   70 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + param;
>  71 |  new java.io.FileInputStream(new java.io.File(fileName));
   72 | ] b = new byte[1000];
   73 | ize = fis.read(b);
   74 | nse.getWriter()
   75 |    .println(
   76 |            ""The beginning of file: '""
   77 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   78 |                    + ""' is:\n\n""
   79 |                    + org.owasp
   80 |                            .esapi
   81 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00002.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00002.java,"
  62 |                 }
  63 |             }
  64 |         }
  65 |
  66 |         String fileName = null;
  67 |         java.io.FileOutputStream fos = null;
  68 |
  69 |         try {
  70 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + param;
  71 |
> 72 |             fos = new java.io.FileOutputStream(fileName, false);
  73 |             response.getWriter()
  74 |                     .println(
  75 |                             ""Now ready to write to file: ""
  76 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  77 |
  78 |         } catch (Exception e) {
  79 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  80 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  81 |         } finally {
  82 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00011.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00011.java,"
  44 |    String param = """";
  45 |    java.util.Enumeration<String> headers = request.getHeaders(""BenchmarkTest00011"");
  46 |
  47 |    if (headers != null && headers.hasMoreElements()) {
  48 |        param = headers.nextElement(); // just grab first element
  49 |    }
  50 |
  51 |    // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  52 |    param = java.net.URLDecoder.decode(param, ""UTF-8"");
  53 |
> 54 |    java.io.File fileTarget = new java.io.File(param, ""/Test.txt"");
  55 |    response.getWriter()
  56 |            .println(
  57 |                    ""Access to file: '""
  58 |                            + org.owasp
  59 |                                    .esapi
  60 |                                    .ESAPI
  61 |                                    .encoder()
  62 |                                    .encodeForHTML(fileTarget.toString())
  63 |                            + ""' created."");
  64 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00028.java,57,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00028.java,"
  47 |             String[] values = map.get(""BenchmarkTest00028"");
  48 |             if (values != null) param = values[0];
  49 |         }
  50 |
  51 |         String fileName = null;
  52 |         java.io.FileOutputStream fos = null;
  53 |
  54 |         try {
  55 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + param;
  56 |
> 57 |             fos = new java.io.FileOutputStream(fileName, false);
  58 |             response.getWriter()
  59 |                     .println(
  60 |                             ""Now ready to write to file: ""
  61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  62 |
  63 |         } catch (Exception e) {
  64 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  65 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  66 |         } finally {
  67 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00040.java,49,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00040.java,"
  39 | ublic void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |        throws ServletException, IOException {
  41 |    // some code
  42 |    response.setContentType(""text/html;charset=UTF-8"");
  43 |
  44 |    org.owasp.benchmark.helpers.SeparateClassRequest scr =
  45 |            new org.owasp.benchmark.helpers.SeparateClassRequest(request);
  46 |    String param = scr.getTheParameter(""BenchmarkTest00040"");
  47 |    if (param == null) param = """";
  48 |
> 49 |    java.io.File fileTarget = new java.io.File(param);
  50 |    response.getWriter()
  51 |            .println(
  52 |                    ""Access to file: '""
  53 |                            + org.owasp
  54 |                                    .esapi
  55 |                                    .ESAPI
  56 |                                    .encoder()
  57 |                                    .encodeForHTML(fileTarget.toString())
  58 |                            + ""' created."");
  59 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00045.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00045.java,"
  52 | e the file first so the test won't throw an exception if it doesn't exist.
  53 |  Don't actually do this because this method signature could cause a tool to find
  54 | file constructor
  55 | vuln, rather than the File signature we are trying to actually test.
  56 | cessary, just run the benchmark twice. The 1st run should create all the necessary
  57 | .
  58 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR +
  59 | ).createNewFile();
  60 |
  61 | FileOutputStream fos =
> 62 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
  63 | onse.getWriter()
  64 |     .println(
  65 |             ""Now ready to write to file: ""
  66 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  67 |
  68 | (Exception e) {
  69 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  70 |
  71 |
  72 |
     ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00060.java,75,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00060.java,"
  65 |         String bar = """";
  66 |         if (param != null) {
  67 |             bar =
  68 |                     new String(
  69 |                             org.apache.commons.codec.binary.Base64.decodeBase64(
  70 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  71 |                                             param.getBytes())));
  72 |         }
  73 |
  74 |         java.io.File fileTarget =
> 75 |                 new java.io.File(
  76 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  77 |         response.getWriter()
  78 |                 .println(
  79 |                         ""Access to file: '""
  80 |                                 + org.owasp
  81 |                                         .esapi
  82 |                                         .ESAPI
  83 |                                         .encoder()
  84 |                                         .encodeForHTML(fileTarget.toString())
  85 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00061.java,74,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00061.java,"
  64 |
  65 |    String bar = """";
  66 |    if (param != null) {
  67 |        bar =
  68 |                new String(
  69 |                        org.apache.commons.codec.binary.Base64.decodeBase64(
  70 |                                org.apache.commons.codec.binary.Base64.encodeBase64(
  71 |                                        param.getBytes())));
  72 |    }
  73 |
> 74 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  75 |    response.getWriter()
  76 |            .println(
  77 |                    ""Access to file: '""
  78 |                            + org.owasp
  79 |                                    .esapi
  80 |                                    .ESAPI
  81 |                                    .encoder()
  82 |                                    .encodeForHTML(fileTarget.toString())
  83 |                            + ""' created."");
  84 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00062.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00062.java,"
   67 |         map77232.put(""keyA-77232"", ""a-Value""); // put some stuff in the collection
   68 |         map77232.put(""keyB-77232"", param); // put it in a collection
   69 |         map77232.put(""keyC"", ""another-Value""); // put some stuff in the collection
   70 |         bar = (String) map77232.get(""keyB-77232""); // get it back out
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileInputStream fis = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   78 |             byte[] b = new byte[1000];
   79 |             int size = fis.read(b);
   80 |             response.getWriter()
   81 |                     .println(
   82 |                             ""The beginning of file: '""
   83 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                                     + ""' is:\n\n""
   85 |                                     + org.owasp
   86 |                                             .esapi
   87 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00062.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00062.java,"
   67 | put(""keyA-77232"", ""a-Value""); // put some stuff in the collection
   68 | put(""keyB-77232"", param); // put it in a collection
   69 | put(""keyC"", ""another-Value""); // put some stuff in the collection
   70 | ring) map77232.get(""keyB-77232""); // get it back out
   71 |
   72 | leName = null;
   73 | ileInputStream fis = null;
   74 |
   75 |
   76 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |  new java.io.FileInputStream(new java.io.File(fileName));
   78 | ] b = new byte[1000];
   79 | ize = fis.read(b);
   80 | nse.getWriter()
   81 |    .println(
   82 |            ""The beginning of file: '""
   83 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                    + ""' is:\n\n""
   85 |                    + org.owasp
   86 |                            .esapi
   87 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00065.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00065.java,"
   68 |            new String(
   69 |                    org.apache.commons.codec.binary.Base64.decodeBase64(
   70 |                            org.apache.commons.codec.binary.Base64.encodeBase64(
   71 |                                    param.getBytes())));
   72 |
   73 |
   74 | tring fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   75 | ava.io.InputStream is = null;
   76 |
   77 | ry {
>  78 |    java.nio.file.Path path = java.nio.file.Paths.get(fileName);
   79 |    is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   80 |    byte[] b = new byte[1000];
   81 |    int size = is.read(b);
   82 |    response.getWriter()
   83 |            .println(
   84 |                    ""The beginning of file: '""
   85 |                            + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   86 |                            + ""' is:\n\n"");
   87 |    response.getWriter()
   88 |            .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00065.java,79,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00065.java,"
   69 |                             org.apache.commons.codec.binary.Base64.decodeBase64(
   70 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
   71 |                                             param.getBytes())));
   72 |         }
   73 |
   74 |         String fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   75 |         java.io.InputStream is = null;
   76 |
   77 |         try {
   78 |             java.nio.file.Path path = java.nio.file.Paths.get(fileName);
>  79 |             is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   80 |             byte[] b = new byte[1000];
   81 |             int size = is.read(b);
   82 |             response.getWriter()
   83 |                     .println(
   84 |                             ""The beginning of file: '""
   85 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   86 |                                     + ""' is:\n\n"");
   87 |             response.getWriter()
   88 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   89 |             is.close();
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00133.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00133.java,"
  53 |         // Simple ? condition that assigns param to bar on false condition
  54 |         int num = 106;
  55 |
  56 |         bar = (7 * 42) - num > 200 ? ""This should never happen"" : param;
  57 |
  58 |         String fileName = null;
  59 |         java.io.FileInputStream fis = null;
  60 |
  61 |         try {
  62 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 63 |             fis = new java.io.FileInputStream(fileName);
  64 |             byte[] b = new byte[1000];
  65 |             int size = fis.read(b);
  66 |             response.getWriter()
  67 |                     .println(
  68 |                             ""The beginning of file: '""
  69 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  70 |                                     + ""' is:\n\n"");
  71 |             response.getWriter()
  72 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  73 |         } catch (Exception e) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00215.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00215.java,"
  53 |             if (values != null && values.hasMoreElements()) {
  54 |                 param = name;
  55 |                 break;
  56 |             }
  57 |         }
  58 |         // Note: We don't URL decode header names because people don't normally do that
  59 |
  60 |         String bar = param;
  61 |
  62 |         java.io.File fileTarget =
> 63 |                 new java.io.File(
  64 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  65 |         response.getWriter()
  66 |                 .println(
  67 |                         ""Access to file: '""
  68 |                                 + org.owasp
  69 |                                         .esapi
  70 |                                         .ESAPI
  71 |                                         .encoder()
  72 |                                         .encodeForHTML(fileTarget.toString())
  73 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00216.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00216.java,"
  58 |         // Note: We don't URL decode header names because people don't normally do that
  59 |
  60 |         String bar;
  61 |
  62 |         // Simple if statement that assigns param to bar on true condition
  63 |         int num = 196;
  64 |         if ((500 / 42) + num > 200) bar = param;
  65 |         else bar = ""This should never happen"";
  66 |
  67 |         java.io.File fileTarget =
> 68 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  69 |         response.getWriter()
  70 |                 .println(
  71 |                         ""Access to file: '""
  72 |                                 + org.owasp
  73 |                                         .esapi
  74 |                                         .ESAPI
  75 |                                         .encoder()
  76 |                                         .encodeForHTML(fileTarget.toString())
  77 |                                 + ""' created."");
  78 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00218.java,101,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00218.java,"
   91 |            new java.net.URI(
   92 |                    ""file"",
   93 |                    null,
   94 |                    startURIslashes
   95 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   96 |                                    .replace('\\', java.io.File.separatorChar)
   97 |                                    .replace(' ', '_')
   98 |                            + bar,
   99 |                    null,
  100 |                    null);
> 101 |    java.io.File fileTarget = new java.io.File(fileURI);
  102 |    response.getWriter()
  103 |            .println(
  104 |                    ""Access to file: '""
  105 |                            + org.owasp
  106 |                                    .esapi
  107 |                                    .ESAPI
  108 |                                    .encoder()
  109 |                                    .encodeForHTML(fileTarget.toString())
  110 |                            + ""' created."");
  111 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00219.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00219.java,"
   62 |         // Simple ? condition that assigns param to bar on false condition
   63 |         int num = 106;
   64 |
   65 |         bar = (7 * 42) - num > 200 ? ""This should never happen"" : param;
   66 |
   67 |         String fileName = null;
   68 |         java.io.FileInputStream fis = null;
   69 |
   70 |         try {
   71 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  72 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   73 |             byte[] b = new byte[1000];
   74 |             int size = fis.read(b);
   75 |             response.getWriter()
   76 |                     .println(
   77 |                             ""The beginning of file: '""
   78 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   79 |                                     + ""' is:\n\n""
   80 |                                     + org.owasp
   81 |                                             .esapi
   82 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00219.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00219.java,"
   62 |  ? condition that assigns param to bar on false condition
   63 |  106;
   64 |
   65 | * 42) - num > 200 ? ""This should never happen"" : param;
   66 |
   67 | leName = null;
   68 | ileInputStream fis = null;
   69 |
   70 |
   71 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  72 |  new java.io.FileInputStream(new java.io.File(fileName));
   73 | ] b = new byte[1000];
   74 | ize = fis.read(b);
   75 | nse.getWriter()
   76 |    .println(
   77 |            ""The beginning of file: '""
   78 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   79 |                    + ""' is:\n\n""
   80 |                    + org.owasp
   81 |                            .esapi
   82 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00222.java,87,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00222.java,"
   77 |                 bar = ""bobs_your_uncle"";
   78 |                 break;
   79 |         }
   80 |
   81 |         String fileName = null;
   82 |         java.io.FileOutputStream fos = null;
   83 |
   84 |         try {
   85 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   86 |
>  87 |             fos = new java.io.FileOutputStream(fileName);
   88 |             response.getWriter()
   89 |                     .println(
   90 |                             ""Now ready to write to file: ""
   91 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   92 |
   93 |         } catch (Exception e) {
   94 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   95 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   96 |         } finally {
   97 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00262.java,74,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00262.java,"
  64 |            break;
  65 |        case 'C':
  66 |        case 'D':
  67 |            bar = param;
  68 |            break;
  69 |        default:
  70 |            bar = ""bobs_your_uncle"";
  71 |            break;
  72 |    }
  73 |
> 74 |    java.io.File fileTarget = new java.io.File(bar);
  75 |    response.getWriter()
  76 |            .println(
  77 |                    ""Access to file: '""
  78 |                            + org.owasp
  79 |                                    .esapi
  80 |                                    .ESAPI
  81 |                                    .encoder()
  82 |                                    .encodeForHTML(fileTarget.toString())
  83 |                            + ""' created."");
  84 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00264.java,65,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00264.java,"
  55 |         // Simple if statement that assigns param to bar on true condition
  56 |         int num = 196;
  57 |         if ((500 / 42) + num > 200) bar = param;
  58 |         else bar = ""This should never happen"";
  59 |
  60 |         String fileName = null;
  61 |         java.io.FileInputStream fis = null;
  62 |
  63 |         try {
  64 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 65 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
  66 |             byte[] b = new byte[1000];
  67 |             int size = fis.read(b);
  68 |             response.getWriter()
  69 |                     .println(
  70 |                             ""The beginning of file: '""
  71 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  72 |                                     + ""' is:\n\n""
  73 |                                     + org.owasp
  74 |                                             .esapi
  75 |                                             .ESAPI
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00264.java,65,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00264.java,"
  55 |  if statement that assigns param to bar on true condition
  56 |  196;
  57 | / 42) + num > 200) bar = param;
  58 | = ""This should never happen"";
  59 |
  60 | leName = null;
  61 | ileInputStream fis = null;
  62 |
  63 |
  64 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 65 |  new java.io.FileInputStream(new java.io.File(fileName));
  66 | ] b = new byte[1000];
  67 | ize = fis.read(b);
  68 | nse.getWriter()
  69 |    .println(
  70 |            ""The beginning of file: '""
  71 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  72 |                    + ""' is:\n\n""
  73 |                    + org.owasp
  74 |                            .esapi
  75 |                            .ESAPI
     ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00359.java,53,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00359.java,"
  43 |    String param = request.getParameter(""BenchmarkTest00359"");
  44 |    if (param == null) param = """";
  45 |
  46 |    String bar;
  47 |
  48 |    // Simple if statement that assigns param to bar on true condition
  49 |    int num = 196;
  50 |    if ((500 / 42) + num > 200) bar = param;
  51 |    else bar = ""This should never happen"";
  52 |
> 53 |    java.io.File fileTarget = new java.io.File(bar);
  54 |    response.getWriter()
  55 |            .println(
  56 |                    ""Access to file: '""
  57 |                            + org.owasp
  58 |                                    .esapi
  59 |                                    .ESAPI
  60 |                                    .encoder()
  61 |                                    .encodeForHTML(fileTarget.toString())
  62 |                            + ""' created."");
  63 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00360.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00360.java,"
  50 |                             org.apache.commons.codec.binary.Base64.decodeBase64(
  51 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  52 |                                             param.getBytes())));
  53 |         }
  54 |
  55 |         String fileName = null;
  56 |         java.io.FileInputStream fis = null;
  57 |
  58 |         try {
  59 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 60 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
  61 |             byte[] b = new byte[1000];
  62 |             int size = fis.read(b);
  63 |             response.getWriter()
  64 |                     .println(
  65 |                             ""The beginning of file: '""
  66 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  67 |                                     + ""' is:\n\n""
  68 |                                     + org.owasp
  69 |                                             .esapi
  70 |                                             .ESAPI
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00360.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00360.java,"
  50 |            org.apache.commons.codec.binary.Base64.decodeBase64(
  51 |                    org.apache.commons.codec.binary.Base64.encodeBase64(
  52 |                            param.getBytes())));
  53 |
  54 |
  55 | leName = null;
  56 | ileInputStream fis = null;
  57 |
  58 |
  59 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 60 |  new java.io.FileInputStream(new java.io.File(fileName));
  61 | ] b = new byte[1000];
  62 | ize = fis.read(b);
  63 | nse.getWriter()
  64 |    .println(
  65 |            ""The beginning of file: '""
  66 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  67 |                    + ""' is:\n\n""
  68 |                    + org.owasp
  69 |                            .esapi
  70 |                            .ESAPI
     ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00362.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00362.java,"
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = param;
  47 |
  48 |         String fileName = null;
  49 |         java.io.FileOutputStream fos = null;
  50 |
  51 |         try {
  52 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  55 |             response.getWriter()
  56 |                     .println(
  57 |                             ""Now ready to write to file: ""
  58 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 |         } catch (Exception e) {
  61 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 |         } finally {
  64 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00362.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00362.java,"
  44 | == null) param = """";
  45 |
  46 |  = param;
  47 |
  48 | eName = null;
  49 | leOutputStream fos = null;
  50 |
  51 |
  52 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 | new java.io.FileOutputStream(new java.io.File(fileName));
  55 | se.getWriter()
  56 |   .println(
  57 |           ""Now ready to write to file: ""
  58 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 | xception e) {
  61 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 | {
  64 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00363.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00363.java,"
  50 |
  51 | e the file first so the test won't throw an exception if it doesn't exist.
  52 |  Don't actually do this because this method signature could cause a tool to find
  53 | file constructor
  54 | vuln, rather than the File signature we are trying to actually test.
  55 | cessary, just run the benchmark twice. The 1st run should create all the necessary
  56 | .
  57 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
  58 |
  59 | FileOutputStream fos =
> 60 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
  61 | onse.getWriter()
  62 |     .println(
  63 |             ""Now ready to write to file: ""
  64 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  65 |
  66 | (Exception e) {
  67 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  68 |
  69 |
  70 |
     ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00452.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00452.java,"
  50 |         String bar = """";
  51 |         if (param != null) {
  52 |             bar =
  53 |                     new String(
  54 |                             org.apache.commons.codec.binary.Base64.decodeBase64(
  55 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  56 |                                             param.getBytes())));
  57 |         }
  58 |
  59 |         java.io.File fileTarget =
> 60 |                 new java.io.File(
  61 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  62 |         response.getWriter()
  63 |                 .println(
  64 |                         ""Access to file: '""
  65 |                                 + org.owasp
  66 |                                         .esapi
  67 |                                         .ESAPI
  68 |                                         .encoder()
  69 |                                         .encodeForHTML(fileTarget.toString())
  70 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00453.java,79,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00453.java,"
  69 |            new java.net.URI(
  70 |                    ""file"",
  71 |                    null,
  72 |                    startURIslashes
  73 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
  74 |                                    .replace('\\', java.io.File.separatorChar)
  75 |                                    .replace(' ', '_')
  76 |                            + bar,
  77 |                    null,
  78 |                    null);
> 79 |    java.io.File fileTarget = new java.io.File(fileURI);
  80 |    response.getWriter()
  81 |            .println(
  82 |                    ""Access to file: '""
  83 |                            + org.owasp
  84 |                                    .esapi
  85 |                                    .ESAPI
  86 |                                    .encoder()
  87 |                                    .encodeForHTML(fileTarget.toString())
  88 |                            + ""' created."");
  89 |    if (fileTarget.exists()) {
     ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00455.java,64,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00455.java,"
  54 |                             org.apache.commons.codec.binary.Base64.decodeBase64(
  55 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  56 |                                             param.getBytes())));
  57 |         }
  58 |
  59 |         String fileName = null;
  60 |         java.io.FileInputStream fis = null;
  61 |
  62 |         try {
  63 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 64 |             fis = new java.io.FileInputStream(fileName);
  65 |             byte[] b = new byte[1000];
  66 |             int size = fis.read(b);
  67 |             response.getWriter()
  68 |                     .println(
  69 |                             ""The beginning of file: '""
  70 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  71 |                                     + ""' is:\n\n"");
  72 |             response.getWriter()
  73 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  74 |         } catch (Exception e) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00456.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00456.java,"
  52 |         map49381.put(""keyA-49381"", ""a-Value""); // put some stuff in the collection
  53 |         map49381.put(""keyB-49381"", param); // put it in a collection
  54 |         map49381.put(""keyC"", ""another-Value""); // put some stuff in the collection
  55 |         bar = (String) map49381.get(""keyB-49381""); // get it back out
  56 |
  57 |         String fileName = null;
  58 |         java.io.FileInputStream fis = null;
  59 |
  60 |         try {
  61 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 62 |             fis = new java.io.FileInputStream(fileName);
  63 |             byte[] b = new byte[1000];
  64 |             int size = fis.read(b);
  65 |             response.getWriter()
  66 |                     .println(
  67 |                             ""The beginning of file: '""
  68 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  69 |                                     + ""' is:\n\n"");
  70 |             response.getWriter()
  71 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  72 |         } catch (Exception e) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00457.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00457.java,"
  58 |
  59 |             bar = valuesList.get(0); // get the param value
  60 |         }
  61 |
  62 |         String fileName = null;
  63 |         java.io.FileOutputStream fos = null;
  64 |
  65 |         try {
  66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  67 |
> 68 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  69 |             response.getWriter()
  70 |                     .println(
  71 |                             ""Now ready to write to file: ""
  72 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  73 |
  74 |         } catch (Exception e) {
  75 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  76 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  77 |         } finally {
  78 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00457.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00457.java,"
  58 |
  59 | valuesList.get(0); // get the param value
  60 |
  61 |
  62 | eName = null;
  63 | leOutputStream fos = null;
  64 |
  65 |
  66 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  67 |
> 68 | new java.io.FileOutputStream(new java.io.File(fileName));
  69 | se.getWriter()
  70 |   .println(
  71 |           ""Now ready to write to file: ""
  72 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  73 |
  74 | xception e) {
  75 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  76 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  77 | {
  78 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00459.java,65,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00459.java,"
  55 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  56 |                                             param.getBytes())));
  57 |         }
  58 |
  59 |         String fileName = null;
  60 |         java.io.FileOutputStream fos = null;
  61 |
  62 |         try {
  63 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  64 |
> 65 |             fos = new java.io.FileOutputStream(fileName);
  66 |             response.getWriter()
  67 |                     .println(
  68 |                             ""Now ready to write to file: ""
  69 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  70 |
  71 |         } catch (Exception e) {
  72 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  73 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  74 |         } finally {
  75 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00525.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00525.java,"
  63 |             valuesList.add(""safe"");
  64 |             valuesList.add(param);
  65 |             valuesList.add(""moresafe"");
  66 |
  67 |             valuesList.remove(0); // remove the 1st safe value
  68 |
  69 |             bar = valuesList.get(0); // get the param value
  70 |         }
  71 |
  72 |         java.io.File fileTarget =
> 73 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  74 |         response.getWriter()
  75 |                 .println(
  76 |                         ""Access to file: '""
  77 |                                 + org.owasp
  78 |                                         .esapi
  79 |                                         .ESAPI
  80 |                                         .encoder()
  81 |                                         .encodeForHTML(fileTarget.toString())
  82 |                                 + ""' created."");
  83 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00526.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00526.java,"
  52 |                if (value.equals(""BenchmarkTest00526"")) {
  53 |                    param = name;
  54 |                    flag = false;
  55 |                }
  56 |            }
  57 |        }
  58 |    }
  59 |
  60 |    String bar = param;
  61 |
> 62 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  63 |    response.getWriter()
  64 |            .println(
  65 |                    ""Access to file: '""
  66 |                            + org.owasp
  67 |                                    .esapi
  68 |                                    .ESAPI
  69 |                                    .encoder()
  70 |                                    .encodeForHTML(fileTarget.toString())
  71 |                            + ""' created."");
  72 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00527.java,64,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00527.java,"
  54 |                    flag = false;
  55 |                }
  56 |            }
  57 |        }
  58 |    }
  59 |
  60 |    org.owasp.benchmark.helpers.ThingInterface thing =
  61 |            org.owasp.benchmark.helpers.ThingFactory.createThing();
  62 |    String bar = thing.doSomething(param);
  63 |
> 64 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  65 |    response.getWriter()
  66 |            .println(
  67 |                    ""Access to file: '""
  68 |                            + org.owasp
  69 |                                    .esapi
  70 |                                    .ESAPI
  71 |                                    .encoder()
  72 |                                    .encodeForHTML(fileTarget.toString())
  73 |                            + ""' created."");
  74 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00528.java,87,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00528.java,"
   77 |            new java.net.URI(
   78 |                    ""file"",
   79 |                    null,
   80 |                    startURIslashes
   81 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   82 |                                    .replace('\\', java.io.File.separatorChar)
   83 |                                    .replace(' ', '_')
   84 |                            + bar,
   85 |                    null,
   86 |                    null);
>  87 |    java.io.File fileTarget = new java.io.File(fileURI);
   88 |    response.getWriter()
   89 |            .println(
   90 |                    ""Access to file: '""
   91 |                            + org.owasp
   92 |                                    .esapi
   93 |                                    .ESAPI
   94 |                                    .encoder()
   95 |                                    .encodeForHTML(fileTarget.toString())
   96 |                            + ""' created."");
   97 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00529.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00529.java,"
  57 |             }
  58 |         }
  59 |
  60 |         String bar = param;
  61 |
  62 |         String fileName = null;
  63 |         java.io.FileInputStream fis = null;
  64 |
  65 |         try {
  66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 67 |             fis = new java.io.FileInputStream(fileName);
  68 |             byte[] b = new byte[1000];
  69 |             int size = fis.read(b);
  70 |             response.getWriter()
  71 |                     .println(
  72 |                             ""The beginning of file: '""
  73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  74 |                                     + ""' is:\n\n"");
  75 |             response.getWriter()
  76 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  77 |         } catch (Exception e) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00619.java,61,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00619.java,"
  51 |             valuesList.add(""safe"");
  52 |             valuesList.add(param);
  53 |             valuesList.add(""moresafe"");
  54 |
  55 |             valuesList.remove(0); // remove the 1st safe value
  56 |
  57 |             bar = valuesList.get(0); // get the param value
  58 |         }
  59 |
  60 |         java.io.File fileTarget =
> 61 |                 new java.io.File(
  62 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  63 |         response.getWriter()
  64 |                 .println(
  65 |                         ""Access to file: '""
  66 |                                 + org.owasp
  67 |                                         .esapi
  68 |                                         .ESAPI
  69 |                                         .encoder()
  70 |                                         .encodeForHTML(fileTarget.toString())
  71 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00623.java,57,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00623.java,"
  47 |
  48 |    String bar = """";
  49 |    if (param != null) {
  50 |        bar =
  51 |                new String(
  52 |                        org.apache.commons.codec.binary.Base64.decodeBase64(
  53 |                                org.apache.commons.codec.binary.Base64.encodeBase64(
  54 |                                        param.getBytes())));
  55 |    }
  56 |
> 57 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  58 |    response.getWriter()
  59 |            .println(
  60 |                    ""Access to file: '""
  61 |                            + org.owasp
  62 |                                    .esapi
  63 |                                    .ESAPI
  64 |                                    .encoder()
  65 |                                    .encodeForHTML(fileTarget.toString())
  66 |                            + ""' created."");
  67 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00624.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00624.java,"
  48 |         org.owasp.benchmark.helpers.ThingInterface thing =
  49 |                 org.owasp.benchmark.helpers.ThingFactory.createThing();
  50 |         String bar = thing.doSomething(param);
  51 |
  52 |         String fileName = null;
  53 |         java.io.FileOutputStream fos = null;
  54 |
  55 |         try {
  56 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  57 |
> 58 |             fos = new java.io.FileOutputStream(new java.io.File(fileName), false);
  59 |             response.getWriter()
  60 |                     .println(
  61 |                             ""Now ready to write to file: ""
  62 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  63 |
  64 |         } catch (Exception e) {
  65 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  66 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  67 |         } finally {
  68 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00624.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00624.java,"
  48 | benchmark.helpers.ThingInterface thing =
  49 | g.owasp.benchmark.helpers.ThingFactory.createThing();
  50 |  = thing.doSomething(param);
  51 |
  52 | eName = null;
  53 | leOutputStream fos = null;
  54 |
  55 |
  56 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  57 |
> 58 | new java.io.FileOutputStream(new java.io.File(fileName), false);
  59 | se.getWriter()
  60 |   .println(
  61 |           ""Now ready to write to file: ""
  62 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  63 |
  64 | xception e) {
  65 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  66 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  67 | {
  68 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00627.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00627.java,"
  53 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  54 |                                             param.getBytes())));
  55 |         }
  56 |
  57 |         String fileName = null;
  58 |         java.io.FileOutputStream fos = null;
  59 |
  60 |         try {
  61 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  62 |
> 63 |             fos = new java.io.FileOutputStream(fileName, false);
  64 |             response.getWriter()
  65 |                     .println(
  66 |                             ""Now ready to write to file: ""
  67 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  68 |
  69 |         } catch (Exception e) {
  70 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  71 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  72 |         } finally {
  73 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00629.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00629.java,"
  49 |
  50 | / Simple if statement that assigns param to bar on true condition
  51 | nt num = 196;
  52 | f ((500 / 42) + num > 200) bar = param;
  53 | lse bar = ""This should never happen"";
  54 |
  55 | tring fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  56 | ava.io.InputStream is = null;
  57 |
  58 | ry {
> 59 |    java.nio.file.Path path = java.nio.file.Paths.get(fileName);
  60 |    is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
  61 |    byte[] b = new byte[1000];
  62 |    int size = is.read(b);
  63 |    response.getWriter()
  64 |            .println(
  65 |                    ""The beginning of file: '""
  66 |                            + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  67 |                            + ""' is:\n\n"");
  68 |    response.getWriter()
  69 |            .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
     ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00629.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00629.java,"
  50 |         // Simple if statement that assigns param to bar on true condition
  51 |         int num = 196;
  52 |         if ((500 / 42) + num > 200) bar = param;
  53 |         else bar = ""This should never happen"";
  54 |
  55 |         String fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  56 |         java.io.InputStream is = null;
  57 |
  58 |         try {
  59 |             java.nio.file.Path path = java.nio.file.Paths.get(fileName);
> 60 |             is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
  61 |             byte[] b = new byte[1000];
  62 |             int size = is.read(b);
  63 |             response.getWriter()
  64 |                     .println(
  65 |                             ""The beginning of file: '""
  66 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  67 |                                     + ""' is:\n\n"");
  68 |             response.getWriter()
  69 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  70 |             is.close();
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00696.java,70,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00696.java,"
  60 |             case 'C':
  61 |             case 'D':
  62 |                 bar = param;
  63 |                 break;
  64 |             default:
  65 |                 bar = ""bobs_your_uncle"";
  66 |                 break;
  67 |         }
  68 |
  69 |         java.io.File fileTarget =
> 70 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  71 |         response.getWriter()
  72 |                 .println(
  73 |                         ""Access to file: '""
  74 |                                 + org.owasp
  75 |                                         .esapi
  76 |                                         .ESAPI
  77 |                                         .encoder()
  78 |                                         .encodeForHTML(fileTarget.toString())
  79 |                                 + ""' created."");
  80 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00697.java,57,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00697.java,"
  47 |
  48 |    String bar = """";
  49 |    if (param != null) {
  50 |        bar =
  51 |                new String(
  52 |                        org.apache.commons.codec.binary.Base64.decodeBase64(
  53 |                                org.apache.commons.codec.binary.Base64.encodeBase64(
  54 |                                        param.getBytes())));
  55 |    }
  56 |
> 57 |    java.io.File fileTarget = new java.io.File(bar);
  58 |    response.getWriter()
  59 |            .println(
  60 |                    ""Access to file: '""
  61 |                            + org.owasp
  62 |                                    .esapi
  63 |                                    .ESAPI
  64 |                                    .encoder()
  65 |                                    .encodeForHTML(fileTarget.toString())
  66 |                            + ""' created."");
  67 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00698.java,52,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00698.java,"
  42 |
  43 |    String[] values = request.getParameterValues(""BenchmarkTest00698"");
  44 |    String param;
  45 |    if (values != null && values.length > 0) param = values[0];
  46 |    else param = """";
  47 |
  48 |    org.owasp.benchmark.helpers.ThingInterface thing =
  49 |            org.owasp.benchmark.helpers.ThingFactory.createThing();
  50 |    String bar = thing.doSomething(param);
  51 |
> 52 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  53 |    response.getWriter()
  54 |            .println(
  55 |                    ""Access to file: '""
  56 |                            + org.owasp
  57 |                                    .esapi
  58 |                                    .ESAPI
  59 |                                    .encoder()
  60 |                                    .encodeForHTML(fileTarget.toString())
  61 |                            + ""' created."");
  62 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00700.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00700.java,"
  53 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
  54 |                                             param.getBytes())));
  55 |         }
  56 |
  57 |         String fileName = null;
  58 |         java.io.FileOutputStream fos = null;
  59 |
  60 |         try {
  61 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  62 |
> 63 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  64 |             response.getWriter()
  65 |                     .println(
  66 |                             ""Now ready to write to file: ""
  67 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  68 |
  69 |         } catch (Exception e) {
  70 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  71 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  72 |         } finally {
  73 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00700.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00700.java,"
  53 |                   org.apache.commons.codec.binary.Base64.encodeBase64(
  54 |                           param.getBytes())));
  55 |
  56 |
  57 | eName = null;
  58 | leOutputStream fos = null;
  59 |
  60 |
  61 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  62 |
> 63 | new java.io.FileOutputStream(new java.io.File(fileName));
  64 | se.getWriter()
  65 |   .println(
  66 |           ""Now ready to write to file: ""
  67 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  68 |
  69 | xception e) {
  70 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  71 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  72 | {
  73 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00783.java,82,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00783.java,"
   72 |         map2299.put(""keyA-2299"", ""a-Value""); // put some stuff in the collection
   73 |         map2299.put(""keyB-2299"", param); // put it in a collection
   74 |         map2299.put(""keyC"", ""another-Value""); // put some stuff in the collection
   75 |         bar = (String) map2299.get(""keyB-2299""); // get it back out
   76 |
   77 |         String fileName = null;
   78 |         java.io.FileInputStream fis = null;
   79 |
   80 |         try {
   81 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  82 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   83 |             byte[] b = new byte[1000];
   84 |             int size = fis.read(b);
   85 |             response.getWriter()
   86 |                     .println(
   87 |                             ""The beginning of file: '""
   88 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   89 |                                     + ""' is:\n\n""
   90 |                                     + org.owasp
   91 |                                             .esapi
   92 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00783.java,82,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00783.java,"
   72 | ut(""keyA-2299"", ""a-Value""); // put some stuff in the collection
   73 | ut(""keyB-2299"", param); // put it in a collection
   74 | ut(""keyC"", ""another-Value""); // put some stuff in the collection
   75 | ring) map2299.get(""keyB-2299""); // get it back out
   76 |
   77 | leName = null;
   78 | ileInputStream fis = null;
   79 |
   80 |
   81 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  82 |  new java.io.FileInputStream(new java.io.File(fileName));
   83 | ] b = new byte[1000];
   84 | ize = fis.read(b);
   85 | nse.getWriter()
   86 |    .println(
   87 |            ""The beginning of file: '""
   88 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   89 |                    + ""' is:\n\n""
   90 |                    + org.owasp
   91 |                            .esapi
   92 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00785.java,83,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00785.java,"
   73 |         map59480.put(""keyB-59480"", param); // put it in a collection
   74 |         map59480.put(""keyC"", ""another-Value""); // put some stuff in the collection
   75 |         bar = (String) map59480.get(""keyB-59480""); // get it back out
   76 |
   77 |         String fileName = null;
   78 |         java.io.FileOutputStream fos = null;
   79 |
   80 |         try {
   81 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   82 |
>  83 |             fos = new java.io.FileOutputStream(fileName, false);
   84 |             response.getWriter()
   85 |                     .println(
   86 |                             ""Now ready to write to file: ""
   87 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   88 |
   89 |         } catch (Exception e) {
   90 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   91 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   92 |         } finally {
   93 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00787.java,85,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00787.java,"
   75 |                                     org.apache.commons.codec.binary.Base64.encodeBase64(
   76 |                                             param.getBytes())));
   77 |         }
   78 |
   79 |         String fileName = null;
   80 |         java.io.FileOutputStream fos = null;
   81 |
   82 |         try {
   83 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   84 |
>  85 |             fos = new java.io.FileOutputStream(fileName);
   86 |             response.getWriter()
   87 |                     .println(
   88 |                             ""Now ready to write to file: ""
   89 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   90 |
   91 |         } catch (Exception e) {
   92 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   93 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   94 |         } finally {
   95 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00788.java,80,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00788.java,"
   70 |         org.owasp.benchmark.helpers.ThingInterface thing =
   71 |                 org.owasp.benchmark.helpers.ThingFactory.createThing();
   72 |         String bar = thing.doSomething(param);
   73 |
   74 |         String fileName = null;
   75 |         java.io.FileOutputStream fos = null;
   76 |
   77 |         try {
   78 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   79 |
>  80 |             fos = new java.io.FileOutputStream(fileName);
   81 |             response.getWriter()
   82 |                     .println(
   83 |                             ""Now ready to write to file: ""
   84 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   85 |
   86 |         } catch (Exception e) {
   87 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   88 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   89 |         } finally {
   90 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00949.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00949.java,"
  58 |                 if (theCookie.getName().equals(""BenchmarkTest00949"")) {
  59 |                     param = java.net.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
  60 |                     break;
  61 |                 }
  62 |             }
  63 |         }
  64 |
  65 |         String bar = new Test().doSomething(request, param);
  66 |
  67 |         java.io.File fileTarget =
> 68 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  69 |         response.getWriter()
  70 |                 .println(
  71 |                         ""Access to file: '""
  72 |                                 + org.owasp
  73 |                                         .esapi
  74 |                                         .ESAPI
  75 |                                         .encoder()
  76 |                                         .encodeForHTML(fileTarget.toString())
  77 |                                 + ""' created."");
  78 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00950.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00950.java,"
  57 |        for (javax.servlet.http.Cookie theCookie : theCookies) {
  58 |            if (theCookie.getName().equals(""BenchmarkTest00950"")) {
  59 |                param = java.net.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
  60 |                break;
  61 |            }
  62 |        }
  63 |    }
  64 |
  65 |    String bar = new Test().doSomething(request, param);
  66 |
> 67 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  68 |    response.getWriter()
  69 |            .println(
  70 |                    ""Access to file: '""
  71 |                            + org.owasp
  72 |                                    .esapi
  73 |                                    .ESAPI
  74 |                                    .encoder()
  75 |                                    .encodeForHTML(fileTarget.toString())
  76 |                            + ""' created."");
  77 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00952.java,87,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00952.java,"
   77 |            new java.net.URI(
   78 |                    ""file"",
   79 |                    null,
   80 |                    startURIslashes
   81 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   82 |                                    .replace('\\', java.io.File.separatorChar)
   83 |                                    .replace(' ', '_')
   84 |                            + bar,
   85 |                    null,
   86 |                    null);
>  87 |    java.io.File fileTarget = new java.io.File(fileURI);
   88 |    response.getWriter()
   89 |            .println(
   90 |                    ""Access to file: '""
   91 |                            + org.owasp
   92 |                                    .esapi
   93 |                                    .ESAPI
   94 |                                    .encoder()
   95 |                                    .encodeForHTML(fileTarget.toString())
   96 |                            + ""' created."");
   97 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00953.java,79,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00953.java,"
   69 |
   70 | e the file first so the test won't throw an exception if it doesn't exist.
   71 |  Don't actually do this because this method signature could cause a tool to find
   72 | file constructor
   73 | vuln, rather than the File signature we are trying to actually test.
   74 | cessary, just run the benchmark twice. The 1st run should create all the necessary
   75 | .
   76 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
   77 |
   78 | FileOutputStream fos =
>  79 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
   80 | onse.getWriter()
   81 |     .println(
   82 |             ""Now ready to write to file: ""
   83 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   84 |
   85 | (Exception e) {
   86 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   87 |
   88 | ost
   89 |
      ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00956.java,79,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00956.java,"
   69 |
   70 | e the file first so the test won't throw an exception if it doesn't exist.
   71 |  Don't actually do this because this method signature could cause a tool to find
   72 | file constructor
   73 | vuln, rather than the File signature we are trying to actually test.
   74 | cessary, just run the benchmark twice. The 1st run should create all the necessary
   75 | .
   76 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
   77 |
   78 | FileOutputStream fos =
>  79 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
   80 | onse.getWriter()
   81 |     .println(
   82 |             ""Now ready to write to file: ""
   83 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   84 |
   85 | (Exception e) {
   86 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   87 |
   88 | ost
   89 |
      ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01025.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01025.java,"
  44 |         if (request.getHeader(""BenchmarkTest01025"") != null) {
  45 |             param = request.getHeader(""BenchmarkTest01025"");
  46 |         }
  47 |
  48 |         // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = new Test().doSomething(request, param);
  52 |
  53 |         java.io.File fileTarget =
> 54 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  55 |         response.getWriter()
  56 |                 .println(
  57 |                         ""Access to file: '""
  58 |                                 + org.owasp
  59 |                                         .esapi
  60 |                                         .ESAPI
  61 |                                         .encoder()
  62 |                                         .encodeForHTML(fileTarget.toString())
  63 |                                 + ""' created."");
  64 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01029.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01029.java,"
   63 |            new java.net.URI(
   64 |                    ""file"",
   65 |                    null,
   66 |                    startURIslashes
   67 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   68 |                                    .replace('\\', java.io.File.separatorChar)
   69 |                                    .replace(' ', '_')
   70 |                            + bar,
   71 |                    null,
   72 |                    null);
>  73 |    java.io.File fileTarget = new java.io.File(fileURI);
   74 |    response.getWriter()
   75 |            .println(
   76 |                    ""Access to file: '""
   77 |                            + org.owasp
   78 |                                    .esapi
   79 |                                    .ESAPI
   80 |                                    .encoder()
   81 |                                    .encodeForHTML(fileTarget.toString())
   82 |                            + ""' created."");
   83 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01032.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01032.java,"
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = new Test().doSomething(request, param);
  52 |
  53 |         String fileName = null;
  54 |         java.io.FileOutputStream fos = null;
  55 |
  56 |         try {
  57 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 |             fos = new java.io.FileOutputStream(new java.io.File(fileName), false);
  60 |             response.getWriter()
  61 |                     .println(
  62 |                             ""Now ready to write to file: ""
  63 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 |         } catch (Exception e) {
  66 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 |         } finally {
  69 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01032.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01032.java,"
  49 | va.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |  = new Test().doSomething(request, param);
  52 |
  53 | eName = null;
  54 | leOutputStream fos = null;
  55 |
  56 |
  57 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 | new java.io.FileOutputStream(new java.io.File(fileName), false);
  60 | se.getWriter()
  61 |   .println(
  62 |           ""Now ready to write to file: ""
  63 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 | xception e) {
  66 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 | {
  69 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01033.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01033.java,"
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = new Test().doSomething(request, param);
  52 |
  53 |         String fileName = null;
  54 |         java.io.FileOutputStream fos = null;
  55 |
  56 |         try {
  57 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  60 |             response.getWriter()
  61 |                     .println(
  62 |                             ""Now ready to write to file: ""
  63 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 |         } catch (Exception e) {
  66 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 |         } finally {
  69 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01033.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01033.java,"
  49 | va.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |  = new Test().doSomething(request, param);
  52 |
  53 | eName = null;
  54 | leOutputStream fos = null;
  55 |
  56 |
  57 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 | new java.io.FileOutputStream(new java.io.File(fileName));
  60 | se.getWriter()
  61 |   .println(
  62 |           ""Now ready to write to file: ""
  63 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 | xception e) {
  66 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 | {
  69 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01034.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01034.java,"
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = new Test().doSomething(request, param);
  52 |
  53 |         String fileName = null;
  54 |         java.io.FileOutputStream fos = null;
  55 |
  56 |         try {
  57 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 |             fos = new java.io.FileOutputStream(fileName);
  60 |             response.getWriter()
  61 |                     .println(
  62 |                             ""Now ready to write to file: ""
  63 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 |         } catch (Exception e) {
  66 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 |         } finally {
  69 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01111.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01111.java,"
   57 |         }
   58 |         // Note: We don't URL decode header names because people don't normally do that
   59 |
   60 |         String bar = new Test().doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(fileName);
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n"");
   75 |             response.getWriter()
   76 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   77 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01112.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01112.java,"
   57 |         }
   58 |         // Note: We don't URL decode header names because people don't normally do that
   59 |
   60 |         String bar = new Test().doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(fileName);
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n"");
   75 |             response.getWriter()
   76 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   77 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01116.java,74,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01116.java,"
   64 |
   65 | e the file first so the test won't throw an exception if it doesn't exist.
   66 |  Don't actually do this because this method signature could cause a tool to find
   67 | file constructor
   68 | vuln, rather than the File signature we are trying to actually test.
   69 | cessary, just run the benchmark twice. The 1st run should create all the necessary
   70 | .
   71 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
   72 |
   73 | FileOutputStream fos =
>  74 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
   75 | onse.getWriter()
   76 |     .println(
   77 |             ""Now ready to write to file: ""
   78 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   79 |
   80 | (Exception e) {
   81 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   82 |
   83 | ost
   84 |
      ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01117.java,74,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01117.java,"
   64 |
   65 | e the file first so the test won't throw an exception if it doesn't exist.
   66 |  Don't actually do this because this method signature could cause a tool to find
   67 | file constructor
   68 | vuln, rather than the File signature we are trying to actually test.
   69 | cessary, just run the benchmark twice. The 1st run should create all the necessary
   70 | .
   71 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
   72 |
   73 | FileOutputStream fos =
>  74 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
   75 | onse.getWriter()
   76 |     .println(
   77 |             ""Now ready to write to file: ""
   78 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   79 |
   80 | (Exception e) {
   81 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   82 |
   83 | ost
   84 |
      ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01155.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01155.java,"
  45 |
  46 |    if (headers != null && headers.hasMoreElements()) {
  47 |        param = headers.nextElement(); // just grab first element
  48 |    }
  49 |
  50 |    // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |    param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |    String bar = new Test().doSomething(request, param);
  54 |
> 55 |    java.io.File fileTarget = new java.io.File(bar);
  56 |    response.getWriter()
  57 |            .println(
  58 |                    ""Access to file: '""
  59 |                            + org.owasp
  60 |                                    .esapi
  61 |                                    .ESAPI
  62 |                                    .encoder()
  63 |                                    .encodeForHTML(fileTarget.toString())
  64 |                            + ""' created."");
  65 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01156.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01156.java,"
   62 |
   63 | ry {
   64 |    java.net.URI fileURI =
   65 |            new java.net.URI(
   66 |                    ""file:""
   67 |                            + startURIslashes
   68 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   69 |                                    .replace('\\', '/')
   70 |                                    .replace(' ', '_')
   71 |                            + bar);
>  72 |    java.io.File fileTarget = new java.io.File(fileURI);
   73 |    response.getWriter()
   74 |            .println(
   75 |                    ""Access to file: '""
   76 |                            + org.owasp
   77 |                                    .esapi
   78 |                                    .ESAPI
   79 |                                    .encoder()
   80 |                                    .encodeForHTML(fileTarget.toString())
   81 |                            + ""' created."");
   82 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01157.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01157.java,"
   62 |
   63 | ry {
   64 |    java.net.URI fileURI =
   65 |            new java.net.URI(
   66 |                    ""file:""
   67 |                            + startURIslashes
   68 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   69 |                                    .replace('\\', '/')
   70 |                                    .replace(' ', '_')
   71 |                            + bar);
>  72 |    java.io.File fileTarget = new java.io.File(fileURI);
   73 |    response.getWriter()
   74 |            .println(
   75 |                    ""Access to file: '""
   76 |                            + org.owasp
   77 |                                    .esapi
   78 |                                    .ESAPI
   79 |                                    .encoder()
   80 |                                    .encodeForHTML(fileTarget.toString())
   81 |                            + ""' created."");
   82 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01161.java,61,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01161.java,"
   51 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   52 |
   53 |         String bar = new Test().doSomething(request, param);
   54 |
   55 |         String fileName = null;
   56 |         java.io.FileOutputStream fos = null;
   57 |
   58 |         try {
   59 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   60 |
>  61 |             fos = new java.io.FileOutputStream(fileName, false);
   62 |             response.getWriter()
   63 |                     .println(
   64 |                             ""Now ready to write to file: ""
   65 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   66 |
   67 |         } catch (Exception e) {
   68 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   69 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   70 |         } finally {
   71 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01231.java,49,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01231.java,"
  39 |     public void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |             throws ServletException, IOException {
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         String param = request.getParameter(""BenchmarkTest01231"");
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = new Test().doSomething(request, param);
  47 |
  48 |         java.io.File fileTarget =
> 49 |                 new java.io.File(
  50 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  51 |         response.getWriter()
  52 |                 .println(
  53 |                         ""Access to file: '""
  54 |                                 + org.owasp
  55 |                                         .esapi
  56 |                                         .ESAPI
  57 |                                         .encoder()
  58 |                                         .encodeForHTML(fileTarget.toString())
  59 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01232.java,49,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01232.java,"
  39 |     public void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |             throws ServletException, IOException {
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         String param = request.getParameter(""BenchmarkTest01232"");
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = new Test().doSomething(request, param);
  47 |
  48 |         java.io.File fileTarget =
> 49 |                 new java.io.File(
  50 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  51 |         response.getWriter()
  52 |                 .println(
  53 |                         ""Access to file: '""
  54 |                                 + org.owasp
  55 |                                         .esapi
  56 |                                         .ESAPI
  57 |                                         .encoder()
  58 |                                         .encodeForHTML(fileTarget.toString())
  59 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01234.java,49,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01234.java,"
  39 |     public void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |             throws ServletException, IOException {
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         String param = request.getParameter(""BenchmarkTest01234"");
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = new Test().doSomething(request, param);
  47 |
  48 |         java.io.File fileTarget =
> 49 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  50 |         response.getWriter()
  51 |                 .println(
  52 |                         ""Access to file: '""
  53 |                                 + org.owasp
  54 |                                         .esapi
  55 |                                         .ESAPI
  56 |                                         .encoder()
  57 |                                         .encodeForHTML(fileTarget.toString())
  58 |                                 + ""' created."");
  59 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01235.java,65,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01235.java,"
   55 |
   56 | ry {
   57 |    java.net.URI fileURI =
   58 |            new java.net.URI(
   59 |                    ""file:""
   60 |                            + startURIslashes
   61 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   62 |                                    .replace('\\', '/')
   63 |                                    .replace(' ', '_')
   64 |                            + bar);
>  65 |    java.io.File fileTarget = new java.io.File(fileURI);
   66 |    response.getWriter()
   67 |            .println(
   68 |                    ""Access to file: '""
   69 |                            + org.owasp
   70 |                                    .esapi
   71 |                                    .ESAPI
   72 |                                    .encoder()
   73 |                                    .encodeForHTML(fileTarget.toString())
   74 |                            + ""' created."");
   75 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01236.java,65,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01236.java,"
  55 |
  56 | ry {
  57 |    java.net.URI fileURI =
  58 |            new java.net.URI(
  59 |                    ""file:""
  60 |                            + startURIslashes
  61 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
  62 |                                    .replace('\\', '/')
  63 |                                    .replace(' ', '_')
  64 |                            + bar);
> 65 |    java.io.File fileTarget = new java.io.File(fileURI);
  66 |    response.getWriter()
  67 |            .println(
  68 |                    ""Access to file: '""
  69 |                            + org.owasp
  70 |                                    .esapi
  71 |                                    .ESAPI
  72 |                                    .encoder()
  73 |                                    .encodeForHTML(fileTarget.toString())
  74 |                            + ""' created."");
  75 |    if (fileTarget.exists()) {
     ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01238.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01238.java,"
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = new Test().doSomething(request, param);
  47 |
  48 |         String fileName = null;
  49 |         java.io.FileOutputStream fos = null;
  50 |
  51 |         try {
  52 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 |             fos = new java.io.FileOutputStream(new java.io.File(fileName), false);
  55 |             response.getWriter()
  56 |                     .println(
  57 |                             ""Now ready to write to file: ""
  58 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 |         } catch (Exception e) {
  61 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 |         } finally {
  64 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01238.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01238.java,"
  44 | == null) param = """";
  45 |
  46 |  = new Test().doSomething(request, param);
  47 |
  48 | eName = null;
  49 | leOutputStream fos = null;
  50 |
  51 |
  52 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 | new java.io.FileOutputStream(new java.io.File(fileName), false);
  55 | se.getWriter()
  56 |   .println(
  57 |           ""Now ready to write to file: ""
  58 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 | xception e) {
  61 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 | {
  64 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01329.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01329.java,"
   62 |            new java.net.URI(
   63 |                    ""file"",
   64 |                    null,
   65 |                    startURIslashes
   66 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   67 |                                    .replace('\\', java.io.File.separatorChar)
   68 |                                    .replace(' ', '_')
   69 |                            + bar,
   70 |                    null,
   71 |                    null);
>  72 |    java.io.File fileTarget = new java.io.File(fileURI);
   73 |    response.getWriter()
   74 |            .println(
   75 |                    ""Access to file: '""
   76 |                            + org.owasp
   77 |                                    .esapi
   78 |                                    .ESAPI
   79 |                                    .encoder()
   80 |                                    .encodeForHTML(fileTarget.toString())
   81 |                            + ""' created."");
   82 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01330.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01330.java,"
  48 |         }
  49 |
  50 |         String bar = new Test().doSomething(request, param);
  51 |
  52 |         String fileName = null;
  53 |         java.io.FileOutputStream fos = null;
  54 |
  55 |         try {
  56 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  57 |
> 58 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  59 |             response.getWriter()
  60 |                     .println(
  61 |                             ""Now ready to write to file: ""
  62 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  63 |
  64 |         } catch (Exception e) {
  65 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  66 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  67 |         } finally {
  68 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01330.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01330.java,"
  48 |
  49 |
  50 |  = new Test().doSomething(request, param);
  51 |
  52 | eName = null;
  53 | leOutputStream fos = null;
  54 |
  55 |
  56 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  57 |
> 58 | new java.io.FileOutputStream(new java.io.File(fileName));
  59 | se.getWriter()
  60 |   .println(
  61 |           ""Now ready to write to file: ""
  62 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  63 |
  64 | xception e) {
  65 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  66 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  67 | {
  68 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01403.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01403.java,"
  53 |                         param = name;
  54 |                         flag = false;
  55 |                     }
  56 |                 }
  57 |             }
  58 |         }
  59 |
  60 |         String bar = new Test().doSomething(request, param);
  61 |
  62 |         java.io.File fileTarget =
> 63 |                 new java.io.File(
  64 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  65 |         response.getWriter()
  66 |                 .println(
  67 |                         ""Access to file: '""
  68 |                                 + org.owasp
  69 |                                         .esapi
  70 |                                         .ESAPI
  71 |                                         .encoder()
  72 |                                         .encodeForHTML(fileTarget.toString())
  73 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01405.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01405.java,"
   57 |             }
   58 |         }
   59 |
   60 |         String bar = new Test().doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n""
   75 |                                     + org.owasp
   76 |                                             .esapi
   77 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01405.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01405.java,"
   57 |
   58 |
   59 |
   60 | r = new Test().doSomething(request, param);
   61 |
   62 | leName = null;
   63 | ileInputStream fis = null;
   64 |
   65 |
   66 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |  new java.io.FileInputStream(new java.io.File(fileName));
   68 | ] b = new byte[1000];
   69 | ize = fis.read(b);
   70 | nse.getWriter()
   71 |    .println(
   72 |            ""The beginning of file: '""
   73 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                    + ""' is:\n\n""
   75 |                    + org.owasp
   76 |                            .esapi
   77 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01408.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01408.java,"
   58 |         }
   59 |
   60 |         String bar = new Test().doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileOutputStream fos = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   67 |
>  68 |             fos = new java.io.FileOutputStream(fileName, false);
   69 |             response.getWriter()
   70 |                     .println(
   71 |                             ""Now ready to write to file: ""
   72 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   73 |
   74 |         } catch (Exception e) {
   75 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   76 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   77 |         } finally {
   78 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01494.java,51,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01494.java,"
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         org.owasp.benchmark.helpers.SeparateClassRequest scr =
  44 |                 new org.owasp.benchmark.helpers.SeparateClassRequest(request);
  45 |         String param = scr.getTheParameter(""BenchmarkTest01494"");
  46 |         if (param == null) param = """";
  47 |
  48 |         String bar = new Test().doSomething(request, param);
  49 |
  50 |         java.io.File fileTarget =
> 51 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  52 |         response.getWriter()
  53 |                 .println(
  54 |                         ""Access to file: '""
  55 |                                 + org.owasp
  56 |                                         .esapi
  57 |                                         .ESAPI
  58 |                                         .encoder()
  59 |                                         .encodeForHTML(fileTarget.toString())
  60 |                                 + ""' created."");
  61 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01495.java,70,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01495.java,"
   60 |            new java.net.URI(
   61 |                    ""file"",
   62 |                    null,
   63 |                    startURIslashes
   64 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   65 |                                    .replace('\\', java.io.File.separatorChar)
   66 |                                    .replace(' ', '_')
   67 |                            + bar,
   68 |                    null,
   69 |                    null);
>  70 |    java.io.File fileTarget = new java.io.File(fileURI);
   71 |    response.getWriter()
   72 |            .println(
   73 |                    ""Access to file: '""
   74 |                            + org.owasp
   75 |                                    .esapi
   76 |                                    .ESAPI
   77 |                                    .encoder()
   78 |                                    .encodeForHTML(fileTarget.toString())
   79 |                            + ""' created."");
   80 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01496.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01496.java,"
   45 |         String param = scr.getTheParameter(""BenchmarkTest01496"");
   46 |         if (param == null) param = """";
   47 |
   48 |         String bar = new Test().doSomething(request, param);
   49 |
   50 |         String fileName = null;
   51 |         java.io.FileInputStream fis = null;
   52 |
   53 |         try {
   54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |             fis = new java.io.FileInputStream(fileName);
   56 |             byte[] b = new byte[1000];
   57 |             int size = fis.read(b);
   58 |             response.getWriter()
   59 |                     .println(
   60 |                             ""The beginning of file: '""
   61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                                     + ""' is:\n\n"");
   63 |             response.getWriter()
   64 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   65 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01497.java,56,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01497.java,"
  46 |         if (param == null) param = """";
  47 |
  48 |         String bar = new Test().doSomething(request, param);
  49 |
  50 |         String fileName = null;
  51 |         java.io.FileOutputStream fos = null;
  52 |
  53 |         try {
  54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  55 |
> 56 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  57 |             response.getWriter()
  58 |                     .println(
  59 |                             ""Now ready to write to file: ""
  60 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  61 |
  62 |         } catch (Exception e) {
  63 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  64 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  65 |         } finally {
  66 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01497.java,56,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01497.java,"
  46 | == null) param = """";
  47 |
  48 |  = new Test().doSomething(request, param);
  49 |
  50 | eName = null;
  51 | leOutputStream fos = null;
  52 |
  53 |
  54 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  55 |
> 56 | new java.io.FileOutputStream(new java.io.File(fileName));
  57 | se.getWriter()
  58 |   .println(
  59 |           ""Now ready to write to file: ""
  60 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  61 |
  62 | xception e) {
  63 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  64 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  65 | {
  66 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01498.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01498.java,"
  52 |
  53 | e the file first so the test won't throw an exception if it doesn't exist.
  54 |  Don't actually do this because this method signature could cause a tool to find
  55 | file constructor
  56 | vuln, rather than the File signature we are trying to actually test.
  57 | cessary, just run the benchmark twice. The 1st run should create all the necessary
  58 | .
  59 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
  60 |
  61 | FileOutputStream fos =
> 62 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
  63 | onse.getWriter()
  64 |     .println(
  65 |             ""Now ready to write to file: ""
  66 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  67 |
  68 | (Exception e) {
  69 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  70 |
  71 | ost
  72 |
     ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01500.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01500.java,"
   44 |        new org.owasp.benchmark.helpers.SeparateClassRequest(request);
   45 | tring param = scr.getTheParameter(""BenchmarkTest01500"");
   46 | f (param == null) param = """";
   47 |
   48 | tring bar = new Test().doSomething(request, param);
   49 |
   50 | tring fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   51 | ava.io.InputStream is = null;
   52 |
   53 | ry {
>  54 |    java.nio.file.Path path = java.nio.file.Paths.get(fileName);
   55 |    is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   56 |    byte[] b = new byte[1000];
   57 |    int size = is.read(b);
   58 |    response.getWriter()
   59 |            .println(
   60 |                    ""The beginning of file: '""
   61 |                            + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                            + ""' is:\n\n"");
   63 |    response.getWriter()
   64 |            .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01500.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01500.java,"
   45 |         String param = scr.getTheParameter(""BenchmarkTest01500"");
   46 |         if (param == null) param = """";
   47 |
   48 |         String bar = new Test().doSomething(request, param);
   49 |
   50 |         String fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   51 |         java.io.InputStream is = null;
   52 |
   53 |         try {
   54 |             java.nio.file.Path path = java.nio.file.Paths.get(fileName);
>  55 |             is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   56 |             byte[] b = new byte[1000];
   57 |             int size = is.read(b);
   58 |             response.getWriter()
   59 |                     .println(
   60 |                             ""The beginning of file: '""
   61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                                     + ""' is:\n\n"");
   63 |             response.getWriter()
   64 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   65 |             is.close();
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01571.java,50,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01571.java,"
  40 |        throws ServletException, IOException {
  41 |    response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |    String[] values = request.getParameterValues(""BenchmarkTest01571"");
  44 |    String param;
  45 |    if (values != null && values.length > 0) param = values[0];
  46 |    else param = """";
  47 |
  48 |    String bar = new Test().doSomething(request, param);
  49 |
> 50 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  51 |    response.getWriter()
  52 |            .println(
  53 |                    ""Access to file: '""
  54 |                            + org.owasp
  55 |                                    .esapi
  56 |                                    .ESAPI
  57 |                                    .encoder()
  58 |                                    .encodeForHTML(fileTarget.toString())
  59 |                            + ""' created."");
  60 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01572.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01572.java,"
   45 |         if (values != null && values.length > 0) param = values[0];
   46 |         else param = """";
   47 |
   48 |         String bar = new Test().doSomething(request, param);
   49 |
   50 |         String fileName = null;
   51 |         java.io.FileInputStream fis = null;
   52 |
   53 |         try {
   54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   56 |             byte[] b = new byte[1000];
   57 |             int size = fis.read(b);
   58 |             response.getWriter()
   59 |                     .println(
   60 |                             ""The beginning of file: '""
   61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                                     + ""' is:\n\n""
   63 |                                     + org.owasp
   64 |                                             .esapi
   65 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01572.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01572.java,"
   45 | s != null && values.length > 0) param = values[0];
   46 | m = """";
   47 |
   48 | r = new Test().doSomething(request, param);
   49 |
   50 | leName = null;
   51 | ileInputStream fis = null;
   52 |
   53 |
   54 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |  new java.io.FileInputStream(new java.io.File(fileName));
   56 | ] b = new byte[1000];
   57 | ize = fis.read(b);
   58 | nse.getWriter()
   59 |    .println(
   60 |            ""The beginning of file: '""
   61 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                    + ""' is:\n\n""
   63 |                    + org.owasp
   64 |                            .esapi
   65 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01642.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01642.java,"
   63 |         // comes after.
   64 |         int ampersandLoc = queryString.indexOf(""&"", paramLoc);
   65 |         if (ampersandLoc != -1) {
   66 |             param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   67 |         }
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = new Test().doSomething(request, param);
   71 |
   72 |         java.io.File fileTarget =
>  73 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
   74 |         response.getWriter()
   75 |                 .println(
   76 |                         ""Access to file: '""
   77 |                                 + org.owasp
   78 |                                         .esapi
   79 |                                         .ESAPI
   80 |                                         .encoder()
   81 |                                         .encodeForHTML(fileTarget.toString())
   82 |                                 + ""' created."");
   83 |         if (fileTarget.exists()) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01643.java,89,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01643.java,"
   79 |
   80 | ry {
   81 |    java.net.URI fileURI =
   82 |            new java.net.URI(
   83 |                    ""file:""
   84 |                            + startURIslashes
   85 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   86 |                                    .replace('\\', '/')
   87 |                                    .replace(' ', '_')
   88 |                            + bar);
>  89 |    java.io.File fileTarget = new java.io.File(fileURI);
   90 |    response.getWriter()
   91 |            .println(
   92 |                    ""Access to file: '""
   93 |                            + org.owasp
   94 |                                    .esapi
   95 |                                    .ESAPI
   96 |                                    .encoder()
   97 |                                    .encodeForHTML(fileTarget.toString())
   98 |                            + ""' created."");
   99 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01645.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01645.java,"
   67 |         }
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = new Test().doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileInputStream fis = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |             fis = new java.io.FileInputStream(fileName);
   78 |             byte[] b = new byte[1000];
   79 |             int size = fis.read(b);
   80 |             response.getWriter()
   81 |                     .println(
   82 |                             ""The beginning of file: '""
   83 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                                     + ""' is:\n\n"");
   85 |             response.getWriter()
   86 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   87 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01647.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01647.java,"
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = new Test().doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileOutputStream fos = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   77 |
>  78 |             fos = new java.io.FileOutputStream(fileName, false);
   79 |             response.getWriter()
   80 |                     .println(
   81 |                             ""Now ready to write to file: ""
   82 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   83 |
   84 |         } catch (Exception e) {
   85 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   86 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   87 |         } finally {
   88 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01833.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01833.java,"
  58 |                 if (theCookie.getName().equals(""BenchmarkTest01833"")) {
  59 |                     param = java.net.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
  60 |                     break;
  61 |                 }
  62 |             }
  63 |         }
  64 |
  65 |         String bar = doSomething(request, param);
  66 |
  67 |         java.io.File fileTarget =
> 68 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  69 |         response.getWriter()
  70 |                 .println(
  71 |                         ""Access to file: '""
  72 |                                 + org.owasp
  73 |                                         .esapi
  74 |                                         .ESAPI
  75 |                                         .encoder()
  76 |                                         .encodeForHTML(fileTarget.toString())
  77 |                                 + ""' created."");
  78 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01835.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01835.java,"
  58 |                 if (theCookie.getName().equals(""BenchmarkTest01835"")) {
  59 |                     param = java.net.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
  60 |                     break;
  61 |                 }
  62 |             }
  63 |         }
  64 |
  65 |         String bar = doSomething(request, param);
  66 |
  67 |         java.io.File fileTarget =
> 68 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  69 |         response.getWriter()
  70 |                 .println(
  71 |                         ""Access to file: '""
  72 |                                 + org.owasp
  73 |                                         .esapi
  74 |                                         .ESAPI
  75 |                                         .encoder()
  76 |                                         .encodeForHTML(fileTarget.toString())
  77 |                                 + ""' created."");
  78 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01836.java,84,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01836.java,"
   74 |
   75 | ry {
   76 |    java.net.URI fileURI =
   77 |            new java.net.URI(
   78 |                    ""file:""
   79 |                            + startURIslashes
   80 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   81 |                                    .replace('\\', '/')
   82 |                                    .replace(' ', '_')
   83 |                            + bar);
>  84 |    java.io.File fileTarget = new java.io.File(fileURI);
   85 |    response.getWriter()
   86 |            .println(
   87 |                    ""Access to file: '""
   88 |                            + org.owasp
   89 |                                    .esapi
   90 |                                    .ESAPI
   91 |                                    .encoder()
   92 |                                    .encodeForHTML(fileTarget.toString())
   93 |                            + ""' created."");
   94 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01839.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01839.java,"
   63 |         }
   64 |
   65 |         String bar = doSomething(request, param);
   66 |
   67 |         String fileName = null;
   68 |         java.io.FileOutputStream fos = null;
   69 |
   70 |         try {
   71 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   72 |
>  73 |             fos = new java.io.FileOutputStream(new java.io.File(fileName), false);
   74 |             response.getWriter()
   75 |                     .println(
   76 |                             ""Now ready to write to file: ""
   77 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   78 |
   79 |         } catch (Exception e) {
   80 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   81 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   82 |         } finally {
   83 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01839.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01839.java,"
   63 |
   64 |
   65 |  = doSomething(request, param);
   66 |
   67 | eName = null;
   68 | leOutputStream fos = null;
   69 |
   70 |
   71 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   72 |
>  73 | new java.io.FileOutputStream(new java.io.File(fileName), false);
   74 | se.getWriter()
   75 |   .println(
   76 |           ""Now ready to write to file: ""
   77 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   78 |
   79 | xception e) {
   80 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   81 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
   82 | {
   83 | s != null) {
      ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01840.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01840.java,"
   63 |         }
   64 |
   65 |         String bar = doSomething(request, param);
   66 |
   67 |         String fileName = null;
   68 |         java.io.FileOutputStream fos = null;
   69 |
   70 |         try {
   71 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   72 |
>  73 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
   74 |             response.getWriter()
   75 |                     .println(
   76 |                             ""Now ready to write to file: ""
   77 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   78 |
   79 |         } catch (Exception e) {
   80 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   81 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   82 |         } finally {
   83 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01840.java,73,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01840.java,"
   63 |
   64 |
   65 |  = doSomething(request, param);
   66 |
   67 | eName = null;
   68 | leOutputStream fos = null;
   69 |
   70 |
   71 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   72 |
>  73 | new java.io.FileOutputStream(new java.io.File(fileName));
   74 | se.getWriter()
   75 |   .println(
   76 |           ""Now ready to write to file: ""
   77 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   78 |
   79 | xception e) {
   80 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   81 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
   82 | {
   83 | s != null) {
      ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01904.java,53,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01904.java,"
  43 |    String param = """";
  44 |    if (request.getHeader(""BenchmarkTest01904"") != null) {
  45 |        param = request.getHeader(""BenchmarkTest01904"");
  46 |    }
  47 |
  48 |    // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |    param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |    String bar = doSomething(request, param);
  52 |
> 53 |    java.io.File fileTarget = new java.io.File(bar);
  54 |    response.getWriter()
  55 |            .println(
  56 |                    ""Access to file: '""
  57 |                            + org.owasp
  58 |                                    .esapi
  59 |                                    .ESAPI
  60 |                                    .encoder()
  61 |                                    .encodeForHTML(fileTarget.toString())
  62 |                            + ""' created."");
  63 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01906.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01906.java,"
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = doSomething(request, param);
  52 |
  53 |         String fileName = null;
  54 |         java.io.FileOutputStream fos = null;
  55 |
  56 |         try {
  57 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  60 |             response.getWriter()
  61 |                     .println(
  62 |                             ""Now ready to write to file: ""
  63 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 |         } catch (Exception e) {
  66 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 |         } finally {
  69 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01906.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01906.java,"
  49 | va.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |  = doSomething(request, param);
  52 |
  53 | eName = null;
  54 | leOutputStream fos = null;
  55 |
  56 |
  57 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 | new java.io.FileOutputStream(new java.io.File(fileName));
  60 | se.getWriter()
  61 |   .println(
  62 |           ""Now ready to write to file: ""
  63 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 | xception e) {
  66 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 | {
  69 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01907.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01907.java,"
  49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |         String bar = doSomething(request, param);
  52 |
  53 |         String fileName = null;
  54 |         java.io.FileOutputStream fos = null;
  55 |
  56 |         try {
  57 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  60 |             response.getWriter()
  61 |                     .println(
  62 |                             ""Now ready to write to file: ""
  63 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 |         } catch (Exception e) {
  66 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 |         } finally {
  69 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01907.java,59,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01907.java,"
  49 | va.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |  = doSomething(request, param);
  52 |
  53 | eName = null;
  54 | leOutputStream fos = null;
  55 |
  56 |
  57 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  58 |
> 59 | new java.io.FileOutputStream(new java.io.File(fileName));
  60 | se.getWriter()
  61 |   .println(
  62 |           ""Now ready to write to file: ""
  63 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  64 |
  65 | xception e) {
  66 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  67 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  68 | {
  69 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01908.java,57,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01908.java,"
   47 |
   48 | / URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
   49 | aram = java.net.URLDecoder.decode(param, ""UTF-8"");
   50 |
   51 | tring bar = doSomething(request, param);
   52 |
   53 | tring fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   54 | ava.io.InputStream is = null;
   55 |
   56 | ry {
>  57 |    java.nio.file.Path path = java.nio.file.Paths.get(fileName);
   58 |    is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   59 |    byte[] b = new byte[1000];
   60 |    int size = is.read(b);
   61 |    response.getWriter()
   62 |            .println(
   63 |                    ""The beginning of file: '""
   64 |                            + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   65 |                            + ""' is:\n\n"");
   66 |    response.getWriter()
   67 |            .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01908.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01908.java,"
   48 |         // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
   49 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   50 |
   51 |         String bar = doSomething(request, param);
   52 |
   53 |         String fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   54 |         java.io.InputStream is = null;
   55 |
   56 |         try {
   57 |             java.nio.file.Path path = java.nio.file.Paths.get(fileName);
>  58 |             is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   59 |             byte[] b = new byte[1000];
   60 |             int size = is.read(b);
   61 |             response.getWriter()
   62 |                     .println(
   63 |                             ""The beginning of file: '""
   64 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   65 |                                     + ""' is:\n\n"");
   66 |             response.getWriter()
   67 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   68 |             is.close();
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01983.java,63,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01983.java,"
  53 |             if (values != null && values.hasMoreElements()) {
  54 |                 param = name;
  55 |                 break;
  56 |             }
  57 |         }
  58 |         // Note: We don't URL decode header names because people don't normally do that
  59 |
  60 |         String bar = doSomething(request, param);
  61 |
  62 |         java.io.File fileTarget =
> 63 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  64 |         response.getWriter()
  65 |                 .println(
  66 |                         ""Access to file: '""
  67 |                                 + org.owasp
  68 |                                         .esapi
  69 |                                         .ESAPI
  70 |                                         .encoder()
  71 |                                         .encodeForHTML(fileTarget.toString())
  72 |                                 + ""' created."");
  73 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01985.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01985.java,"
  52 |        java.util.Enumeration<String> values = request.getHeaders(name);
  53 |        if (values != null && values.hasMoreElements()) {
  54 |            param = name;
  55 |            break;
  56 |        }
  57 |    }
  58 |    // Note: We don't URL decode header names because people don't normally do that
  59 |
  60 |    String bar = doSomething(request, param);
  61 |
> 62 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  63 |    response.getWriter()
  64 |            .println(
  65 |                    ""Access to file: '""
  66 |                            + org.owasp
  67 |                                    .esapi
  68 |                                    .ESAPI
  69 |                                    .encoder()
  70 |                                    .encodeForHTML(fileTarget.toString())
  71 |                            + ""' created."");
  72 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01987.java,82,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01987.java,"
   72 |            new java.net.URI(
   73 |                    ""file"",
   74 |                    null,
   75 |                    startURIslashes
   76 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   77 |                                    .replace('\\', java.io.File.separatorChar)
   78 |                                    .replace(' ', '_')
   79 |                            + bar,
   80 |                    null,
   81 |                    null);
>  82 |    java.io.File fileTarget = new java.io.File(fileURI);
   83 |    response.getWriter()
   84 |            .println(
   85 |                    ""Access to file: '""
   86 |                            + org.owasp
   87 |                                    .esapi
   88 |                                    .ESAPI
   89 |                                    .encoder()
   90 |                                    .encodeForHTML(fileTarget.toString())
   91 |                            + ""' created."");
   92 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01988.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01988.java,"
   57 |         }
   58 |         // Note: We don't URL decode header names because people don't normally do that
   59 |
   60 |         String bar = doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n""
   75 |                                     + org.owasp
   76 |                                             .esapi
   77 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01988.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01988.java,"
   57 |
   58 | We don't URL decode header names because people don't normally do that
   59 |
   60 | r = doSomething(request, param);
   61 |
   62 | leName = null;
   63 | ileInputStream fis = null;
   64 |
   65 |
   66 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |  new java.io.FileInputStream(new java.io.File(fileName));
   68 | ] b = new byte[1000];
   69 | ize = fis.read(b);
   70 | nse.getWriter()
   71 |    .println(
   72 |            ""The beginning of file: '""
   73 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                    + ""' is:\n\n""
   75 |                    + org.owasp
   76 |                            .esapi
   77 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01989.java,68,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01989.java,"
   58 |         // Note: We don't URL decode header names because people don't normally do that
   59 |
   60 |         String bar = doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileOutputStream fos = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   67 |
>  68 |             fos = new java.io.FileOutputStream(fileName, false);
   69 |             response.getWriter()
   70 |                     .println(
   71 |                             ""Now ready to write to file: ""
   72 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   73 |
   74 |         } catch (Exception e) {
   75 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   76 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   77 |         } finally {
   78 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02027.java,56,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02027.java,"
  46 |         if (headers != null && headers.hasMoreElements()) {
  47 |             param = headers.nextElement(); // just grab first element
  48 |         }
  49 |
  50 |         // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |         String bar = doSomething(request, param);
  54 |
  55 |         java.io.File fileTarget =
> 56 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  57 |         response.getWriter()
  58 |                 .println(
  59 |                         ""Access to file: '""
  60 |                                 + org.owasp
  61 |                                         .esapi
  62 |                                         .ESAPI
  63 |                                         .encoder()
  64 |                                         .encodeForHTML(fileTarget.toString())
  65 |                                 + ""' created."");
  66 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02032.java,60,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02032.java,"
  50 |         // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |         String bar = doSomething(request, param);
  54 |
  55 |         String fileName = null;
  56 |         java.io.FileInputStream fis = null;
  57 |
  58 |         try {
  59 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
> 60 |             fis = new java.io.FileInputStream(fileName);
  61 |             byte[] b = new byte[1000];
  62 |             int size = fis.read(b);
  63 |             response.getWriter()
  64 |                     .println(
  65 |                             ""The beginning of file: '""
  66 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
  67 |                                     + ""' is:\n\n"");
  68 |             response.getWriter()
  69 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
  70 |         } catch (Exception e) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02034.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02034.java,"
  57 |
  58 | e the file first so the test won't throw an exception if it doesn't exist.
  59 |  Don't actually do this because this method signature could cause a tool to find
  60 | file constructor
  61 | vuln, rather than the File signature we are trying to actually test.
  62 | cessary, just run the benchmark twice. The 1st run should create all the necessary
  63 | .
  64 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
  65 |
  66 | FileOutputStream fos =
> 67 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
  68 | onse.getWriter()
  69 |     .println(
  70 |             ""Now ready to write to file: ""
  71 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  72 |
  73 | (Exception e) {
  74 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  75 |
  76 | ost
  77 |
     ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02105.java,49,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02105.java,"
  39 |     public void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |             throws ServletException, IOException {
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         String param = request.getParameter(""BenchmarkTest02105"");
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = doSomething(request, param);
  47 |
  48 |         java.io.File fileTarget =
> 49 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  50 |         response.getWriter()
  51 |                 .println(
  52 |                         ""Access to file: '""
  53 |                                 + org.owasp
  54 |                                         .esapi
  55 |                                         .ESAPI
  56 |                                         .encoder()
  57 |                                         .encodeForHTML(fileTarget.toString())
  58 |                                 + ""' created."");
  59 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02106.java,48,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02106.java,"
  38 | Override
  39 | ublic void doPost(HttpServletRequest request, HttpServletResponse response)
  40 |        throws ServletException, IOException {
  41 |    response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |    String param = request.getParameter(""BenchmarkTest02106"");
  44 |    if (param == null) param = """";
  45 |
  46 |    String bar = doSomething(request, param);
  47 |
> 48 |    java.io.File fileTarget = new java.io.File(bar);
  49 |    response.getWriter()
  50 |            .println(
  51 |                    ""Access to file: '""
  52 |                            + org.owasp
  53 |                                    .esapi
  54 |                                    .ESAPI
  55 |                                    .encoder()
  56 |                                    .encodeForHTML(fileTarget.toString())
  57 |                            + ""' created."");
  58 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02109.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02109.java,"
  44 |         if (param == null) param = """";
  45 |
  46 |         String bar = doSomething(request, param);
  47 |
  48 |         String fileName = null;
  49 |         java.io.FileOutputStream fos = null;
  50 |
  51 |         try {
  52 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 |             fos = new java.io.FileOutputStream(new java.io.File(fileName));
  55 |             response.getWriter()
  56 |                     .println(
  57 |                             ""Now ready to write to file: ""
  58 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 |         } catch (Exception e) {
  61 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 |         } finally {
  64 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02109.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02109.java,"
  44 | == null) param = """";
  45 |
  46 |  = doSomething(request, param);
  47 |
  48 | eName = null;
  49 | leOutputStream fos = null;
  50 |
  51 |
  52 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  53 |
> 54 | new java.io.FileOutputStream(new java.io.File(fileName));
  55 | se.getWriter()
  56 |   .println(
  57 |           ""Now ready to write to file: ""
  58 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  59 |
  60 | xception e) {
  61 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  62 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
  63 | {
  64 | s != null) {
     ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02112.java,54,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02112.java,"
   44 |         if (param == null) param = """";
   45 |
   46 |         String bar = doSomething(request, param);
   47 |
   48 |         String fileName = null;
   49 |         java.io.FileOutputStream fos = null;
   50 |
   51 |         try {
   52 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   53 |
>  54 |             fos = new java.io.FileOutputStream(fileName, false);
   55 |             response.getWriter()
   56 |                     .println(
   57 |                             ""Now ready to write to file: ""
   58 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   59 |
   60 |         } catch (Exception e) {
   61 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   62 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   63 |         } finally {
   64 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02113.java,52,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02113.java,"
   42 |
   43 | tring param = request.getParameter(""BenchmarkTest02113"");
   44 | f (param == null) param = """";
   45 |
   46 | tring bar = doSomething(request, param);
   47 |
   48 | tring fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   49 | ava.io.InputStream is = null;
   50 |
   51 | ry {
>  52 |    java.nio.file.Path path = java.nio.file.Paths.get(fileName);
   53 |    is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   54 |    byte[] b = new byte[1000];
   55 |    int size = is.read(b);
   56 |    response.getWriter()
   57 |            .println(
   58 |                    ""The beginning of file: '""
   59 |                            + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   60 |                            + ""' is:\n\n"");
   61 |    response.getWriter()
   62 |            .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02113.java,53,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02113.java,"
   43 |         String param = request.getParameter(""BenchmarkTest02113"");
   44 |         if (param == null) param = """";
   45 |
   46 |         String bar = doSomething(request, param);
   47 |
   48 |         String fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   49 |         java.io.InputStream is = null;
   50 |
   51 |         try {
   52 |             java.nio.file.Path path = java.nio.file.Paths.get(fileName);
>  53 |             is = java.nio.file.Files.newInputStream(path, java.nio.file.StandardOpenOption.READ);
   54 |             byte[] b = new byte[1000];
   55 |             int size = is.read(b);
   56 |             response.getWriter()
   57 |                     .println(
   58 |                             ""The beginning of file: '""
   59 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   60 |                                     + ""' is:\n\n"");
   61 |             response.getWriter()
   62 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   63 |             is.close();
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02197.java,53,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02197.java,"
  43 |         java.util.Map<String, String[]> map = request.getParameterMap();
  44 |         String param = """";
  45 |         if (!map.isEmpty()) {
  46 |             String[] values = map.get(""BenchmarkTest02197"");
  47 |             if (values != null) param = values[0];
  48 |         }
  49 |
  50 |         String bar = doSomething(request, param);
  51 |
  52 |         java.io.File fileTarget =
> 53 |                 new java.io.File(
  54 |                         new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar);
  55 |         response.getWriter()
  56 |                 .println(
  57 |                         ""Access to file: '""
  58 |                                 + org.owasp
  59 |                                         .esapi
  60 |                                         .ESAPI
  61 |                                         .encoder()
  62 |                                         .encodeForHTML(fileTarget.toString())
  63 |                                 + ""' created."");
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02198.java,53,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02198.java,"
  43 |         java.util.Map<String, String[]> map = request.getParameterMap();
  44 |         String param = """";
  45 |         if (!map.isEmpty()) {
  46 |             String[] values = map.get(""BenchmarkTest02198"");
  47 |             if (values != null) param = values[0];
  48 |         }
  49 |
  50 |         String bar = doSomething(request, param);
  51 |
  52 |         java.io.File fileTarget =
> 53 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  54 |         response.getWriter()
  55 |                 .println(
  56 |                         ""Access to file: '""
  57 |                                 + org.owasp
  58 |                                         .esapi
  59 |                                         .ESAPI
  60 |                                         .encoder()
  61 |                                         .encodeForHTML(fileTarget.toString())
  62 |                                 + ""' created."");
  63 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02199.java,52,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02199.java,"
  42 |
  43 |    java.util.Map<String, String[]> map = request.getParameterMap();
  44 |    String param = """";
  45 |    if (!map.isEmpty()) {
  46 |        String[] values = map.get(""BenchmarkTest02199"");
  47 |        if (values != null) param = values[0];
  48 |    }
  49 |
  50 |    String bar = doSomething(request, param);
  51 |
> 52 |    java.io.File fileTarget = new java.io.File(bar);
  53 |    response.getWriter()
  54 |            .println(
  55 |                    ""Access to file: '""
  56 |                            + org.owasp
  57 |                                    .esapi
  58 |                                    .ESAPI
  59 |                                    .encoder()
  60 |                                    .encodeForHTML(fileTarget.toString())
  61 |                            + ""' created."");
  62 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02205.java,58,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02205.java,"
  48 |         }
  49 |
  50 |         String bar = doSomething(request, param);
  51 |
  52 |         String fileName = null;
  53 |         java.io.FileOutputStream fos = null;
  54 |
  55 |         try {
  56 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  57 |
> 58 |             fos = new java.io.FileOutputStream(fileName);
  59 |             response.getWriter()
  60 |                     .println(
  61 |                             ""Now ready to write to file: ""
  62 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  63 |
  64 |         } catch (Exception e) {
  65 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  66 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  67 |         } finally {
  68 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02302.java,62,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02302.java,"
  52 |                if (value.equals(""BenchmarkTest02302"")) {
  53 |                    param = name;
  54 |                    flag = false;
  55 |                }
  56 |            }
  57 |        }
  58 |    }
  59 |
  60 |    String bar = doSomething(request, param);
  61 |
> 62 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  63 |    response.getWriter()
  64 |            .println(
  65 |                    ""Access to file: '""
  66 |                            + org.owasp
  67 |                                    .esapi
  68 |                                    .ESAPI
  69 |                                    .encoder()
  70 |                                    .encodeForHTML(fileTarget.toString())
  71 |                            + ""' created."");
  72 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02303.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02303.java,"
   57 |             }
   58 |         }
   59 |
   60 |         String bar = doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n""
   75 |                                     + org.owasp
   76 |                                             .esapi
   77 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02303.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02303.java,"
   57 |
   58 |
   59 |
   60 | r = doSomething(request, param);
   61 |
   62 | leName = null;
   63 | ileInputStream fis = null;
   64 |
   65 |
   66 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |  new java.io.FileInputStream(new java.io.File(fileName));
   68 | ] b = new byte[1000];
   69 | ize = fis.read(b);
   70 | nse.getWriter()
   71 |    .println(
   72 |            ""The beginning of file: '""
   73 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                    + ""' is:\n\n""
   75 |                    + org.owasp
   76 |                            .esapi
   77 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02304.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02304.java,"
   57 |             }
   58 |         }
   59 |
   60 |         String bar = doSomething(request, param);
   61 |
   62 |         String fileName = null;
   63 |         java.io.FileInputStream fis = null;
   64 |
   65 |         try {
   66 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  67 |             fis = new java.io.FileInputStream(fileName);
   68 |             byte[] b = new byte[1000];
   69 |             int size = fis.read(b);
   70 |             response.getWriter()
   71 |                     .println(
   72 |                             ""The beginning of file: '""
   73 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   74 |                                     + ""' is:\n\n"");
   75 |             response.getWriter()
   76 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   77 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02377.java,50,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02377.java,"
  40 |        throws ServletException, IOException {
  41 |    response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |    org.owasp.benchmark.helpers.SeparateClassRequest scr =
  44 |            new org.owasp.benchmark.helpers.SeparateClassRequest(request);
  45 |    String param = scr.getTheParameter(""BenchmarkTest02377"");
  46 |    if (param == null) param = """";
  47 |
  48 |    String bar = doSomething(request, param);
  49 |
> 50 |    java.io.File fileTarget = new java.io.File(bar, ""/Test.txt"");
  51 |    response.getWriter()
  52 |            .println(
  53 |                    ""Access to file: '""
  54 |                            + org.owasp
  55 |                                    .esapi
  56 |                                    .ESAPI
  57 |                                    .encoder()
  58 |                                    .encodeForHTML(fileTarget.toString())
  59 |                            + ""' created."");
  60 |    if (fileTarget.exists()) {
     ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02378.java,67,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02378.java,"
  57 |
  58 | ry {
  59 |    java.net.URI fileURI =
  60 |            new java.net.URI(
  61 |                    ""file:""
  62 |                            + startURIslashes
  63 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
  64 |                                    .replace('\\', '/')
  65 |                                    .replace(' ', '_')
  66 |                            + bar);
> 67 |    java.io.File fileTarget = new java.io.File(fileURI);
  68 |    response.getWriter()
  69 |            .println(
  70 |                    ""Access to file: '""
  71 |                            + org.owasp
  72 |                                    .esapi
  73 |                                    .ESAPI
  74 |                                    .encoder()
  75 |                                    .encodeForHTML(fileTarget.toString())
  76 |                            + ""' created."");
  77 |    if (fileTarget.exists()) {
     ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02383.java,56,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02383.java,"
  46 |         if (param == null) param = """";
  47 |
  48 |         String bar = doSomething(request, param);
  49 |
  50 |         String fileName = null;
  51 |         java.io.FileOutputStream fos = null;
  52 |
  53 |         try {
  54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  55 |
> 56 |             fos = new java.io.FileOutputStream(fileName);
  57 |             response.getWriter()
  58 |                     .println(
  59 |                             ""Now ready to write to file: ""
  60 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  61 |
  62 |         } catch (Exception e) {
  63 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  64 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  65 |         } finally {
  66 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02463.java,51,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02463.java,"
  41 |         response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |         String[] values = request.getParameterValues(""BenchmarkTest02463"");
  44 |         String param;
  45 |         if (values != null && values.length > 0) param = values[0];
  46 |         else param = """";
  47 |
  48 |         String bar = doSomething(request, param);
  49 |
  50 |         java.io.File fileTarget =
> 51 |                 new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar);
  52 |         response.getWriter()
  53 |                 .println(
  54 |                         ""Access to file: '""
  55 |                                 + org.owasp
  56 |                                         .esapi
  57 |                                         .ESAPI
  58 |                                         .encoder()
  59 |                                         .encodeForHTML(fileTarget.toString())
  60 |                                 + ""' created."");
  61 |         if (fileTarget.exists()) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02465.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02465.java,"
   45 |         if (values != null && values.length > 0) param = values[0];
   46 |         else param = """";
   47 |
   48 |         String bar = doSomething(request, param);
   49 |
   50 |         String fileName = null;
   51 |         java.io.FileInputStream fis = null;
   52 |
   53 |         try {
   54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   56 |             byte[] b = new byte[1000];
   57 |             int size = fis.read(b);
   58 |             response.getWriter()
   59 |                     .println(
   60 |                             ""The beginning of file: '""
   61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                                     + ""' is:\n\n""
   63 |                                     + org.owasp
   64 |                                             .esapi
   65 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02465.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02465.java,"
   45 | s != null && values.length > 0) param = values[0];
   46 | m = """";
   47 |
   48 | r = doSomething(request, param);
   49 |
   50 | leName = null;
   51 | ileInputStream fis = null;
   52 |
   53 |
   54 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |  new java.io.FileInputStream(new java.io.File(fileName));
   56 | ] b = new byte[1000];
   57 | ize = fis.read(b);
   58 | nse.getWriter()
   59 |    .println(
   60 |            ""The beginning of file: '""
   61 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                    + ""' is:\n\n""
   63 |                    + org.owasp
   64 |                            .esapi
   65 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02466.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02466.java,"
   45 |         if (values != null && values.length > 0) param = values[0];
   46 |         else param = """";
   47 |
   48 |         String bar = doSomething(request, param);
   49 |
   50 |         String fileName = null;
   51 |         java.io.FileInputStream fis = null;
   52 |
   53 |         try {
   54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   56 |             byte[] b = new byte[1000];
   57 |             int size = fis.read(b);
   58 |             response.getWriter()
   59 |                     .println(
   60 |                             ""The beginning of file: '""
   61 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                                     + ""' is:\n\n""
   63 |                                     + org.owasp
   64 |                                             .esapi
   65 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02466.java,55,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02466.java,"
   45 | s != null && values.length > 0) param = values[0];
   46 | m = """";
   47 |
   48 | r = doSomething(request, param);
   49 |
   50 | leName = null;
   51 | ileInputStream fis = null;
   52 |
   53 |
   54 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  55 |  new java.io.FileInputStream(new java.io.File(fileName));
   56 | ] b = new byte[1000];
   57 | ize = fis.read(b);
   58 | nse.getWriter()
   59 |    .println(
   60 |            ""The beginning of file: '""
   61 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   62 |                    + ""' is:\n\n""
   63 |                    + org.owasp
   64 |                            .esapi
   65 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02469.java,56,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02469.java,"
  46 |         else param = """";
  47 |
  48 |         String bar = doSomething(request, param);
  49 |
  50 |         String fileName = null;
  51 |         java.io.FileOutputStream fos = null;
  52 |
  53 |         try {
  54 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
  55 |
> 56 |             fos = new java.io.FileOutputStream(fileName, false);
  57 |             response.getWriter()
  58 |                     .println(
  59 |                             ""Now ready to write to file: ""
  60 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
  61 |
  62 |         } catch (Exception e) {
  63 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
  64 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
  65 |         } finally {
  66 |             if (fos != null) {
     ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02555.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02555.java,"
   62 |    // And then check to see if its in the middle of the query string and if so, trim off what
   63 |    // comes after.
   64 |    int ampersandLoc = queryString.indexOf(""&"", paramLoc);
   65 |    if (ampersandLoc != -1) {
   66 |        param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   67 |    }
   68 |    param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |    String bar = doSomething(request, param);
   71 |
>  72 |    java.io.File fileTarget = new java.io.File(bar);
   73 |    response.getWriter()
   74 |            .println(
   75 |                    ""Access to file: '""
   76 |                            + org.owasp
   77 |                                    .esapi
   78 |                                    .ESAPI
   79 |                                    .encoder()
   80 |                                    .encodeForHTML(fileTarget.toString())
   81 |                            + ""' created."");
   82 |    if (fileTarget.exists()) {
      ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02556.java,72,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02556.java,"
   62 |    // And then check to see if its in the middle of the query string and if so, trim off what
   63 |    // comes after.
   64 |    int ampersandLoc = queryString.indexOf(""&"", paramLoc);
   65 |    if (ampersandLoc != -1) {
   66 |        param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   67 |    }
   68 |    param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |    String bar = doSomething(request, param);
   71 |
>  72 |    java.io.File fileTarget = new java.io.File(bar);
   73 |    response.getWriter()
   74 |            .println(
   75 |                    ""Access to file: '""
   76 |                            + org.owasp
   77 |                                    .esapi
   78 |                                    .ESAPI
   79 |                                    .encoder()
   80 |                                    .encodeForHTML(fileTarget.toString())
   81 |                            + ""' created."");
   82 |    if (fileTarget.exists()) {
      ^ Col 5
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02559.java,89,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02559.java,"
   79 |
   80 | ry {
   81 |    java.net.URI fileURI =
   82 |            new java.net.URI(
   83 |                    ""file:""
   84 |                            + startURIslashes
   85 |                            + org.owasp.benchmark.helpers.Utils.TESTFILES_DIR
   86 |                                    .replace('\\', '/')
   87 |                                    .replace(' ', '_')
   88 |                            + bar);
>  89 |    java.io.File fileTarget = new java.io.File(fileURI);
   90 |    response.getWriter()
   91 |            .println(
   92 |                    ""Access to file: '""
   93 |                            + org.owasp
   94 |                                    .esapi
   95 |                                    .ESAPI
   96 |                                    .encoder()
   97 |                                    .encodeForHTML(fileTarget.toString())
   98 |                            + ""' created."");
   99 |    if (fileTarget.exists()) {
      ^ Col 9
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02560.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02560.java,"
   67 |         }
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileInputStream fis = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |             fis = new java.io.FileInputStream(new java.io.File(fileName));
   78 |             byte[] b = new byte[1000];
   79 |             int size = fis.read(b);
   80 |             response.getWriter()
   81 |                     .println(
   82 |                             ""The beginning of file: '""
   83 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                                     + ""' is:\n\n""
   85 |                                     + org.owasp
   86 |                                             .esapi
   87 |                                             .ESAPI
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02560.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02560.java,"
   67 |
   68 | ava.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 | r = doSomething(request, param);
   71 |
   72 | leName = null;
   73 | ileInputStream fis = null;
   74 |
   75 |
   76 | ame = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |  new java.io.FileInputStream(new java.io.File(fileName));
   78 | ] b = new byte[1000];
   79 | ize = fis.read(b);
   80 | nse.getWriter()
   81 |    .println(
   82 |            ""The beginning of file: '""
   83 |                    + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                    + ""' is:\n\n""
   85 |                    + org.owasp
   86 |                            .esapi
   87 |                            .ESAPI
      ^ Col 17
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02561.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02561.java,"
   67 |         }
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileInputStream fis = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |             fis = new java.io.FileInputStream(fileName);
   78 |             byte[] b = new byte[1000];
   79 |             int size = fis.read(b);
   80 |             response.getWriter()
   81 |                     .println(
   82 |                             ""The beginning of file: '""
   83 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                                     + ""' is:\n\n"");
   85 |             response.getWriter()
   86 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   87 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02562.java,77,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02562.java,"
   67 |         }
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileInputStream fis = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
>  77 |             fis = new java.io.FileInputStream(fileName);
   78 |             byte[] b = new byte[1000];
   79 |             int size = fis.read(b);
   80 |             response.getWriter()
   81 |                     .println(
   82 |                             ""The beginning of file: '""
   83 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName)
   84 |                                     + ""' is:\n\n"");
   85 |             response.getWriter()
   86 |                     .println(org.owasp.esapi.ESAPI.encoder().encodeForHTML(new String(b, 0, size)));
   87 |         } catch (Exception e) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02564.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02564.java,"
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileOutputStream fos = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   77 |
>  78 |             fos = new java.io.FileOutputStream(new java.io.File(fileName), false);
   79 |             response.getWriter()
   80 |                     .println(
   81 |                             ""Now ready to write to file: ""
   82 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   83 |
   84 |         } catch (Exception e) {
   85 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   86 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   87 |         } finally {
   88 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02564.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02564.java,"
   68 | va.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |  = doSomething(request, param);
   71 |
   72 | eName = null;
   73 | leOutputStream fos = null;
   74 |
   75 |
   76 | me = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   77 |
>  78 | new java.io.FileOutputStream(new java.io.File(fileName), false);
   79 | se.getWriter()
   80 |   .println(
   81 |           ""Now ready to write to file: ""
   82 |                   + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   83 |
   84 | xception e) {
   85 | .out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   86 | ystem.out.println(""File exception caught and swallowed: "" + e.getMessage());
   87 | {
   88 | s != null) {
      ^ Col 18
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02565.java,84,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02565.java,"
   74 |
   75 | e the file first so the test won't throw an exception if it doesn't exist.
   76 |  Don't actually do this because this method signature could cause a tool to find
   77 | file constructor
   78 | vuln, rather than the File signature we are trying to actually test.
   79 | cessary, just run the benchmark twice. The 1st run should create all the necessary
   80 | .
   81 | ava.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar).createNewFile();
   82 |
   83 | FileOutputStream fos =
>  84 | new java.io.FileOutputStream(new java.io.FileInputStream(fileName).getFD()); ) {
   85 | onse.getWriter()
   86 |     .println(
   87 |             ""Now ready to write to file: ""
   88 |                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   89 |
   90 | (Exception e) {
   91 | em.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   92 |
   93 | ost
   94 |
      ^ Col 16
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02567.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02567.java,"
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileOutputStream fos = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   77 |
>  78 |             fos = new java.io.FileOutputStream(fileName, false);
   79 |             response.getWriter()
   80 |                     .println(
   81 |                             ""Now ready to write to file: ""
   82 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   83 |
   84 |         } catch (Exception e) {
   85 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   86 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   87 |         } finally {
   88 |             if (fos != null) {
      ^ Col 0
"
F063,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02569.java,78,22,skims,F063. Lack of data validation - Path Traversal,Path traversal in src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02569.java,"
   68 |         param = java.net.URLDecoder.decode(param, ""UTF-8"");
   69 |
   70 |         String bar = doSomething(request, param);
   71 |
   72 |         String fileName = null;
   73 |         java.io.FileOutputStream fos = null;
   74 |
   75 |         try {
   76 |             fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar;
   77 |
>  78 |             fos = new java.io.FileOutputStream(fileName);
   79 |             response.getWriter()
   80 |                     .println(
   81 |                             ""Now ready to write to file: ""
   82 |                                     + org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));
   83 |
   84 |         } catch (Exception e) {
   85 |             System.out.println(""Couldn't open FileOutputStream on file: '"" + fileName + ""'"");
   86 |             //   System.out.println(""File exception caught and swallowed: "" + e.getMessage());
   87 |         } finally {
   88 |             if (fos != null) {
      ^ Col 0
"
