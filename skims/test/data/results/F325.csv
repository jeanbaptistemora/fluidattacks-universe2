finding,kind,what,where,cwe,stream,title,description,snippet,method
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml,23,250,skims,325. Excessive privileges - Wildcards,"Amazon KMS master keys are exposed to everyone
 in namespace/skims/test/data/lib_path/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml","
  13 |         Statement:
  14 |           - Sid: Enable IAM User Permissions
  15 |             Effect: Allow
  16 |             Principal:
  17 |               AWS: arn:aws:iam::111122223333:root
  18 |             Action: kms:*
  19 |             Resource: '*'
  20 |           - Sid: Enable IAM User Permissions
  21 |             Effect: Allow
  22 |             Principal:
> 23 |               AWS: '*'
  24 |             Action: kms:*
  25 |             Resource: '*'
  26 |   key2:
  27 |     Type: AWS::KMS::Key
  28 |     Properties:
  29 |       Description: An example multi-Region primary key
  30 |       MultiRegion: true
  31 |       EnableKeyRotation: false
  32 |       PendingWindowInDays: 10
  33 |       KeyPolicy:
     ^ Col 0
",cloudformation.cfn_kms_key_has_master_keys_exposed_to_everyone
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml.json,27,250,skims,325. Excessive privileges - Wildcards,"Amazon KMS master keys are exposed to everyone
 in namespace/skims/test/data/lib_path/f325/cfn_kms_key_has_master_keys_exposed_to_everyone.yaml.json","
  17 |               ""Principal"": {
  18 |                 ""AWS"": ""arn:aws:iam::111122223333:root""
  19 |               },
  20 |               ""Action"": ""kms:*"",
  21 |               ""Resource"": ""*""
  22 |             },
  23 |             {
  24 |               ""Sid"": ""Enable IAM User Permissions"",
  25 |               ""Effect"": ""Allow"",
  26 |               ""Principal"": {
> 27 |                 ""AWS"": ""*""
  28 |               },
  29 |               ""Action"": ""kms:*"",
  30 |               ""Resource"": ""*""
  31 |             }
  32 |           ]
  33 |         }
  34 |       }
  35 |     },
  36 |     ""key2"": {
  37 |       ""Type"": ""AWS::KMS::Key"",
     ^ Col 0
",cloudformation.cfn_kms_key_has_master_keys_exposed_to_everyone
F325,lines,namespace/skims/test/data/lib_root/f325/tfm_kms_key_has_master_keys_exposed_to_everyone.tf,5,250,skims,325. Excessive privileges - Wildcards,"Amazon KMS master keys are exposed to everyone
 in namespace/skims/test/data/lib_root/f325/tfm_kms_key_has_master_keys_exposed_to_everyone.tf","
   1 | resource ""aws_kms_key"" ""vuln_key_exposed_1"" {
   2 |   description             = ""KMS key 1""
   3 |   deletion_window_in_days = 10
   4 |
>  5 |   policy = <<-EOF
   6 |   {
   7 |     ""Version"": ""2012-10-17"",
   8 |     ""Statement"": [
   9 |       {
  10 |         ""Principal"": {
  11 |           ""AWS"": ""*""
  12 |         },
  13 |         ""Effect"": ""Allow""
  14 |       }
  15 |     ]
  16 |   }
  17 |   EOF
  18 | }
  19 |
  20 |
  21 | resource ""aws_kms_key"" ""sec_key"" {
     ^ Col 0
",terraform.tfm_kms_key_has_master_keys_exposed_to_everyone
F325,inputs,arn:aws:iam::123456789012:alias/ (namespace),/Statement/0/Principal/AWS: *,250,skims,325. Excessive privileges - Wildcards,"Amazon KMS master keys are exposed to everyone
","
  1 | {
  2 |     ""Statement"": [
  3 |         {
  4 |             ""Principal"": {
> 5 |                 ""AWS"": ""*""
  6 |             }
  7 |         }
  8 |     ]
  9 | }
    ^ Col 0
",aws.kms_has_master_keys_exposed_to_everyone
F325,inputs,arn:aws:iam::123456789012:policy/myPolicy (namespace),"IAM Policy should consider the next rules:
- Should not allow  action. - Should not apply directly to users, Should be on group. - Should not allow  resource with PassRole action. - Should not allow  resource. - Should not allow AllowNotAction. - Should not allow AllowNotResource.
",250,skims,325. Excessive privileges - Wildcards,"IAM Policy should consider the next rules:
- Should not allow  action. - Should not apply directly to users, Should be on group. - Should not allow  resource with PassRole action. - Should not allow  resource. - Should not allow AllowNotAction. - Should not allow AllowNotResource.
","
  1 | {
  2 |     ""Document"": ""{'Statement':[{'Effect': 'Allow', 'Action': '*', 'Resource': '*'},{'Effect': 'Allow', 'Resource': '*',
    | 'Action': '*',},{'Effect': 'Allow', 'NotAction': ['w',], 'NotResource': ['w',]} ],}"",
  3 |     ""VersionId"": ""v1"",
  4 |     ""IsDefaultVersion"": true
  5 | }
    ^ Col 0
",aws.iam_is_policy_miss_configured
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml,53,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml","
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
  47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
> 53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml,46,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml","
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
> 46 |                 Action: iam:*
  47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json,69,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json","
  59 |         },
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
> 69 |                   ""Action"": ""iam:*"",
  70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json,82,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json","
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
  81 |                   ""Effect"": ""Allow"",
> 82 |                   ""Action"": ""*"",
  83 |                   ""Resource"": ""s3:GetObject""
  84 |                 }
  85 |               ]
  86 |             }
  87 |           }
  88 |         ]
  89 |       }
  90 |     }
  91 |   }
  92 | }
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,28,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
>  28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,76,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   66 |                 - ec2.amazonaws.com
   67 |             Action:
   68 |               - sts:AssumeRole
   69 |       Path: /
   70 |       Policies:
   71 |         - PolicyName: root
   72 |           PolicyDocument:
   73 |             Version: '2012-10-17'
   74 |             Statement:
   75 |               - Effect: Allow
>  76 |                 Action: '*'
   77 |                 Resource: '*'
   78 |         - PolicyName: root
   79 |           PolicyDocument:
   80 |             Version: '2012-10-17'
   81 |             Statement:
   82 |               - Effect: Deny
   83 |                 Action: '*'
   84 |                 Resource: '*'
   85 |         - PolicyName: root
   86 |           PolicyDocument:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,104,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   86 |           PolicyDocument:
   87 |             Version: '2012-10-17'
   88 |             Statement:
   89 |               - Effect: Allow
   90 |                 Action: ec2:ModifySnapshotAttribute
   91 |                 Resource: '*'
   92 |         - PolicyName: root
   93 |           PolicyDocument:
   94 |             Version: '2012-10-17'
   95 |             Statement:
   96 |               - Effect: Allow
   97 |                 Action: s3:List*
   98 |                 Resource: '*'
   99 |         - PolicyName: root
  100 |           PolicyDocument:
  101 |             Version: '2012-10-17'
  102 |             Statement:
  103 |               - Effect: Allow
> 104 |                 Action: '*'
  105 |                 Resource:
  106 |                   - ec2:StartInstances
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,38,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
>  38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,116,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
  106 |         },
  107 |         ""Path"": ""/"",
  108 |         ""Policies"": [
  109 |           {
  110 |             ""PolicyName"": ""root"",
  111 |             ""PolicyDocument"": {
  112 |               ""Version"": ""2012-10-17"",
  113 |               ""Statement"": [
  114 |                 {
  115 |                   ""Effect"": ""Allow"",
> 116 |                   ""Action"": ""*"",
  117 |                   ""Resource"": ""*""
  118 |                 }
  119 |               ]
  120 |             }
  121 |           },
  122 |           {
  123 |             ""PolicyName"": ""root"",
  124 |             ""PolicyDocument"": {
  125 |               ""Version"": ""2012-10-17"",
  126 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,168,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
  158 |               ]
  159 |             }
  160 |           },
  161 |           {
  162 |             ""PolicyName"": ""root"",
  163 |             ""PolicyDocument"": {
  164 |               ""Version"": ""2012-10-17"",
  165 |               ""Statement"": [
  166 |                 {
  167 |                   ""Effect"": ""Allow"",
> 168 |                   ""Action"": ""*"",
  169 |                   ""Resource"": [
  170 |                     ""ec2:StartInstances""
  171 |                   ]
  172 |                 }
  173 |               ]
  174 |             }
  175 |           }
  176 |         ]
  177 |       }
  178 |     }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,28,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
   22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
>  28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
   33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,87,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   77 |         - !Ref CFNUserGroup
   78 |   CreateTestDABPolicy:
   79 |     Type: AWS::IAM::ManagedPolicy
   80 |     Properties:
   81 |       Description: Policy for creating a test database
   82 |       Path: /
   83 |       PolicyDocument:
   84 |         Version: '2012-10-17'
   85 |         Statement:
   86 |           - Effect: Allow
>  87 |             Action: iam:*
   88 |             Condition:
   89 |               StringEquals:
   90 |                 rds:DatabaseEngine: mysql
   91 |           - Effect: Allow
   92 |             Action: rds:CreateGlobalCluster
   93 |             Resource:
   94 |               - ''
   95 |               - ec2:StartInstances
   96 |               - s3:GetObject
   97 |           - Effect: Allow
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,133,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
  123 |       Path: /
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
> 133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,140,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
> 140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
  145 |             Statement:
  146 |               - Effect: Allow
  147 |                 NotAction: '*'
  148 |                 NotResource: s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,38,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
>  38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
   44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,131,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  121 |     ""CreateTestDABPolicy"": {
  122 |       ""Type"": ""AWS::IAM::ManagedPolicy"",
  123 |       ""Properties"": {
  124 |         ""Description"": ""Policy for creating a test database"",
  125 |         ""Path"": ""/"",
  126 |         ""PolicyDocument"": {
  127 |           ""Version"": ""2012-10-17"",
  128 |           ""Statement"": [
  129 |             {
  130 |               ""Effect"": ""Allow"",
> 131 |               ""Action"": ""iam:*"",
  132 |               ""Condition"": {
  133 |                 ""StringEquals"": {
  134 |                   ""rds:DatabaseEngine"": ""mysql""
  135 |                 }
  136 |               }
  137 |             },
  138 |             {
  139 |               ""Effect"": ""Allow"",
  140 |               ""Action"": ""rds:CreateGlobalCluster"",
  141 |               ""Resource"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,207,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  197 |             ""PolicyDocument"": {
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
> 207 |                   ""Action"": ""iam:*"",
  208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,220,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
  219 |                   ""Effect"": ""Allow"",
> 220 |                   ""Action"": ""*"",
  221 |                   ""Resource"": ""s3:GetObject""
  222 |                 }
  223 |               ]
  224 |             }
  225 |           },
  226 |           {
  227 |             ""PolicyName"": ""root1"",
  228 |             ""PolicyDocument"": {
  229 |               ""Version"": ""2012-10-17"",
  230 |               ""Statement"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml,22,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml","
  12 |                 - ec2.amazonaws.com
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
> 22 |                 Action: iam:*
  23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml,29,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml","
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
  23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
> 29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json,31,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json","
  21 |         },
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
> 31 |                   ""Action"": ""iam:*"",
  32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json,44,250,skims,325. Excessive privileges - Wildcards,"IAM Role is miss configured: - Should not allow  action on its permissions policy
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json","
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
  43 |                   ""Effect"": ""Allow"",
> 44 |                   ""Action"": ""*"",
  45 |                   ""Resource"": ""s3:GetObject""
  46 |                 }
  47 |               ]
  48 |             }
  49 |           }
  50 |         ],
  51 |         ""ManagedPolicyArns"": [
  52 |           ""arn:aws:iam::aws:policy/AdministratorAccess"",
  53 |           ""arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess""
  54 |         ]
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_actions
F325,inputs,arn:aws:iam::123456789012:policy/myPolicy (namespace),"Policies have privileges over IAM
",250,skims,325. Excessive privileges - Wildcards,"Policies have privileges over IAM
","
  1 | {
  2 |     ""Document"": ""{'Statement':[{'Effect': 'Allow', 'Action': '*', 'Resource': '*'},{'Effect': 'Allow', 'Resource': '*',
    | 'Action': '*',},{'Effect': 'Allow', 'NotAction': ['w',], 'NotResource': ['w',]} ],}"",
  3 |     ""VersionId"": ""v1"",
  4 |     ""IsDefaultVersion"": true
  5 | }
    ^ Col 0
",aws.iam_has_privileges_over_iam
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml,47,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml,"
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
> 47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json,70,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json,"
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
  69 |                   ""Action"": ""iam:*"",
> 70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
     ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,77,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,"
   67 |             Action:
   68 |               - sts:AssumeRole
   69 |       Path: /
   70 |       Policies:
   71 |         - PolicyName: root
   72 |           PolicyDocument:
   73 |             Version: '2012-10-17'
   74 |             Statement:
   75 |               - Effect: Allow
   76 |                 Action: '*'
>  77 |                 Resource: '*'
   78 |         - PolicyName: root
   79 |           PolicyDocument:
   80 |             Version: '2012-10-17'
   81 |             Statement:
   82 |               - Effect: Deny
   83 |                 Action: '*'
   84 |                 Resource: '*'
   85 |         - PolicyName: root
   86 |           PolicyDocument:
   87 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,117,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,"
  107 |         ""Path"": ""/"",
  108 |         ""Policies"": [
  109 |           {
  110 |             ""PolicyName"": ""root"",
  111 |             ""PolicyDocument"": {
  112 |               ""Version"": ""2012-10-17"",
  113 |               ""Statement"": [
  114 |                 {
  115 |                   ""Effect"": ""Allow"",
  116 |                   ""Action"": ""*"",
> 117 |                   ""Resource"": ""*""
  118 |                 }
  119 |               ]
  120 |             }
  121 |           },
  122 |           {
  123 |             ""PolicyName"": ""root"",
  124 |             ""PolicyDocument"": {
  125 |               ""Version"": ""2012-10-17"",
  126 |               ""Statement"": [
  127 |                 {
      ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,134,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,"
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
> 134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,208,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,"
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
> 208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
      ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml,23,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml,"
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
> 23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json,32,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json,"
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
  31 |                   ""Action"": ""iam:*"",
> 32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
     ^ Col 0
",cloudformation.cfn_permissive_policy
F325,lines,namespace/skims/test/data/lib_path/f325/terraform.tf,53,250,skims,325. Excessive privileges - Wildcards,Should not allow  resource. in namespace/skims/test/data/lib_path/f325/terraform.tf,"
  43 |     effect = ""Allow""
  44 |     actions = [
  45 |       ""codecommit:Update*""
  46 |     ]
  47 |
  48 |     resources = [
  49 |       ""*""
  50 |     ]
  51 |   }
  52 |
> 53 |   statement {
  54 |     effect    = ""Allow""
  55 |     actions   = [""*""]
  56 |     resources = [""*""]
  57 |   }
  58 | }
  59 |
  60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
  61 |   name = ""vuln_role_policy_1""
  62 |   role = aws_iam_role.vuln_role_1
  63 |
     ^ Col 0
",terraform.terraform_permissive_policy
F325,lines,namespace/skims/test/data/lib_root/f325/json_principal_wildcard.json,8,250,skims,325. Excessive privileges - Wildcards,"The wildcard () is used to give access to any user, including anonymous users.
 in namespace/skims/test/data/lib_root/f325/json_principal_wildcard.json","
   1 | {
   2 |   ""Statement"": [
   3 |     {
   4 |       ""Action"": [
   5 |         ""s3:GetObject""
   6 |       ],
   7 |       ""Effect"": ""Allow"",
>  8 |       ""Principal"": ""*"",
   9 |       ""Resource"": [
  10 |         ""arn:aws:s3:::bgx-digital-onboarding-frontend/*""
  11 |       ],
  12 |       ""Sid"": ""AddPerm""
  13 |     }
  14 |   ],
  15 |   ""Version"": ""2012-10-17""
  16 | }
     ^ Col 0
",cloudformation.json_principal_wildcard
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml,47,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml","
  34 |             Principal:
  35 |               Service:
  36 |                 - ec2.amazonaws.com
  37 |             Action:
  38 |               - sts:AssumeRole
  39 |       Path: /
  40 |       Policies:
  41 |         - PolicyName: root
  42 |           PolicyDocument:
  43 |             Version: '2012-10-17'
  44 |             Statement:
  45 |               - Effect: Allow
  46 |                 Action: iam:*
> 47 |                 Resource: '*'
  48 |         - PolicyName: root
  49 |           PolicyDocument:
  50 |             Version: '2012-10-17'
  51 |             Statement:
  52 |               - Effect: Allow
  53 |                 Action: '*'
  54 |                 Resource: s3:GetObject
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json,70,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_privileges_over_iam.yaml.json","
  60 |         ""Path"": ""/"",
  61 |         ""Policies"": [
  62 |           {
  63 |             ""PolicyName"": ""root"",
  64 |             ""PolicyDocument"": {
  65 |               ""Version"": ""2012-10-17"",
  66 |               ""Statement"": [
  67 |                 {
  68 |                   ""Effect"": ""Allow"",
  69 |                   ""Action"": ""iam:*"",
> 70 |                   ""Resource"": ""*""
  71 |                 }
  72 |               ]
  73 |             }
  74 |           },
  75 |           {
  76 |             ""PolicyName"": ""root"",
  77 |             ""PolicyDocument"": {
  78 |               ""Version"": ""2012-10-17"",
  79 |               ""Statement"": [
  80 |                 {
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,22,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   12 |             Action: rds:CreateDBInstance
   13 |             Condition:
   14 |               StringEquals:
   15 |                 rds:DatabaseEngine: mysql
   16 |           - Effect: Allow
   17 |             Action: rds:CreateGlobalCluster
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
>  22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,33,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
>  33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
   40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,44,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
   40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
>  44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
   51 |             Resource: '*'
   52 |             Condition:
   53 |               StringEquals:
   54 |                 rds:DatabaseClass: db.t2.micro
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml,51,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml","
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
>  51 |             Resource: '*'
   52 |             Condition:
   53 |               StringEquals:
   54 |                 rds:DatabaseClass: db.t2.micro
   55 |       Groups:
   56 |         - TestDBGroup
   57 |   RootRole:
   58 |     Type: AWS::IAM::Role
   59 |     Properties:
   60 |       AssumeRolePolicyDocument:
   61 |         Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,27,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
   17 |                 }
   18 |               }
   19 |             },
   20 |             {
   21 |               ""Effect"": ""Allow"",
   22 |               ""Action"": ""rds:CreateGlobalCluster"",
   23 |               ""Resource"": [
   24 |                 """",
   25 |                 ""ec2:StartInstances"",
   26 |                 ""s3:GetObject"",
>  27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,44,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
>  44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,61,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
   55 |                 ""rds:ModifyDBCluster*""
   56 |               ],
   57 |               ""Resource"": [
   58 |                 """",
   59 |                 ""ec2:StartInstances"",
   60 |                 ""s3:GetObject"",
>  61 |                 ""*""
   62 |               ],
   63 |               ""Condition"": {
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json,74,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_has_wildcard_resource_on_write_action.yaml.json","
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
   72 |                 ""rds:CreateDBSnapshot""
   73 |               ],
>  74 |               ""Resource"": ""*"",
   75 |               ""Condition"": {
   76 |                 ""StringEquals"": {
   77 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   78 |                 }
   79 |               }
   80 |             }
   81 |           ]
   82 |         },
   83 |         ""Groups"": [
   84 |           ""TestDBGroup""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,22,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   12 |             Action: rds:CreateDBInstance
   13 |             Condition:
   14 |               StringEquals:
   15 |                 rds:DatabaseEngine: mysql
   16 |           - Effect: Allow
   17 |             Action: rds:CreateGlobalCluster
   18 |             Resource:
   19 |               - ''
   20 |               - ec2:StartInstances
   21 |               - s3:GetObject
>  22 |               - '*'
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,33,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   23 |             Condition:
   24 |               StringEquals:
   25 |                 rds:DatabaseClass: db.t2.micro
   26 |           - Effect: Allow
   27 |             Action:
   28 |               - rds:*
   29 |             Resource:
   30 |               - ''
   31 |               - ec2:StartInstances
   32 |               - s3:GetObject
>  33 |               - '*'
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
   40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,44,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   34 |             Condition:
   35 |               StringEquals:
   36 |                 rds:DatabaseClass: db.t2.micro
   37 |           - Effect: Allow
   38 |             Action:
   39 |               - rds:ModifyDBCluster*
   40 |             Resource:
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
>  44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
   51 |             Resource: '*'
   52 |             NotResource:
   53 |               - arn:aws:s3:::HRBucket/Payroll
   54 |               - arn:aws:s3:::HRBucket/Payroll/*
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,51,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   41 |               - ''
   42 |               - ec2:StartInstances
   43 |               - s3:GetObject
   44 |               - '*'
   45 |             Condition:
   46 |               StringEquals:
   47 |                 rds:DatabaseClass: db.t2.micro
   48 |           - Effect: Allow
   49 |             Action:
   50 |               - rds:CreateDBSnapshot
>  51 |             Resource: '*'
   52 |             NotResource:
   53 |               - arn:aws:s3:::HRBucket/Payroll
   54 |               - arn:aws:s3:::HRBucket/Payroll/*
   55 |             Condition:
   56 |               StringEquals:
   57 |                 rds:DatabaseClass: db.t2.micro
   58 |       Users:
   59 |         - user1
   60 |       Groups:
   61 |         - TestDBGroup
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,105,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
   95 |               - ec2:StartInstances
   96 |               - s3:GetObject
   97 |           - Effect: Allow
   98 |             Action: ecs:DescribeServices
   99 |             Resource: '*'
  100 |             Condition:
  101 |               StringEquals:
  102 |                 rds:DatabaseClass: db.t2.micro
  103 |           - Effect: Allow
  104 |             Action: ecs:CreateService
> 105 |             Resource: '*'
  106 |             Condition:
  107 |               StringEquals:
  108 |                 rds:DatabaseClass: db.t2.micro
  109 |       Groups:
  110 |         - TestDBGroup
  111 |   RootRole:
  112 |     Type: AWS::IAM::Role
  113 |     Properties:
  114 |       AssumeRolePolicyDocument:
  115 |         Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,131,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
  121 |             NotAction:
  122 |               - sts:AssumeRole
  123 |       Path: /
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
> 131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
  134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml,134,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml","
  124 |       Policies:
  125 |         - PolicyName: root
  126 |           PolicyDocument:
  127 |             Version: '2012-10-17'
  128 |             Statement:
  129 |               - Effect: Allow
  130 |                 Action: ecs:CreateService
  131 |                 Resource: '*'
  132 |               - Effect: Allow
  133 |                 Action: iam:*
> 134 |                 Resource: '*'
  135 |         - PolicyName: root
  136 |           PolicyDocument:
  137 |             Version: '2012-10-17'
  138 |             Statement:
  139 |               - Effect: Allow
  140 |                 Action: '*'
  141 |                 Resource: s3:GetObject
  142 |         - PolicyName: root1
  143 |           PolicyDocument:
  144 |             Version: '2012-10-17'
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,27,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
   17 |                 }
   18 |               }
   19 |             },
   20 |             {
   21 |               ""Effect"": ""Allow"",
   22 |               ""Action"": ""rds:CreateGlobalCluster"",
   23 |               ""Resource"": [
   24 |                 """",
   25 |                 ""ec2:StartInstances"",
   26 |                 ""s3:GetObject"",
>  27 |                 ""*""
   28 |               ],
   29 |               ""Condition"": {
   30 |                 ""StringEquals"": {
   31 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   32 |                 }
   33 |               }
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,44,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
   34 |             },
   35 |             {
   36 |               ""Effect"": ""Allow"",
   37 |               ""Action"": [
   38 |                 ""rds:*""
   39 |               ],
   40 |               ""Resource"": [
   41 |                 """",
   42 |                 ""ec2:StartInstances"",
   43 |                 ""s3:GetObject"",
>  44 |                 ""*""
   45 |               ],
   46 |               ""Condition"": {
   47 |                 ""StringEquals"": {
   48 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   49 |                 }
   50 |               }
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,61,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
   51 |             },
   52 |             {
   53 |               ""Effect"": ""Allow"",
   54 |               ""Action"": [
   55 |                 ""rds:ModifyDBCluster*""
   56 |               ],
   57 |               ""Resource"": [
   58 |                 """",
   59 |                 ""ec2:StartInstances"",
   60 |                 ""s3:GetObject"",
>  61 |                 ""*""
   62 |               ],
   63 |               ""Condition"": {
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,74,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
   64 |                 ""StringEquals"": {
   65 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   66 |                 }
   67 |               }
   68 |             },
   69 |             {
   70 |               ""Effect"": ""Allow"",
   71 |               ""Action"": [
   72 |                 ""rds:CreateDBSnapshot""
   73 |               ],
>  74 |               ""Resource"": ""*"",
   75 |               ""NotResource"": [
   76 |                 ""arn:aws:s3:::HRBucket/Payroll"",
   77 |                 ""arn:aws:s3:::HRBucket/Payroll/*""
   78 |               ],
   79 |               ""Condition"": {
   80 |                 ""StringEquals"": {
   81 |                   ""rds:DatabaseClass"": ""db.t2.micro""
   82 |                 }
   83 |               }
   84 |             }
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,160,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  150 |               ""Resource"": ""*"",
  151 |               ""Condition"": {
  152 |                 ""StringEquals"": {
  153 |                   ""rds:DatabaseClass"": ""db.t2.micro""
  154 |                 }
  155 |               }
  156 |             },
  157 |             {
  158 |               ""Effect"": ""Allow"",
  159 |               ""Action"": ""ecs:CreateService"",
> 160 |               ""Resource"": ""*"",
  161 |               ""Condition"": {
  162 |                 ""StringEquals"": {
  163 |                   ""rds:DatabaseClass"": ""db.t2.micro""
  164 |                 }
  165 |               }
  166 |             }
  167 |           ]
  168 |         },
  169 |         ""Groups"": [
  170 |           ""TestDBGroup""
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,203,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  193 |         ""Path"": ""/"",
  194 |         ""Policies"": [
  195 |           {
  196 |             ""PolicyName"": ""root"",
  197 |             ""PolicyDocument"": {
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
> 203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
  208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json,208,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_policy_miss_configured.yaml.json","
  198 |               ""Version"": ""2012-10-17"",
  199 |               ""Statement"": [
  200 |                 {
  201 |                   ""Effect"": ""Allow"",
  202 |                   ""Action"": ""ecs:CreateService"",
  203 |                   ""Resource"": ""*""
  204 |                 },
  205 |                 {
  206 |                   ""Effect"": ""Allow"",
  207 |                   ""Action"": ""iam:*"",
> 208 |                   ""Resource"": ""*""
  209 |                 }
  210 |               ]
  211 |             }
  212 |           },
  213 |           {
  214 |             ""PolicyName"": ""root"",
  215 |             ""PolicyDocument"": {
  216 |               ""Version"": ""2012-10-17"",
  217 |               ""Statement"": [
  218 |                 {
      ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml,23,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml","
  13 |             Action:
  14 |               - sts:AssumeRole
  15 |       Path: /
  16 |       Policies:
  17 |         - PolicyName: root
  18 |           PolicyDocument:
  19 |             Version: '2012-10-17'
  20 |             Statement:
  21 |               - Effect: Allow
  22 |                 Action: iam:*
> 23 |                 Resource: '*'
  24 |         - PolicyName: root
  25 |           PolicyDocument:
  26 |             Version: '2012-10-17'
  27 |             Statement:
  28 |               - Effect: Allow
  29 |                 Action: '*'
  30 |                 Resource: s3:GetObject
  31 |       ManagedPolicyArns:
  32 |         - arn:aws:iam::aws:policy/AdministratorAccess
  33 |         - arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json,32,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/cfn_iam_is_role_over_privileged.yaml.json","
  22 |         ""Path"": ""/"",
  23 |         ""Policies"": [
  24 |           {
  25 |             ""PolicyName"": ""root"",
  26 |             ""PolicyDocument"": {
  27 |               ""Version"": ""2012-10-17"",
  28 |               ""Statement"": [
  29 |                 {
  30 |                   ""Effect"": ""Allow"",
  31 |                   ""Action"": ""iam:*"",
> 32 |                   ""Resource"": ""*""
  33 |                 }
  34 |               ]
  35 |             }
  36 |           },
  37 |           {
  38 |             ""PolicyName"": ""root"",
  39 |             ""PolicyDocument"": {
  40 |               ""Version"": ""2012-10-17"",
  41 |               ""Statement"": [
  42 |                 {
     ^ Col 0
",cloudformation.cfn_iam_permissions_policy_wildcard_resources
F325,lines,namespace/skims/test/data/lib_path/f325/terraform.tf,30,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/terraform.tf","
  20 |     ]
  21 |
  22 |     resources = [
  23 |       ""arn:aws:codebuild::111111111111:project/test"",
  24 |       ""arn:aws:codecommit::111111111111:test""
  25 |     ]
  26 |   }
  27 | }
  28 |
  29 | data ""aws_iam_policy_document"" ""vuln_policy_1"" {
> 30 |   statement {
  31 |     effect = ""Allow""
  32 |     actions = [
  33 |       ""a4b:ApproveSkill"",
  34 |       ""codecommit:CreateBranch""
  35 |     ]
  36 |
  37 |     resources = [
  38 |       ""*""
  39 |     ]
  40 |   }
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
F325,lines,namespace/skims/test/data/lib_path/f325/terraform.tf,42,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/terraform.tf","
  32 |     actions = [
  33 |       ""a4b:ApproveSkill"",
  34 |       ""codecommit:CreateBranch""
  35 |     ]
  36 |
  37 |     resources = [
  38 |       ""*""
  39 |     ]
  40 |   }
  41 |
> 42 |   statement {
  43 |     effect = ""Allow""
  44 |     actions = [
  45 |       ""codecommit:Update*""
  46 |     ]
  47 |
  48 |     resources = [
  49 |       ""*""
  50 |     ]
  51 |   }
  52 |
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
F325,lines,namespace/skims/test/data/lib_path/f325/terraform.tf,53,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/terraform.tf","
  43 |     effect = ""Allow""
  44 |     actions = [
  45 |       ""codecommit:Update*""
  46 |     ]
  47 |
  48 |     resources = [
  49 |       ""*""
  50 |     ]
  51 |   }
  52 |
> 53 |   statement {
  54 |     effect    = ""Allow""
  55 |     actions   = [""*""]
  56 |     resources = [""*""]
  57 |   }
  58 | }
  59 |
  60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
  61 |   name = ""vuln_role_policy_1""
  62 |   role = aws_iam_role.vuln_role_1
  63 |
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
F325,lines,namespace/skims/test/data/lib_path/f325/terraform.tf,64,250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
 in namespace/skims/test/data/lib_path/f325/terraform.tf","
  54 |     effect    = ""Allow""
  55 |     actions   = [""*""]
  56 |     resources = [""*""]
  57 |   }
  58 | }
  59 |
  60 | resource ""aws_iam_role_policy"" ""vuln_role_policy_1"" {
  61 |   name = ""vuln_role_policy_1""
  62 |   role = aws_iam_role.vuln_role_1
  63 |
> 64 |   policy = <<-EOF
  65 |   {
  66 |     ""Version"": ""2012-10-17"",
  67 |     ""Statement"": [
  68 |       {
  69 |         ""Effect"": ""Allow"",
  70 |         ""Action"": [
  71 |           ""codecommit:CreateBranch""
  72 |         ],
  73 |         ""Resource"": ""*""
  74 |       }
     ^ Col 0
",terraform.tfm_iam_has_wildcard_resource_on_write_action
F325,inputs,arn:aws:iam::123456789012:policy/myPolicy (namespace),"Write actions are allowed on all resources
",250,skims,325. Excessive privileges - Wildcards,"Write actions are allowed on all resources
","
   1 | [
   2 |     {
   3 |         ""Effect"": ""Allow"",
   4 |         ""Action"": ""*"",
   5 |         ""Resource"": ""*""
   6 |     },
   7 |     {
   8 |         ""Effect"": ""Allow"",
   9 |         ""Resource"": ""*"",
  10 |         ""Action"": ""*""
  11 |     },
  12 |     {
  13 |         ""Effect"": ""Allow"",
  14 |         ""NotAction"": [
  15 |             ""w""
  16 |         ],
  17 |         ""NotResource"": [
  18 |             ""w""
  19 |         ]
  20 |     }
  21 | ]
     ^ Col 0
",aws.iam_has_wildcard_resource_on_write_action
