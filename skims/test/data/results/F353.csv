finding,kind,what,where,cwe,stream,title,description,snippet,method
F353,lines,namespace/skims/test/data/lib_root/f353/js_decode_insecure_jwt_token.js,6,287,skims,353. Lack of data validation - Token,Token JWT is not verified before decoding. in namespace/skims/test/data/lib_root/f353/js_decode_insecure_jwt_token.js,"
   1 | const jwt = require('jsonwebtoken');
   2 |
   3 | function unsafeVerifyJwt() {
   4 |     // The signature is not verified before decoding
   5 |     let allowed_algos = ['PS384'];
>  6 |     jwt.decode(token, key, allowed_algos);
   7 | }
   8 |
   9 | function safeVerifyJwt() {
  10 |     // The jwt is verified before being decoded
  11 |     let allowed_algos = ['PS384'];
  12 |     const verify_config = { expiresIn: 10000, algorithms:  allowed_algos};
  13 |     jwt.verify(token_secure, key, verify_config);
  14 |     jwt.decode(token_secure, key, allowed_algos);
  15 | }
     ^ Col 0
",javascript.js_decode_insecure_jwt_token
F353,lines,namespace/skims/test/data/lib_root/f353/ts_decode_insecure_jwt_token.ts,6,287,skims,353. Lack of data validation - Token,Token JWT is not verified before decoding. in namespace/skims/test/data/lib_root/f353/ts_decode_insecure_jwt_token.ts,"
   1 |
   2 | import jwt from 'jsonwebtoken';
   3 |
   4 | export function unsafeJwt<T extends Object> (payload: T, privateKey: string): string {
   5 |     const options: jwt.SignOptions = { expiresIn: 10000, algorithms:  ['PS384']};
>  6 |     return jwt.decode(payload, privateKey, options)
   7 | }
   8 |
   9 | export function safeJwt<T extends Object> (payload: T, privateKey: string): string {
  10 |   const options: jwt.SignOptions = { expiresIn: 10000, algorithms:  ['PS384']};
  11 |   try {
  12 |     jwt.verify(payload, privateKey, options);
  13 |   } catch (e) {
  14 |     throw new Error(e.message);
  15 |   }
  16 |   return jwt.decode(payload, privateKey, options)
  17 | }
     ^ Col 0
",javascript.js_decode_insecure_jwt_token
