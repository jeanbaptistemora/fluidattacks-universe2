finding,kind,what,where,cwe,stream,title,description,snippet
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test019.js,9,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test019.js,"
   1 | import { Router } from 'express';
   2 | var router = Router();
   3 | import { readFile } from 'fs';
   4 |
   5 | router.get('/test019/:user/:fileName', function (req, res) {
   6 |   var user = req.params['user'];
   7 |   var fileName = req.params['fileName'];
   8 |   var filePath = ""target/user_files/"" + user + ""/"" + fileName;
>  9 |   readFile(filePath, 'utf-8', (err, data) => {
  10 |     if (err) {
  11 |       res.status('404').json({
  12 |         'error': 'file does not exists '
  13 |       })
  14 |     }
  15 |     res.send(
  16 |       data
  17 |     )
  18 |   })
  19 | });
  20 |
  21 | export default router;
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test020.js,9,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test020.js,"
   1 | var express = require('express');
   2 | var router = express.Router();
   3 | const fs = require('fs');
   4 |
   5 | router.get('/test020/:user/:fileName', function (req, res) {
   6 |   var user = req.params['user'];
   7 |   var fileName = req.params['fileName'];
   8 |   var filePath = `target/user_files/${user}/${fileName}`;
>  9 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  10 |     if (err) {
  11 |       res.status('404').json({
  12 |         'error': 'file does not exists '
  13 |       })
  14 |     }
  15 |     res.send(
  16 |       data
  17 |     )
  18 |   })
  19 | });
  20 |
  21 | module.exports = router;
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test021.js,9,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test021.js,"
   1 | var express = require('express');
   2 | var router = express.Router();
   3 | const fs = require('fs');
   4 |
   5 | router.get('/test021/', function (req, res) {
   6 |   var user = req.query['user'];
   7 |   var fileName = req.query['fileName'];
   8 |   var filePath = `target/user_files/${user}/${fileName}`;
>  9 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  10 |     if (err) {
  11 |       res.status('404').json({
  12 |         'error': 'file does not exists '
  13 |       })
  14 |     }
  15 |     res.send(
  16 |       data
  17 |     )
  18 |   })
  19 | });
  20 |
  21 | module.exports = router;
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test022.js,9,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test022.js,"
   1 | var express = require('express');
   2 | var router = express.Router();
   3 | const fs = require('fs');
   4 |
   5 | router.get('/test022/', function (req, res) {
   6 |   var user = req.query['user'];
   7 |   var fileName = req.query['fileName'];
   8 |   var filePath = `target/user_files/${user}/${fileName}.yaml`;
>  9 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  10 |     if (err) {
  11 |       res.status('404').json({
  12 |         'error': 'file does not exists '
  13 |       })
  14 |     }
  15 |     res.send(
  16 |       data
  17 |     )
  18 |   })
  19 | });
  20 |
  21 | module.exports = router;
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test023.js,9,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test023.js,"
   1 | var express = require('express');
   2 | var router = express.Router();
   3 | const fs = require('fs');
   4 |
   5 | router.get('/test023/', function (req, res) {
   6 |   var user = req.query['user'];
   7 |   var fileName = req.query['fileName'];
   8 |   var filePath = ""target/user_files/"" + user + ""/"" + fileName + "".yaml"";
>  9 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  10 |     if (err) {
  11 |       res.status('404').json({
  12 |         'error': 'file does not exists '
  13 |       })
  14 |     }
  15 |     res.send(
  16 |       data
  17 |     )
  18 |   })
  19 | });
  20 |
  21 | module.exports = router;
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test024.js,14,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test024.js,"
   4 |
   5 | router.get('/test024/', function (req, res) {
   6 |   var user = req.query['user'];
   7 |   var fileName = req.query['fileName'];
   8 |   if (fileName.includes('..')) {
   9 |     res.status(403).json({
  10 |       ""error"": ""unauthorized user""
  11 |     });
  12 |   }
  13 |   var filePath = ""target/user_files/"" + user + ""/"" + fileName + "".yaml"";
> 14 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  15 |     if (err) {
  16 |       res.status('404').json({
  17 |         'error': 'file does not exists '
  18 |       });
  19 |     }
  20 |     res.send(
  21 |       data
  22 |     );
  23 |   })
  24 | });
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test025.js,10,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test025.js,"
   1 | import { Router } from 'express';
   2 | var router = Router();
   3 | import { readFile } from 'fs';
   4 | import { join } from 'path';
   5 |
   6 | router.get('/test025/:user/:fileName', function (req, res) {
   7 |   var user = req.params['user'];
   8 |   var fileName = req.params['fileName'];
   9 |   var filePath = join(""target"", ""user_files"", user, fileName);
> 10 |   readFile(filePath, 'utf-8', (err, data) => {
  11 |     if (err) {
  12 |       res.status('404').json({
  13 |         'error': 'file does not exists '
  14 |       })
  15 |     }
  16 |     res.send(
  17 |       data
  18 |     )
  19 |   })
  20 | });
  21 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test026.js,10,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test026.js,"
   1 | var express = require('express');
   2 | var router = express.Router();
   3 | const fs = require('fs');
   4 | const path = require('path');
   5 |
   6 | router.get('/test026/:user/:fileName', function (req, res) {
   7 |   var user = req.params['user'];
   8 |   var fileName = req.params['fileName'];
   9 |   var filePath = path.join(""target/user_files"", user, fileName);
> 10 |   fs.readFile(filePath, 'utf-8', (err, data) => {
  11 |     if (err) {
  12 |       res.status('404').json({
  13 |         'error': 'file does not exists '
  14 |       })
  15 |     }
  16 |     res.send(
  17 |       data
  18 |     )
  19 |   })
  20 | });
  21 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test027.js,10,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test027.js,"
   1 | import { Router } from 'express';
   2 | var router = Router();
   3 | import { readFile } from 'fs';
   4 | import { join } from 'path';
   5 |
   6 | router.get('/test027/:user/:fileName', function (req, res) {
   7 |   var user = req.params['user'];
   8 |   var fileName = req.params['fileName'];
   9 |   var filePath = join(""target/user_files"", user, `${fileName}.yaml`);
> 10 |   readFile(filePath, 'utf-8', (err, data) => {
  11 |     if (err) {
  12 |       res.status('404').json({
  13 |         'error': 'file does not exists '
  14 |       })
  15 |     }
  16 |     res.send(
  17 |       data
  18 |     )
  19 |   })
  20 | });
  21 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test029.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test029.js,"
   7 |
   8 | router.delete('/test029/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = path.join(""target/user_files"", user, `${fileName}.yaml`);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.send(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test030.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test030.js,"
   7 |
   8 | router.delete('/test030/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = pathh.join(""target/user_files"", user, `${fileName}.yaml`);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.json(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test031.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test031.js,"
   7 |
   8 | router.delete('/test031/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = join(""target/user_files"", user, fileName + "".yaml"");
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.send(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test032.js,18,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test032.js,"
   8 | router.delete('/test032/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = pathh.join(""target/user_files"", user, `${fileName}.yaml`);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
  17 |     if (2 > -4){
> 18 |       fs.unlinkSync(filePath);
  19 |     }
  20 |     result.ok = true;
  21 |   } catch (error) {
  22 |     result[""ok""] = false;
  23 |     result[""errors""] = [{
  24 |       ""message"": error
  25 |     }];
  26 |   }
  27 |   res.json(result);
  28 | });
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test033.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test033.js,"
   7 |
   8 | router.delete('/test033/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = path.join(""target/user_files"", user, `${fileName}`);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.send(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test034.js,21,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test034.js,"
  11 |
  12 | router.delete('/test034/:user/:fileName', function (req, res) {
  13 |   var user = req.params['user'];
  14 |   var fileName = req.params['fileName'];
  15 |   var filePath = join(""target/user_files"", user, fileName);
  16 |
  17 |   let result = {
  18 |     ""ok"": false,
  19 |   }
  20 |   try {
> 21 |     unlinkSync(filePath);
  22 |     result.ok = true;
  23 |   } catch (error) {
  24 |     result[""ok""] = false;
  25 |     result[""errors""] = [{
  26 |       ""message"": error
  27 |     }];
  28 |   }
  29 |   res.send(result);
  30 | });
  31 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test035.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test035.js,"
   7 |
   8 | router.delete('/test035/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = pathh.join(""target/user_files"", user, fileName);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.json(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test036.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test036.js,"
   7 |
   8 | router.delete('/test036/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = join(""target/user_files"", user, fileName);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.send(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test037.js,18,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test037.js,"
   8 | router.delete('/test032/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = pathh.join(""target/user_files"", user, `${fileName}.yaml`);
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
  17 |     if (2 > -4){
> 18 |       fs.unlinkSync(filePath);
  19 |     }
  20 |     result.ok = true;
  21 |   } catch (error) {
  22 |     result[""ok""] = false;
  23 |     result[""errors""] = [{
  24 |       ""message"": error
  25 |     }];
  26 |   }
  27 |   res.json(result);
  28 | });
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test038.js,22,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test038.js,"
  12 | router.get('/test038', function (req, res) {
  13 |   let body = req.body;
  14 |   var user = body['user'];
  15 |   var fileName = body['fileName'];
  16 |   var filePath = join(""target/user_files"", user, fileName);
  17 |
  18 |   let result = {
  19 |     ""ok"": false,
  20 |   }
  21 |   try {
> 22 |     unlinkSync(filePath);
  23 |     result.ok = true;
  24 |   } catch (error) {
  25 |     result[""ok""] = false;
  26 |     result[""errors""] = [{
  27 |       ""message"": error
  28 |     }];
  29 |   }
  30 |   res.send(result);
  31 | });
  32 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test039.js,16,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test039.js,"
   6 |
   7 | router.delete('/test039/:user/:fileName', function (req, res) {
   8 |   var user = req.params['user'];
   9 |   var fileName = req.params['fileName'];
  10 |   var filePath = ""target/user_files/"" + user +`/${fileName}.yaml`;
  11 |
  12 |   let result = {
  13 |     ""ok"": false,
  14 |   }
  15 |   try {
> 16 |     fs.unlinkSync(filePath);
  17 |     result.ok = true;
  18 |   } catch (error) {
  19 |     result[""ok""] = false;
  20 |     result[""errors""] = [{
  21 |       ""message"": error
  22 |     }];
  23 |   }
  24 |   res.send(result);
  25 | });
  26 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test040.js,15,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test040.js,"
   5 | const fs = require('fs');
   6 |
   7 | router.delete('/test040/:user/:fileName', function (req, res) {
   8 |   var user = req.params['user'];
   9 |   var fileName = req.params['fileName'];
  10 |
  11 |   let result = {
  12 |     ""ok"": false,
  13 |   }
  14 |   try {
> 15 |     fs.unlinkSync(""target/user_files/"" + user + `/${fileName}.yaml`);
  16 |     result.ok = true;
  17 |   } catch (error) {
  18 |     result[""ok""] = false;
  19 |     result[""errors""] = [{
  20 |       ""message"": error
  21 |     }];
  22 |   }
  23 |   res.json(result);
  24 | });
  25 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test041.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test041.js,"
   7 |
   8 | router.delete('/test041/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |   var filePath = ""target/user_files/""+ user + ""/"" + fileName + "".yaml"";
  12 |
  13 |   let result = {
  14 |     ""ok"": false,
  15 |   }
  16 |   try {
> 17 |     fs.unlinkSync(filePath);
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.send(result);
  26 | });
  27 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test042.js,16,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test042.js,"
   6 |
   7 | router.delete('/test042/:user/:fileName', function (req, res) {
   8 |   var user = req.params['user'];
   9 |   var fileName = req.params['fileName'];
  10 |
  11 |   let result = {
  12 |     ""ok"": false,
  13 |   }
  14 |   try {
  15 |     if (2 > -4) {
> 16 |       fs.unlinkSync(""target/user_files/"" + user + `/${fileName}.yaml`);
  17 |     }
  18 |     result.ok = true;
  19 |   } catch (error) {
  20 |     result[""ok""] = false;
  21 |     result[""errors""] = [{
  22 |       ""message"": error
  23 |     }];
  24 |   }
  25 |   res.json(result);
  26 | });
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test043.js,16,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test043.js,"
   6 | const path = require(""path"");
   7 |
   8 | router.delete('/test043/:user/:fileName', function (req, res) {
   9 |   var user = req.params['user'];
  10 |   var fileName = req.params['fileName'];
  11 |
  12 |   let result = {
  13 |     ""ok"": false,
  14 |   }
  15 |   try {
> 16 |     fs.unlinkSync(""target/user_files/""+ user + `/${fileName}`);
  17 |     result.ok = true;
  18 |   } catch (error) {
  19 |     result[""ok""] = false;
  20 |     result[""errors""] = [{
  21 |       ""message"": error
  22 |     }];
  23 |   }
  24 |   res.send(result);
  25 | });
  26 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test044.js,15,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test044.js,"
   5 |
   6 | router.delete(""/test044/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = pathh.join(""target/user_files"", user, `${fileName}.yaml`);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
  14 |   if (2 > -4) {
> 15 |     fs.unlink(filePath, (err) => {
  16 |       result.ok = true;
  17 |       if (err) {
  18 |         result[""ok""] = false;
  19 |         result[""errors""] = [
  20 |           {
  21 |             message: err,
  22 |           },
  23 |         ];
  24 |       }
  25 |       res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test045.js,14,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test045.js,"
   4 | const path = require(""path"");
   5 |
   6 | router.delete(""/test045/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = path.join(""target/user_files"", user, `${fileName}`);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
> 14 |   fs.unlink(filePath, (error) => {
  15 |     result.ok = true;
  16 |     if (error) {
  17 |       result[""ok""] = false;
  18 |       result[""errors""] = [
  19 |         {
  20 |           message: error,
  21 |         },
  22 |       ];
  23 |     }
  24 |     res.send(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test046.js,14,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test046.js,"
   4 | var router = Router();
   5 |
   6 | router.delete(""/test046/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = join(""target/user_files"", user, fileName);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
> 14 |   unlink(filePath, (error) => {
  15 |     result.ok = true;
  16 |     if (error) {
  17 |       result[""ok""] = false;
  18 |       result[""errors""] = [
  19 |         {
  20 |           message: error,
  21 |         },
  22 |       ];
  23 |     }
  24 |     res.send(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test047.js,14,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test047.js,"
   4 | var router = Router();
   5 |
   6 | router.delete(""/test047/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = pathh.join(""target/user_files"", user, fileName);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
> 14 |   unlink(filePath, (error) => {
  15 |     result.ok = true;
  16 |     if (error) {
  17 |       result[""ok""] = false;
  18 |       result[""errors""] = [
  19 |         {
  20 |           message: error,
  21 |         },
  22 |       ];
  23 |     }
  24 |     res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test048.js,14,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test048.js,"
   4 | var router = Router();
   5 |
   6 | router.delete(""/test048/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = join(""target/user_files"", user, fileName);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
> 14 |   fs.unlink(filePath, (error) => {
  15 |     result.ok = true;
  16 |     if (error) {
  17 |       result[""ok""] = false;
  18 |       result[""errors""] = [
  19 |         {
  20 |           message: error,
  21 |         },
  22 |       ];
  23 |     }
  24 |     res.send(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test049.js,15,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test049.js,"
   5 |
   6 | router.delete(""/test049/:user/:fileName"", function (req, res) {
   7 |   var user = req.params[""user""];
   8 |   var fileName = req.params[""fileName""];
   9 |   var filePath = pathh.join(""target/user_files"", user, `${fileName}.yaml`);
  10 |
  11 |   let result = {
  12 |     ok: false,
  13 |   };
  14 |   if (2 > -4) {
> 15 |     fs.unlink(filePath, (error) => {
  16 |       result.ok = true;
  17 |       if (error) {
  18 |         result[""ok""] = false;
  19 |         result[""errors""] = [
  20 |           {
  21 |             message: error,
  22 |           },
  23 |         ];
  24 |       }
  25 |       res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test050.js,18,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test050.js,"
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |   var filePath = join(""target/user_files"", user, file);
  13 |
  14 |   let result = {
  15 |     ok: false,
  16 |   };
  17 |   try {
> 18 |     writeFileSync(filePath, payload, ""utf8"");
  19 |     result.ok = true;
  20 |   } catch (error) {
  21 |     result.ok = false;
  22 |     result[""errors""] = [
  23 |       {
  24 |         message: error,
  25 |       },
  26 |     ];
  27 |   }
  28 |   res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test051.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test051.js,"
   7 |   let body = req.body;
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   try {
> 17 |     fileSystem.writeFileSync(
  18 |       `target/user_files/${user}/${file}`,
  19 |       payload,
  20 |       ""utf8""
  21 |     );
  22 |     result.ok = true;
  23 |   } catch (error) {
  24 |     result.ok = false;
  25 |     result[""errors""] = [
  26 |       {
  27 |         message: error,
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test053.js,19,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test053.js,"
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, `${file}` + "".yaml"");
  17 |   if (53 > 43) {
  18 |     try {
> 19 |       fileSystem.writeFileSync(filePath, payload, ""utf8"");
  20 |       result.ok = true;
  21 |     } catch (error) {
  22 |       result.ok = false;
  23 |       result[""errors""] = [
  24 |         {
  25 |           message: error,
  26 |         },
  27 |       ];
  28 |     }
  29 |   }
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test054.js,19,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test054.js,"
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
  17 |   console.log(filePath);
  18 |   try {
> 19 |     fileSystem.writeFileSync(filePath, payload, ""utf8"");
  20 |     result.ok = true;
  21 |   } catch (error) {
  22 |     result.ok = false;
  23 |     result[""errors""] = [
  24 |       {
  25 |         message: error,
  26 |       },
  27 |     ];
  28 |   }
  29 |   res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test055.js,18,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test055.js,"
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
  17 |   try {
> 18 |     fileSystem.writeFileSync(filePath, payload, ""utf8"");
  19 |     result.ok = true;
  20 |   } catch (error) {
  21 |     result.ok = false;
  22 |     result[""errors""] = [
  23 |       {
  24 |         message: error,
  25 |       },
  26 |     ];
  27 |   }
  28 |   res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test056.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test056.js,"
   7 |   let body = req.body;
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |   var filePath = join(""target/user_files"", user, file);
  13 |
  14 |   let result = {
  15 |     ok: false,
  16 |   };
> 17 |   writeFile(filePath, payload, ""utf8"", (error) => {
  18 |     result.ok = true;
  19 |     if (error) {
  20 |       result.ok = false;
  21 |       result[""errors""] = [
  22 |         {
  23 |           message: error,
  24 |         },
  25 |       ];
  26 |     }
  27 |     res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test057.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test057.js,"
   7 |   let body = req.body;
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |
> 17 |   fileSystem.writeFile(
  18 |     `target/user_files/${user}/${file}`,
  19 |     payload,
  20 |     ""utf8"",
  21 |     (error) => {
  22 |       result.ok = true;
  23 |       if (error) {
  24 |         result.ok = false;
  25 |         result[""errors""] = [
  26 |           {
  27 |             message: error,
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test059.js,18,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test059.js,"
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, `${file}` + "".yaml"");
  17 |   if (53 > 43) {
> 18 |     fileSystem.writeFile(filePath, payload, ""utf8"", function (error) {
  19 |       result.ok = true;
  20 |       if (error) {
  21 |         result.ok = false;
  22 |         result[""errors""] = [
  23 |           {
  24 |             message: error,
  25 |           },
  26 |         ];
  27 |       }
  28 |       res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test060.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test060.js,"
   7 |   let body = req.body;
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
> 17 |   fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  18 |     result.ok = true;
  19 |     if (errors) {
  20 |       result.ok = false;
  21 |       result[""errors""] = [
  22 |         {
  23 |           message: error,
  24 |         },
  25 |       ];
  26 |     }
  27 |     res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test061.js,17,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test061.js,"
   7 |   let body = req.body;
   8 |
   9 |   let user = body.user;
  10 |   let file = body.fileName;
  11 |   let payload = body.payload;
  12 |
  13 |   let result = {
  14 |     ok: false,
  15 |   };
  16 |   let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
> 17 |   fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  18 |     result.ok = true;
  19 |     if (error) {
  20 |       result.ok = false;
  21 |       result[""errors""] = [
  22 |         {
  23 |           message: error,
  24 |         },
  25 |       ];
  26 |     }
  27 |     res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test062.js,21,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test062.js,"
  11 |
  12 |   let userFiles = ""./target/user_files/"";
  13 |   const testFolder = ""./target/user_files/"";
  14 |
  15 |   let result = {
  16 |     ok: false,
  17 |   };
  18 |   let users = Array.from(fileSystem.readdirSync(userFiles).values());
  19 |   if (users.includes(user)) {
  20 |     let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
> 21 |     fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  22 |       result.ok = true;
  23 |       if (error) {
  24 |         result.ok = false;
  25 |         result[""errors""] = [
  26 |           {
  27 |             message: error,
  28 |           },
  29 |         ];
  30 |       }
  31 |       res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test063.js,20,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test063.js,"
  10 |   let payload = body.payload;
  11 |
  12 |   let usersFiles = ""./target/user_files"";
  13 |
  14 |   let result = {
  15 |     ok: false,
  16 |   };
  17 |   let users = Array.from(fileSystem.readdirSync(usersFiles).values());
  18 |   if (users.includes(user)) {
  19 |     let userFiles = Array.from(
> 20 |       fileSystem.readdirSync(`${usersFiles}/${user}/`).values()
  21 |     );
  22 |     if (userFiles.includes(file)) {
  23 |       let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
  24 |       fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  25 |         result.ok = true;
  26 |         if (error) {
  27 |           result.ok = false;
  28 |           result[""errors""] = [
  29 |             {
  30 |               message: error,
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test063.js,24,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test063.js,"
  14 |   let result = {
  15 |     ok: false,
  16 |   };
  17 |   let users = Array.from(fileSystem.readdirSync(usersFiles).values());
  18 |   if (users.includes(user)) {
  19 |     let userFiles = Array.from(
  20 |       fileSystem.readdirSync(`${usersFiles}/${user}/`).values()
  21 |     );
  22 |     if (userFiles.includes(file)) {
  23 |       let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
> 24 |       fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  25 |         result.ok = true;
  26 |         if (error) {
  27 |           result.ok = false;
  28 |           result[""errors""] = [
  29 |             {
  30 |               message: error,
  31 |             },
  32 |           ];
  33 |         } else {
  34 |           res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test070.js,10,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test070.js,"
   1 | var express = require(""express"");
   2 | var router = express.Router();
   3 | const fs = require(""fs"");
   4 |
   5 | router.get(""/test070/"", function (req, res) {
   6 |   var user = req.query[""user""];
   7 |   var fileName = req.query[""fileName""];
   8 |   var filePath = `target/user_files/${user}/${fileName}.yaml`;
   9 |   if (user && fileName) {
> 10 |     fs.readFile(filePath, ""utf-8"", (err, data) => {
  11 |       if (err) {
  12 |         res.status(""404"").json({
  13 |           error: ""file does not exists "",
  14 |         });
  15 |       }
  16 |       res.send(data);
  17 |     });
  18 |   } else {
  19 |     res.status(""404"").json({
  20 |       error: ""file does not exists "",
  21 |     });
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test072.js,20,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test072.js,"
  10 |   let payload = body.payload;
  11 |
  12 |   let usersFiles = ""./target/user_files"";
  13 |
  14 |   let result = {
  15 |     ok: false,
  16 |   };
  17 |   let users = Array.from(fileSystem.readdirSync(usersFiles).values());
  18 |   if (users.includes(user)) {
  19 |     let filePath = join(`target/user_files/${user}/`, file + "".yaml"");
> 20 |     fileSystem.writeFile(filePath, payload, ""utf8"", (error) => {
  21 |       result.ok = true;
  22 |       if (error) {
  23 |         result.ok = false;
  24 |         result[""errors""] = [
  25 |           {
  26 |             message: error,
  27 |           },
  28 |         ];
  29 |       } else {
  30 |         res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test073.js,16,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test073.js,"
   6 |   var user = req.params[""user""];
   7 |   var bar = ""alsosafe"";
   8 |   var valuesList = [];
   9 |   valuesList.push(""safe"");
  10 |   valuesList.push(user);
  11 |   valuesList.push(""moresafe"");
  12 |   bar = valuesList[1];
  13 |
  14 |   let userFiles = ""./target/user_files/"";
  15 |   var filePath = userFiles + bar;
> 16 |   fs.readdir(filePath, (error, files) => {
  17 |     if (error) {
  18 |       res.status(""404"").json({
  19 |         error: `the file ${filePath} does no exist`,
  20 |       });
  21 |     } else {
  22 |       res.json({ user_files: files });
  23 |     }
  24 |   });
  25 | });
  26 |
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test075.js,20,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test075.js,"
  10 |   let list75 = [""safe"", ""safe"", _user, _fileName];
  11 |   list75.shift();
  12 |   list75.push(""safe"");
  13 |   var fileName = list75[2];
  14 |   var user = list75[1];
  15 |   var filePath = pathh.join(""target/user_files"", user, fileName);
  16 |
  17 |   let result = {
  18 |     ok: false,
  19 |   };
> 20 |   unlink(filePath, (error) => {
  21 |     result.ok = true;
  22 |     if (error) {
  23 |       result[""ok""] = false;
  24 |       result[""errors""] = [
  25 |         {
  26 |           message: error,
  27 |         },
  28 |       ];
  29 |     }
  30 |     res.json(result);
     ^ Col 0
"
F063,lines,VULNERABLE_JS_APP/server/routes/testcases/test076.js,23,22,skims,063. Lack of data validation - Path Traversal,Path traversal in server/routes/testcases/test076.js,"
  13 |   list76A.push(""safe"");
  14 |   list76B.pop();
  15 |   let list76C = list76A.concat(list76B);
  16 |   var fileName = list76C[2];
  17 |   var user = list76C[0];
  18 |   var filePath = pathh.join(""target/user_files"", user, fileName);
  19 |
  20 |   let result = {
  21 |     ok: false,
  22 |   };
> 23 |   unlink(filePath, (error) => {
  24 |     result.ok = true;
  25 |     if (error) {
  26 |       result[""ok""] = false;
  27 |       result[""errors""] = [
  28 |         {
  29 |           message: error,
  30 |         },
  31 |       ];
  32 |     }
  33 |     res.json(result);
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test005.js,7,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | const process = require(""child_process"");
   2 | var express = require('express');
   3 | var router = express.Router();
   4 |
   5 | router.get('/test005/:user', function (req, res) {
   6 |   var user = req.params['user'];
>  7 |   process.exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
   8 |
   9 |     var user_files = [];
  10 |     for (var file of stdout.split('\n')) {
  11 |       if (file) {
  12 |         user_files.push(file);
  13 |       }
  14 |     }
  15 |
  16 |     var data = {
  17 |       'user_files': user_files
  18 |     };
  19 |     res.json(data);
  20 |   });
  21 | });
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test007.js,8,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | const process = require(""child_process"");
   2 | var express = require('express');
   3 | var router = express.Router();
   4 |
   5 | router.get('/test007', function (req, res) {
   6 |   let body = req.body;
   7 |
>  8 |   process.exec(""ls target/user_files/"" + body['user'] + ""/"", (error, stdout, stderr) => {
   9 |
  10 |     var user_files = [];
  11 |     for (var file of stdout.split('\n')) {
  12 |       if (file) {
  13 |         user_files.push(file);
  14 |       }
  15 |     }
  16 |
  17 |     var data = {
  18 |       'user_files': user_files
  19 |     };
  20 |     res.json(data);
  21 |   });
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test003.js,9,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | const {
   2 |   exec
   3 | } = require(""child_process"");
   4 | var express = require('express');
   5 | var router = express.Router();
   6 |
   7 | router.get('/test003/:user', function (req, res) {
   8 |   var user = req.params['user'];
>  9 |   exec(`ls target/user_files/${user}/`, (error, stdout, stderr) => {
  10 |
  11 |     var user_files = [];
  12 |     for (var file of stdout.split('\n')) {
  13 |       if (file) {
  14 |         user_files.push(file);
  15 |       }
  16 |     }
  17 |
  18 |     var data = {
  19 |       'user_files': user_files
  20 |     };
  21 |     res.json(data);
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test012.js,11,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | const {
   2 |   exec
   3 | } = require(""child_process"");
   4 | var express = require('express');
   5 | var router = express.Router();
   6 |
   7 | router.get('/test012/:user', function (req, res) {
   8 |   var user_files = [];
   9 |   var user = """";
  10 |   for (var user of Object.values(req.params)) {
> 11 |     exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  12 |
  13 |       for (var file of stdout.split('\n')) {
  14 |         if (file) {
  15 |           user_files.push(file);
  16 |         }
  17 |       }
  18 |
  19 |       var data = {
  20 |         'user_files': user_files
  21 |       };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test001.js,7,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | import { exec } from ""child_process"";
   2 | import { Router } from 'express';
   3 | var router = Router();
   4 |
   5 | router.get('/test001/:user', function (req, res) {
   6 |   var user = req.params['user'];
>  7 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
   8 |
   9 |     var user_files = [];
  10 |     for (var file of stdout.split('\n')) {
  11 |       if (file) {
  12 |         user_files.push(file);
  13 |       }
  14 |     }
  15 |
  16 |     var data = {
  17 |       'user_files': user_files
  18 |     };
  19 |     res.json(data);
  20 |   });
  21 | });
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test004.js,7,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | import { exec } from ""child_process"";
   2 | import { Router } from 'express';
   3 | var router = Router();
   4 |
   5 | router.get('/test004/', function (req, res) {
   6 |   var user = req.query.user;
>  7 |   exec(`ls target/user_files/${user}/`, (error, stdout, stderr) => {
   8 |
   9 |     var user_files = [];
  10 |     for (var file of stdout.split('\n')) {
  11 |       if (file) {
  12 |         user_files.push(file);
  13 |       }
  14 |     }
  15 |
  16 |     var data = {
  17 |       'user_files': user_files
  18 |     };
  19 |     res.json(data);
  20 |   });
  21 | });
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test017.js,11,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | import { exec } from ""child_process"";
   2 | import { Router } from 'express';
   3 | var router = Router();
   4 |
   5 | router.get('/test017/:user', function (req, res) {
   6 |   var user = req.params['user'];
   7 |   const data = {
   8 |     keyA: user,
   9 |     keyB: ""safe"",
  10 |   };
> 11 |   exec(""ls target/user_files/"" + data.keyA + ""/"", (error, stdout, stderr) => {
  12 |
  13 |     var user_files = [];
  14 |     for (var file of stdout.split('\n')) {
  15 |       if (file) {
  16 |         user_files.push(file);
  17 |       }
  18 |     }
  19 |
  20 |     var data = {
  21 |       'user_files': user_files
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test015.js,7,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   1 | import { execSync } from ""child_process"";
   2 | import { Router } from 'express';
   3 | var router = Router();
   4 |
   5 | router.get('/test015/:user', function (req, res) {
   6 |   var user = req.params['user'];
>  7 |   var stdout = execSync(""ls target/user_files/"" + user + ""/"").toString()
   8 |
   9 |   var user_files = [];
  10 |   for (var file of stdout.split('\n')) {
  11 |     if (file) {
  12 |       user_files.push(file);
  13 |     }
  14 |   }
  15 |
  16 |   var data = {
  17 |     'user_files': user_files
  18 |   };
  19 |   res.json(data);
  20 | });
  21 |
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test071.js,12,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   2 | import { Router } from ""express"";
   3 | var router = Router();
   4 |
   5 | router.get(""/test071/:user"", function (req, res) {
   6 |   var user = req.params[""user""];
   7 |   var map64 = {
   8 |     keyA: ""a_Value"",
   9 |     keyB: user,
  10 |     keyC: ""c_value"",
  11 |   };
> 12 |   exec(""ls target/user_files/"" + map64.keyB + ""/"", (error, stdout, stderr) => {
  13 |     var user_files = [];
  14 |     for (var file of stdout.split(""\n"")) {
  15 |       if (file) {
  16 |         user_files.push(file);
  17 |       }
  18 |     }
  19 |
  20 |     var data = {
  21 |       user_files: user_files,
  22 |     };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test010.js,14,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   4 | var express = require('express');
   5 | var router = express.Router();
   6 |
   7 | router.get('/test010/:user', function (req, res) {
   8 |   var user = """";
   9 |   var parameters = req.params;
  10 |   if (req.params['user'] != undefined) {
  11 |     user = parameters['user'];
  12 |   }
  13 |   user = decodeURI(user);
> 14 |   exec(`ls target/user_files/${user}/`, (error, stdout, stderr) => {
  15 |
  16 |     var user_files = [];
  17 |     for (var file of stdout.split('\n')) {
  18 |       if (file) {
  19 |         user_files.push(file);
  20 |       }
  21 |     }
  22 |
  23 |     var data = {
  24 |       'user_files': user_files
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test074.js,15,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   5 | router.get(""/test074/:user"", function (req, res) {
   6 |   var user = req.params[""user""];
   7 |   var map64 = {
   8 |     keyA: ""a_Value"",
   9 |     keyB: ""safe"",
  10 |     keyC: ""c_value"",
  11 |   };
  12 |   var param = user;
  13 |   map64.keyB = param;
  14 |   user = map64[""keyB""];
> 15 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  16 |     var user_files = [];
  17 |     for (var file of stdout.split(""\n"")) {
  18 |       if (file) {
  19 |         user_files.push(file);
  20 |       }
  21 |     }
  22 |
  23 |     var data = {
  24 |       user_files: user_files,
  25 |     };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test013.js,15,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   5 | var router = express.Router();
   6 |
   7 | router.get('/test013/:user', function (req, res) {
   8 |   var user_files = [];
   9 |   var user = """";
  10 |   var paramValues = Object.values(req.params);
  11 |   if (paramValues.length > 0) {
  12 |     user = paramValues[0];
  13 |   }
  14 |   if (user) {
> 15 |     exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  16 |
  17 |       for (var file of stdout.split('\n')) {
  18 |         if (file) {
  19 |           user_files.push(file);
  20 |         }
  21 |       }
  22 |
  23 |       var data = {
  24 |         'user_files': user_files
  25 |       };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test066.js,16,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   6 |   var user = req.params[""user""];
   7 |   console.log(req.params);
   8 |   var map64 = {
   9 |     keyA: ""a_Value"",
  10 |     keyB: ""safe"",
  11 |     keyC: ""c_value"",
  12 |   };
  13 |   var param = user;
  14 |   map64[""keyB""] = param;
  15 |   user = map64.keyB;
> 16 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  17 |     var user_files = [];
  18 |     for (var file of stdout.split(""\n"")) {
  19 |       if (file) {
  20 |         user_files.push(file);
  21 |       }
  22 |     }
  23 |
  24 |     var data = {
  25 |       user_files: user_files,
  26 |     };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test011.js,16,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   6 |
   7 | router.get('/test011/:user', function (req, res) {
   8 |   var user = """";
   9 |   for(var key of Object.keys(req.params))
  10 |   {
  11 |     if (key == 'user'){
  12 |       user = req.params[key];
  13 |       break;
  14 |     }
  15 |   }
> 16 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  17 |
  18 |     var user_files = [];
  19 |     for (var file of stdout.split('\n')) {
  20 |       if (file) {
  21 |         user_files.push(file);
  22 |       }
  23 |     }
  24 |
  25 |     var data = {
  26 |       'user_files': user_files
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test065.js,17,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
   7 |   var parameters = req.params;
   8 |   if (req.params[""user""] != undefined) {
   9 |     user = parameters[""user""];
  10 |   }
  11 |   let allowed = [""a"", user];
  12 |   allowed.pop();
  13 |   allowed[1] = ""safe"";
  14 |   allowed.pop();
  15 |   allowed[1] = user;
  16 |   var param = decodeURI(allowed[1]);
> 17 |   exec(`ls target/user_files/${param}/`, (error, stdout, stderr) => {
  18 |     var user_files = [];
  19 |     for (var file of stdout.split(""\n"")) {
  20 |       if (file) {
  21 |         user_files.push(file);
  22 |       }
  23 |     }
  24 |
  25 |     var data = {
  26 |       user_files: user_files,
  27 |     };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test016.js,28,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
  18 |       break;
  19 |     case 'C':
  20 |     case 'D':
  21 |       user = param;
  22 |       break;
  23 |     default:
  24 |       uer = ""bobs_your_uncle"";
  25 |       break;
  26 |   }
  27 |
> 28 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  29 |
  30 |     for (var file of stdout.split('\n')) {
  31 |       if (file) {
  32 |         user_files.push(file);
  33 |       }
  34 |     }
  35 |
  36 |     var data = {
  37 |       'user_files': user_files
  38 |     };
     ^ Col 0
"
F004,lines,VULNERABLE_JS_APP/server/routes/testcases/test014.js,31,78,skims,004. Remote command execution,"The system builds OS commands using inputs that can be manipulated externally, it does not correctly neutralize special elements that could modify the OS command.
","
  21 |       break;
  22 |     case 'C':
  23 |     case 'D':
  24 |       user = param;
  25 |       break;
  26 |     default:
  27 |       uer = ""bobs_your_uncle"";
  28 |       break;
  29 |   }
  30 |
> 31 |   exec(""ls target/user_files/"" + user + ""/"", (error, stdout, stderr) => {
  32 |
  33 |     for (var file of stdout.split('\n')) {
  34 |       if (file) {
  35 |         user_files.push(file);
  36 |       }
  37 |     }
  38 |
  39 |     var data = {
  40 |       'user_files': user_files
  41 |     };
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test077.js,8,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   1 | import { Router } from ""express"";
   2 | var router = Router();
   3 |
   4 | router.get(""/test077/:user"", function (req, res) {
   5 |   var user = req.params[""user""];
   6 |   res.setHeader(""Content-Type"", ""text/html"");
   7 |   res.setHeader(""X-XSS-Protection"", ""0"");
>  8 |   res.send(
   9 |     `
  10 |     <!DOCTYPE html>
  11 |     <html>
  12 |       <body>
  13 |         <h1>Hello ${user}</h1>
  14 |       </body>
  15 |     </html>
  16 | `
  17 |   );
  18 | });
  19 |
  20 | export default router;
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test080.js,9,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   1 | var express = require(""express"");
   2 | var router = express.Router();
   3 |
   4 | router.get(""/test080/:user"", function (req, res) {
   5 |   var user = """";
   6 |   user = req.params[""user""];
   7 |   res.setHeader(""Content-Type"", ""text/html"");
   8 |   res.setHeader(""X-XSS-Protection"", ""0"");
>  9 |   res.send(
  10 |     `
  11 |     <!DOCTYPE html>
  12 |     <html>
  13 |       <body>
  14 |         <h1>Hello ${user}</h1>
  15 |       </body>
  16 |     </html>
  17 | `
  18 |   );
  19 | });
  20 |
  21 | export default router;
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test087.js,12,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   2 | var router = Router();
   3 |
   4 | router.get(""/test087/:user"", function (req, res) {
   5 |   var param = req.params[""user""];
   6 |   let list75 = [""safe"", ""safe"", param];
   7 |   list75.shift();
   8 |   list75.push(""safe"");
   9 |   var user = list75[1];
  10 |   res.setHeader(""Content-Type"", ""text/html"");
  11 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 12 |   res.send(
  13 |     `
  14 |     <!DOCTYPE html>
  15 |     <html>
  16 |       <body>
  17 |         <h1>Hello ${user}</h1>
  18 |       </body>
  19 |     </html>
  20 | `
  21 |   );
  22 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test078.js,13,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   3 |
   4 | router.get(""/test078/:user"", function (req, res) {
   5 |   var param = req.params[""user""];
   6 |
   7 |   var user = ""Jane Doe"";
   8 |   if (32 > 31) {
   9 |     user = param;
  10 |   }
  11 |   res.setHeader(""Content-Type"", ""text/html"");
  12 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 13 |   res.send(
  14 |     `
  15 |     <!DOCTYPE html>
  16 |     <html>
  17 |       <body>
  18 |         <h1>Hello ${user}</h1>
  19 |       </body>
  20 |     </html>
  21 | `
  22 |   );
  23 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test083.js,18,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   8 |   var map64 = {
   9 |     keyA: ""a_Value"",
  10 |     keyB: param,
  11 |     keyC: ""c_value"",
  12 |   };
  13 |
  14 |   var user = map64.keyB;
  15 |
  16 |   res.setHeader(""Content-Type"", ""text/html"");
  17 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 18 |   res.send(
  19 |     `
  20 |     <!DOCTYPE html>
  21 |     <html>
  22 |       <body>
  23 |         <h1>Hello ${user}</h1>
  24 |       </body>
  25 |     </html>
  26 | `
  27 |   );
  28 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test079.js,18,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
   8 |   var string_name = """";
   9 |   data.push(""safe"");
  10 |   data.push(param);
  11 |
  12 |   for (var user of data) {
  13 |     string_name = string_name.concat(user);
  14 |   }
  15 |
  16 |   res.setHeader(""Content-Type"", ""text/html"");
  17 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 18 |   res.send(
  19 |     `
  20 |     <!DOCTYPE html>
  21 |     <html>
  22 |       <body>
  23 |         <h1>Hello ${string_name}</h1>
  24 |       </body>
  25 |     </html>
  26 | `
  27 |   );
  28 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test084.js,20,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
  10 |     keyB: param,
  11 |     keyC: ""c_value"",
  12 |   };
  13 |   if (3 > -2) {
  14 |     map64.keyB = ""safe"";
  15 |   }
  16 |   var user = map64.keyB;
  17 |
  18 |   res.setHeader(""Content-Type"", ""text/html"");
  19 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 20 |   res.send(
  21 |     `
  22 |     <!DOCTYPE html>
  23 |     <html>
  24 |       <body>
  25 |         <h1>Hello ${user}</h1>
  26 |       </body>
  27 |     </html>
  28 | `
  29 |   );
  30 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test085.js,20,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
  10 |   let allowed = [""a"", user];
  11 |   allowed.pop();
  12 |   allowed[1] = ""safe"";
  13 |   allowed.pop();
  14 |   allowed[1] = user;
  15 |   user = decodeURI(allowed[1]);
  16 |
  17 |   var user = req.params[""user""];
  18 |   res.setHeader(""Content-Type"", ""text/html"");
  19 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 20 |   res.send(
  21 |     `
  22 |     <!DOCTYPE html>
  23 |     <html>
  24 |       <body>
  25 |         <h1>Hello ${user}</h1>
  26 |       </body>
  27 |     </html>
  28 | `
  29 |   );
  30 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test086.js,21,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
  11 |   allowed.pop();
  12 |   allowed[1] = ""safe"";
  13 |   allowed[1] = user;
  14 |   allowed.pop();
  15 |   allowed.push = ""safe"";
  16 |   user = decodeURI(allowed[1]);
  17 |
  18 |   var user = req.params[""user""];
  19 |   res.setHeader(""Content-Type"", ""text/html"");
  20 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 21 |   res.send(
  22 |     `
  23 |     <!DOCTYPE html>
  24 |     <html>
  25 |       <body>
  26 |         <h1>Hello ${user}</h1>
  27 |       </body>
  28 |     </html>
  29 | `
  30 |   );
  31 | });
     ^ Col 0
"
F008,lines,VULNERABLE_JS_APP/server/routes/testcases/test081.js,29,79,skims,008. Reflected cross-site scripting (XSS),"The web application dynamically generates web content without validating the source of the potentially untrusted data.
","
  19 |     case ""D"":
  20 |       user = param;
  21 |       break;
  22 |     default:
  23 |       uer = ""bobs_your_uncle"";
  24 |       break;
  25 |   }
  26 |
  27 |   res.setHeader(""Content-Type"", ""text/html"");
  28 |   res.setHeader(""X-XSS-Protection"", ""0"");
> 29 |   res.send(
  30 |     `
  31 |     <!DOCTYPE html>
  32 |     <html>
  33 |       <body>
  34 |         <h1>Hello ${user}</h1>
  35 |       </body>
  36 |     </html>
  37 | `
  38 |   );
  39 | });
     ^ Col 0
"
