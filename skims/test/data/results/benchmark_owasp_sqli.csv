finding,kind,what,where,cwe,stream,title,description,snippet,method
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00008.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00008.java,"
  49 |
  50 |  // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  51 |  param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |
  54 |  String sql = ""{call "" + param + ""}"";
  55 |
  56 |  try {
  57 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  58 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 59 |      java.sql.ResultSet rs = statement.executeQuery();
  60 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  61 |
  62 |  } catch (java.sql.SQLException e) {
  63 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |          response.getWriter().println(
  65 | Error processing request.""
  66 | ;
  67 |          return;
  68 |         }
  69 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00018.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00018.java,"
  50 |   }
  51 |
  52 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  53 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  54 |
  55 |
  56 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ param + ""')"";
  57 |
  58 |   try {
  59 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 60 |    int count = statement.executeUpdate( sql );
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00024.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00024.java,"
  47 |
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ param +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  53 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  54 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  55 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  56 |     statement.setString(1, ""foo"");
> 57 |    statement.execute();
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00025.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00025.java,"
  42 |   response.setContentType(""text/html;charset=UTF-8"");
  43 |
  44 |
  45 |   String param = request.getParameter(""BenchmarkTest00025"");
  46 |   if (param == null) param = """";
  47 |
  48 |
  49 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + param + ""'"";
  50 |   try {
  51 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 52 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  53 |    response.getWriter().println(
  54 |     ""Your results are: ""
  55 |    );
  56 |
  57 |  //  System.out.println(""your results are"");
  58 |    response.getWriter().println(
  59 |     results.toString()
  60 |    );
  61 |  //  System.out.println(results);
  62 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00026.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00026.java,"
  42 |   response.setContentType(""text/html;charset=UTF-8"");
  43 |
  44 |
  45 |   String param = request.getParameter(""BenchmarkTest00026"");
  46 |   if (param == null) param = """";
  47 |
  48 |
  49 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ param + ""'"";
  50 |   try {
  51 |          org.springframework.jdbc.support.rowset.SqlRowSet results
> 52 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
  53 |          response.getWriter().println(
  54 |     ""Your results are: ""
  55 |    );
  56 |
  57 |  //  System.out.println(""Your results are"");
  58 |    while (results.next()) {
  59 |     response.getWriter().println(
  60 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
  61 |     );
  62 |  //   System.out.println(results.getString(""USERNAME""));
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00027.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00027.java,"
  43 |
  44 |
  45 |   String param = request.getParameter(""BenchmarkTest00027"");
  46 |   if (param == null) param = """";
  47 |
  48 |
  49 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ param + ""')"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    int count = statement.executeUpdate( sql );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00032.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00032.java,"
  47 |   if (!map.isEmpty()) {
  48 |    String[] values = map.get(""BenchmarkTest00032"");
  49 |    if (values != null) param = values[0];
  50 |   }
  51 |
  52 |
  53 |
  54 |    try {
  55 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + param + ""'"";
  56 |
> 57 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  58 |    response.getWriter().println(
  59 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  60 |     + "" because the Spring execute method doesn't return results.""
  61 |    );
  62 |
  63 |   } catch (org.springframework.dao.DataAccessException e) {
  64 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  65 |           response.getWriter().println(
  66 |      ""Error processing request.""
  67 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00033.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00033.java,"
  47 |   if (!map.isEmpty()) {
  48 |    String[] values = map.get(""BenchmarkTest00033"");
  49 |    if (values != null) param = values[0];
  50 |   }
  51 |
  52 |
  53 |
  54 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ param + ""'"";
  55 |   try {
  56 |          org.springframework.jdbc.support.rowset.SqlRowSet results
> 57 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
  58 |          response.getWriter().println(
  59 |     ""Your results are: ""
  60 |    );
  61 |
  62 |  //  System.out.println(""Your results are"");
  63 |    while (results.next()) {
  64 |     response.getWriter().println(
  65 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
  66 |     );
  67 |  //   System.out.println(results.getString(""USERNAME""));
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00034.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00034.java,"
  48 |    String[] values = map.get(""BenchmarkTest00034"");
  49 |    if (values != null) param = values[0];
  50 |   }
  51 |
  52 |
  53 |
  54 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ param +""'"";
  55 |
  56 |   try {
  57 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 58 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  59 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  60 |   } catch (java.sql.SQLException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 | ""Error processing request.""
  64 | );
  65 |           return;
  66 |          }
  67 |    else throw new ServletException(e);
  68 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00037.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00037.java,"
  61 |
  62 |
  63 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ param +""'"";
  64 |
  65 |   try {
  66 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  67 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  68 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  69 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  70 |     statement.setString(1, ""foo"");
> 71 |    statement.execute();
  72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  73 |   } catch (java.sql.SQLException e) {
  74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  75 |           response.getWriter().println(
  76 | ""Error processing request.""
  77 | );
  78 |           return;
  79 |          }
  80 |    else throw new ServletException(e);
  81 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00038.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00038.java,"
   55 | aram = name;
   56 |   flag = false;
   57 |
   58 |
   59 |
   60 |
   61 |
   62 |
   63 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + param + ""'"";
   64 | {
>  65 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   66 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   67 |           try {
   68 |            return rs.getString(""USERNAME"");
   69 |           } catch (java.sql.SQLException e) {
   70 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   71 |       return ""Error processing query."";
   72 |      }
   73 | lse throw e;
   74 |
   75 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00039.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00039.java,"
  55 |
  56 | e;
  57 |
  58 |
  59 |
  60 |
  61 |
  62 |
  63 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + param + ""'"";
  64 |
> 65 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  66 | r().println(
  67 | e: ""
  68 |
  69 |
  70 | tln(""Your results are"");
  71 | r().println(
  72 | ESAPI.encoder().encodeForHTML(results.toString())
  73 |
  74 | tln(results.toString());
  75 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00043.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00043.java,"
  44 |
  45 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  46 |   String param = scr.getTheParameter(""BenchmarkTest00043"");
  47 |   if (param == null) param = """";
  48 |
  49 |
  50 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ param + ""')"";
  51 |
  52 |   try {
  53 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 54 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  56 |   } catch (java.sql.SQLException e) {
  57 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00100.java,80,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00100.java,"
  70 |
  71 |
  72 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  73 |
  74 |   try {
  75 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  76 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  77 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  78 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  79 |     statement.setString(1, ""foo"");
> 80 |    statement.execute();
  81 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  82 |   } catch (java.sql.SQLException e) {
  83 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  84 |           response.getWriter().println(
  85 | ""Error processing request.""
  86 | );
  87 |           return;
  88 |          }
  89 |    else throw new ServletException(e);
  90 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00101.java,83,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00101.java,"
  73 |    bar = valuesList.get(0); // get the param value
  74 |   }
  75 |
  76 |
  77 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  78 |
  79 |   try {
  80 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  81 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  82 |    statement.setString(1, ""foo"");
> 83 |    statement.execute();
  84 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  85 |   } catch (java.sql.SQLException e) {
  86 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  87 |           response.getWriter().println(
  88 | ""Error processing request.""
  89 | );
  90 |           return;
  91 |          }
  92 |    else throw new ServletException(e);
  93 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00102.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00102.java,"
  60 |
  61 |
  62 |
  63 |
  64 | k.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  65 | .doSomething(param);
  66 |
  67 |
  68 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  69 |
> 70 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  71 | r().println(
  72 | e: ""
  73 |
  74 |
  75 | tln(""Your results are"");
  76 | r().println(
  77 | ESAPI.encoder().encodeForHTML(results.toString())
  78 |
  79 | tln(results.toString());
  80 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00103.java,75,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00103.java,"
  65 |
  66 |   // Simple ? condition that assigns param to bar on false condition
  67 |   int num = 106;
  68 |
  69 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  70 |
  71 |
  72 |
  73 |   String sql = ""SELECT TOP 1 USERNAME from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  74 |   try {
> 75 |          Object results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql,new Object[]{}, Stri
  76 |    response.getWriter().println(
  77 |     ""Your results are: ""
  78 |    );
  79 |
  80 |  //  System.out.println(""Your results are"");
  81 |    response.getWriter().println(
  82 |     org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.toString())
  83 |    );
  84 |  //  System.out.println(results.toString());
  85 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00106.java,81,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00106.java,"
  71 |    valuesList.remove(0); // remove the 1st safe value
  72 |
  73 |    bar = valuesList.get(0); // get the param value
  74 |   }
  75 |
  76 |
  77 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  78 |
  79 |   try {
  80 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 81 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  82 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  83 |   } catch (java.sql.SQLException e) {
  84 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  85 |           response.getWriter().println(
  86 | ""Error processing request.""
  87 | );
  88 |           return;
  89 |          }
  90 |    else throw new ServletException(e);
  91 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00108.java,90,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00108.java,"
   80 |     default:
   81 |           bar = ""bobs_your_uncle"";
   82 |           break;
   83 |   }
   84 |
   85 |
   86 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
   87 |
   88 |   try {
   89 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  90 |    statement.execute( sql, new int[] { 1, 2 } );
   91 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   92 |   } catch (java.sql.SQLException e) {
   93 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   94 |           response.getWriter().println(
   95 | ""Error processing request.""
   96 | );
   97 |           return;
   98 |          }
   99 |    else throw new ServletException(e);
  100 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00109.java,75,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00109.java,"
  65 |   if (param != null) {
  66 |    bar = new String( org.apache.commons.codec.binary.Base64.decodeBase64(
  67 |    org.apache.commons.codec.binary.Base64.encodeBase64( param.getBytes() ) ));
  68 |   }
  69 |
  70 |
  71 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  72 |
  73 |   try {
  74 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 75 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  76 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  77 |   } catch (java.sql.SQLException e) {
  78 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  79 |           response.getWriter().println(
  80 | ""Error processing request.""
  81 | );
  82 |           return;
  83 |          }
  84 |    else throw new ServletException(e);
  85 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00111.java,81,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00111.java,"
  71 |    valuesList.remove(0); // remove the 1st safe value
  72 |
  73 |    bar = valuesList.get(0); // get the param value
  74 |   }
  75 |
  76 |
  77 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  78 |
  79 |   try {
  80 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 81 |    int count = statement.executeUpdate( sql );
  82 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  83 |   } catch (java.sql.SQLException e) {
  84 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  85 |           response.getWriter().println(
  86 | ""Error processing request.""
  87 | );
  88 |           return;
  89 |          }
  90 |    else throw new ServletException(e);
  91 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00112.java,72,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00112.java,"
  62 |
  63 |
  64 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  65 |   String bar = thing.doSomething(param);
  66 |
  67 |
  68 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  69 |
  70 |   try {
  71 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 72 |    int count = statement.executeUpdate( sql );
  73 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  74 |   } catch (java.sql.SQLException e) {
  75 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  76 |           response.getWriter().println(
  77 | ""Error processing request.""
  78 | );
  79 |           return;
  80 |          }
  81 |    else throw new ServletException(e);
  82 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00115.java,76,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00115.java,"
  66 |   map11928.put(""keyA-11928"", ""a-Value""); // put some stuff in the collection
  67 |   map11928.put(""keyB-11928"", param); // put it in a collection
  68 |   map11928.put(""keyC"", ""another-Value""); // put some stuff in the collection
  69 |   bar = (String)map11928.get(""keyB-11928""); // get it back out
  70 |
  71 |
  72 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  73 |
  74 |   try {
  75 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 76 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  77 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  78 |   } catch (java.sql.SQLException e) {
  79 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  80 |           response.getWriter().println(
  81 | ""Error processing request.""
  82 | );
  83 |           return;
  84 |          }
  85 |    else throw new ServletException(e);
  86 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00192.java,80,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00192.java,"
  70 |           break;
  71 |   }
  72 |
  73 |
  74 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  75 |
  76 |   try {
  77 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  78 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql );
  79 |    statement.setString(1, ""foo"");
> 80 |    statement.execute();
  81 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  82 |   } catch (java.sql.SQLException e) {
  83 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  84 |           response.getWriter().println(
  85 | ""Error processing request.""
  86 | );
  87 |           return;
  88 |          }
  89 |    else throw new ServletException(e);
  90 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00193.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00193.java,"
  57 |      bar = param;
  58 |   else bar = ""This should never happen"";
  59 |
  60 |
  61 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  62 |
  63 |   try {
  64 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  65 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  66 |    statement.setString(1, ""foo"");
> 67 |    statement.execute();
  68 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  69 |   } catch (java.sql.SQLException e) {
  70 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  71 |           response.getWriter().println(
  72 | ""Error processing request.""
  73 | );
  74 |           return;
  75 |          }
  76 |    else throw new ServletException(e);
  77 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00194.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00194.java,"
  52 |   String bar = """";
  53 |   if (param != null) {
  54 |    bar = new String( org.apache.commons.codec.binary.Base64.decodeBase64(
  55 |    org.apache.commons.codec.binary.Base64.encodeBase64( param.getBytes() ) ));
  56 |   }
  57 |
  58 |
  59 |   try {
  60 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  61 |
> 62 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  63 |    response.getWriter().println(
  64 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  65 |     + "" because the Spring batchUpdate method doesn't return results.""
  66 |    );
  67 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  68 |   } catch (org.springframework.dao.DataAccessException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 |      ""Error processing request.""
  72 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00195.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00195.java,"
  54 |   // Simple ? condition that assigns param to bar on false condition
  55 |   int num = 106;
  56 |
  57 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  58 |
  59 |
  60 |
  61 |    try {
  62 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  63 |
> 64 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  65 |    response.getWriter().println(
  66 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  67 |     + "" because the Spring execute method doesn't return results.""
  68 |    );
  69 |
  70 |   } catch (org.springframework.dao.DataAccessException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 |      ""Error processing request.""
  74 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00196.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00196.java,"
  54 |   // Simple if statement that assigns param to bar on true condition
  55 |   int num = 196;
  56 |   if ( (500/42) + num > 200 )
  57 |      bar = param;
  58 |   else bar = ""This should never happen"";
  59 |
  60 |
  61 |    try {
  62 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  63 |
> 64 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  65 |    response.getWriter().println(
  66 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  67 |     + "" because the Spring execute method doesn't return results.""
  68 |    );
  69 |
  70 |   } catch (org.springframework.dao.DataAccessException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 |      ""Error processing request.""
  74 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00198.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00198.java,"
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |
  52 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  53 |   String bar = thing.doSomething(param);
  54 |
  55 |
  56 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
  57 |   try {
  58 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
> 59 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
  60 |    response.getWriter().println(
  61 |     ""Your results are: ""
  62 |    );
  63 |
  64 |  //  System.out.println(""Your results are: "");
  65 |    response.getWriter().println(
  66 |     results.toString()
  67 |    );
  68 |  //  System.out.println(results);
  69 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00199.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00199.java,"
  54 |   // Simple if statement that assigns param to bar on true condition
  55 |   int num = 196;
  56 |   if ( (500/42) + num > 200 )
  57 |      bar = param;
  58 |   else bar = ""This should never happen"";
  59 |
  60 |
  61 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
  62 |   try {
  63 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
> 64 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
  65 |    response.getWriter().println(
  66 |     ""Your results are: ""
  67 |    );
  68 |
  69 |  //  System.out.println(""Your results are: "");
  70 |    response.getWriter().println(
  71 |     results.toString()
  72 |    );
  73 |  //  System.out.println(results);
  74 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00203.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00203.java,"
  55 |   int num = 106;
  56 |
  57 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  58 |
  59 |
  60 |
  61 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  62 |
  63 |   try {
  64 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 65 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  66 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  67 |   } catch (java.sql.SQLException e) {
  68 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  69 |           response.getWriter().println(
  70 | ""Error processing request.""
  71 | );
  72 |           return;
  73 |          }
  74 |    else throw new ServletException(e);
  75 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00204.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00204.java,"
  50 |
  51 |
  52 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  53 |   String bar = thing.doSomething(param);
  54 |
  55 |
  56 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  57 |
  58 |   try {
  59 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 60 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00328.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00328.java,"
  58 |
  59 |  bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  60 |
  61 |
  62 |
  63 |  String sql = ""{call "" + bar + ""}"";
  64 |
  65 |  try {
  66 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  67 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 68 |      java.sql.ResultSet rs = statement.executeQuery();
  69 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |
  71 |  } catch (java.sql.SQLException e) {
  72 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |          response.getWriter().println(
  74 | Error processing request.""
  75 | ;
  76 |          return;
  77 |         }
  78 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00335.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00335.java,"
  59 |      bar = param;
  60 |   else bar = ""This should never happen"";
  61 |
  62 |
  63 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  64 |
  65 |   try {
  66 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  67 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new int[] { 1, 2 } );
  68 |    statement.setString(1, ""foo"");
> 69 |    statement.execute();
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00337.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00337.java,"
  59 |    valuesList.add( ""moresafe"" );
  60 |
  61 |    valuesList.remove(0); // remove the 1st safe value
  62 |
  63 |    bar = valuesList.get(0); // get the param value
  64 |   }
  65 |
  66 |
  67 |   String sql = ""SELECT TOP 1 USERNAME from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  68 |   try {
> 69 |          Object results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql,new Object[]{}, Stri
  70 |    response.getWriter().println(
  71 |     ""Your results are: ""
  72 |    );
  73 |
  74 |  //  System.out.println(""Your results are"");
  75 |    response.getWriter().println(
  76 |     org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.toString())
  77 |    );
  78 |  //  System.out.println(results.toString());
  79 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00339.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00339.java,"
  56 |   // Simple ? condition that assigns param to bar on false condition
  57 |   int num = 106;
  58 |
  59 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  60 |
  61 |
  62 |
  63 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
  64 |   try {
  65 |          org.springframework.jdbc.support.rowset.SqlRowSet results
> 66 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
  67 |          response.getWriter().println(
  68 |     ""Your results are: ""
  69 |    );
  70 |
  71 |  //  System.out.println(""Your results are"");
  72 |    while (results.next()) {
  73 |     response.getWriter().println(
  74 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
  75 |     );
  76 |  //   System.out.println(results.getString(""USERNAME""));
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00341.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00341.java,"
  56 |   // Simple if statement that assigns param to bar on true condition
  57 |   int num = 196;
  58 |   if ( (500/42) + num > 200 )
  59 |      bar = param;
  60 |   else bar = ""This should never happen"";
  61 |
  62 |
  63 |   try {
  64 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  65 |
> 66 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  67 |    response.getWriter().println(
  68 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  69 |     + "" because the Spring batchUpdate method doesn't return results.""
  70 |    );
  71 |   } catch (org.springframework.dao.DataAccessException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 |      ""Error processing request.""
  75 |     );
  76 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00342.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00342.java,"
  61 |    valuesList.remove(0); // remove the 1st safe value
  62 |
  63 |    bar = valuesList.get(0); // get the param value
  64 |   }
  65 |
  66 |
  67 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  68 |
  69 |   try {
  70 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 71 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  73 |   } catch (java.sql.SQLException e) {
  74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  75 |           response.getWriter().println(
  76 | ""Error processing request.""
  77 | );
  78 |           return;
  79 |          }
  80 |    else throw new ServletException(e);
  81 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00428.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00428.java,"
  56 |    bar = valuesList.get(0); // get the param value
  57 |   }
  58 |
  59 |
  60 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  61 |
  62 |   try {
  63 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  64 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql );
  65 |    statement.setString(1, ""foo"");
> 66 |    statement.execute();
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00429.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00429.java,"
  54 |
  55 |
  56 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  57 |
  58 |   try {
  59 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  60 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  61 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  62 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  63 |     statement.setString(1, ""foo"");
> 64 |    statement.execute();
  65 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  66 |   } catch (java.sql.SQLException e) {
  67 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  68 |           response.getWriter().println(
  69 | ""Error processing request.""
  70 | );
  71 |           return;
  72 |          }
  73 |    else throw new ServletException(e);
  74 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00431.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00431.java,"
  48 |
  49 | mple ? condition that assigns param to bar on false condition
  50 | um = 106;
  51 |
  52 |  (7*42) - num > 200 ? ""This should never happen"" : param;
  53 |
  54 |
  55 |
  56 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  57 | {
> 58 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
  59 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
  60 |           try {
  61 |            return rs.getString(""USERNAME"");
  62 |           } catch (java.sql.SQLException e) {
  63 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |       return ""Error processing query."";
  65 |      }
  66 | lse throw e;
  67 |
  68 |       }
     ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00433.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00433.java,"
  48 |
  49 | at assigns param to bar on true condition
  50 |
  51 |  )
  52 |
  53 | ever happen"";
  54 |
  55 |
  56 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  57 |
> 58 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
  59 | ntln(
  60 | ""
  61 |
  62 |
  63 | ur results are"");
  64 |
  65 |
  66 | intln(
  67 | encoder().encodeForHTML(o.toString()) + ""<br>""
  68 |
     ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00434.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00434.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |
  47 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  48 |   String bar = thing.doSomething(param);
  49 |
  50 |
  51 |   try {
  52 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  53 |
> 54 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  55 |    response.getWriter().println(
  56 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  57 |     + "" because the Spring batchUpdate method doesn't return results.""
  58 |    );
  59 |   } catch (org.springframework.dao.DataAccessException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 |      ""Error processing request.""
  63 |     );
  64 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00435.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00435.java,"
  49 |   map86691.put(""keyA-86691"", ""a-Value""); // put some stuff in the collection
  50 |   map86691.put(""keyB-86691"", param); // put it in a collection
  51 |   map86691.put(""keyC"", ""another-Value""); // put some stuff in the collection
  52 |   bar = (String)map86691.get(""keyB-86691""); // get it back out
  53 |
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    statement.addBatch( sql );
  60 |    int[] counts = statement.executeBatch();
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00438.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00438.java,"
  50 |   int num = 106;
  51 |
  52 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  53 |
  54 |
  55 |
  56 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  57 |
  58 |   try {
  59 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 60 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00439.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00439.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |
  47 |   String bar = param;
  48 |
  49 |
  50 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  51 |
  52 |   try {
  53 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 54 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  56 |   } catch (java.sql.SQLException e) {
  57 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00441.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00441.java,"
  45 |
  46 |
  47 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  48 |   String bar = thing.doSomething(param);
  49 |
  50 |
  51 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00510.java,80,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00510.java,"
  70 |           break;
  71 |   }
  72 |
  73 |
  74 |   String sql = ""{call "" + bar + ""}"";
  75 |
  76 |   try {
  77 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  78 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  79 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 80 |    java.sql.ResultSet rs = statement.executeQuery();
  81 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  82 |         } catch (java.sql.SQLException e) {
  83 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  84 |           response.getWriter().println(
  85 | ""Error processing request.""
  86 | );
  87 |           return;
  88 |          }
  89 |    else throw new ServletException(e);
  90 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00512.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00512.java,"
  49 |
  50 |
  51 |
  52 |   String bar = param;
  53 |
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    statement.execute( sql );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00515.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00515.java,"
  59 |    valuesList.remove(0); // remove the 1st safe value
  60 |
  61 |    bar = valuesList.get(0); // get the param value
  62 |   }
  63 |
  64 |
  65 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    statement.execute( sql, new int[] { 1, 2 } );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00516.java,78,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00516.java,"
  68 |     default:
  69 |           bar = ""bobs_your_uncle"";
  70 |           break;
  71 |   }
  72 |
  73 |
  74 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  75 |
  76 |   try {
  77 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 78 |    statement.execute( sql, new int[] { 1, 2 } );
  79 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  80 |   } catch (java.sql.SQLException e) {
  81 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  82 |           response.getWriter().println(
  83 | ""Error processing request.""
  84 | );
  85 |           return;
  86 |          }
  87 |    else throw new ServletException(e);
  88 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00518.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00518.java,"
  50 |
  51 |
  52 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  53 |   String bar = thing.doSomething(param);
  54 |
  55 |
  56 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  57 |
  58 |   try {
  59 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 60 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00590.java,76,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00590.java,"
  66 |      bar = param;
  67 |   else bar = ""This should never happen"";
  68 |
  69 |
  70 |   String sql = ""{call "" + bar + ""}"";
  71 |
  72 |   try {
  73 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  74 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  75 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 76 |    java.sql.ResultSet rs = statement.executeQuery();
  77 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  78 |         } catch (java.sql.SQLException e) {
  79 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  80 |           response.getWriter().println(
  81 | ""Error processing request.""
  82 | );
  83 |           return;
  84 |          }
  85 |    else throw new ServletException(e);
  86 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00591.java,72,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00591.java,"
  62 |   String bar = thing.doSomething(param);
  63 |
  64 |
  65 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  66 |
  67 |   try {
  68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  69 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  70 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  71 |        statement.setString(1, ""foo"");
> 72 |    statement.execute();
  73 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  74 |   } catch (java.sql.SQLException e) {
  75 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  76 |           response.getWriter().println(
  77 | ""Error processing request.""
  78 | );
  79 |           return;
  80 |          }
  81 |    else throw new ServletException(e);
  82 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00593.java,91,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00593.java,"
   81 |
   82 |
   83 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   84 |
   85 |   try {
   86 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   87 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
   88 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
   89 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
   90 |     statement.setString(1, ""foo"");
>  91 |    statement.execute();
   92 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   93 |   } catch (java.sql.SQLException e) {
   94 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   95 |           response.getWriter().println(
   96 | ""Error processing request.""
   97 | );
   98 |           return;
   99 |          }
  100 |    else throw new ServletException(e);
  101 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00594.java,75,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00594.java,"
  65 |   map29056.put(""keyC"", ""another-Value""); // put some stuff in the collection
  66 |   bar = (String)map29056.get(""keyB-29056""); // get it back out
  67 |
  68 |
  69 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  70 |
  71 |   try {
  72 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  73 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  74 |    statement.setString(1, ""foo"");
> 75 |    statement.execute();
  76 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  77 |   } catch (java.sql.SQLException e) {
  78 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  79 |           response.getWriter().println(
  80 | ""Error processing request.""
  81 | );
  82 |           return;
  83 |          }
  84 |    else throw new ServletException(e);
  85 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00595.java,76,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00595.java,"
  66 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  67 |
  68 |
  69 |
  70 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  71 |
  72 |   try {
  73 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  74 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  75 |    statement.setString(1, ""foo"");
> 76 |    statement.execute();
  77 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  78 |   } catch (java.sql.SQLException e) {
  79 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  80 |           response.getWriter().println(
  81 | ""Error processing request.""
  82 | );
  83 |           return;
  84 |          }
  85 |    else throw new ServletException(e);
  86 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00596.java,76,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00596.java,"
   66 | e"" );
   67 |
   68 |  remove the 1st safe value
   69 |
   70 |  // get the param value
   71 |
   72 |
   73 |
   74 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   75 |
>  76 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   77 | ntln(
   78 | ""
   79 |
   80 |
   81 | ur results are"");
   82 |
   83 |
   84 | intln(
   85 | encoder().encodeForHTML(o.toString()) + ""<br>""
   86 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00597.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00597.java,"
  57 |
  58 |
  59 |
  60 |
  61 | rs.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  62 | thing(param);
  63 |
  64 |
  65 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  66 |
> 67 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
  68 | ntln(
  69 | ""
  70 |
  71 |
  72 | ur results are"");
  73 |
  74 |
  75 | intln(
  76 | encoder().encodeForHTML(o.toString()) + ""<br>""
  77 |
     ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00598.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00598.java,"
  60 |
  61 |
  62 |  {
  63 |  org.apache.commons.codec.binary.Base64.decodeBase64(
  64 | s.codec.binary.Base64.encodeBase64( param.getBytes() ) ));
  65 |
  66 |
  67 |
  68 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  69 |
> 70 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  71 | r().println(
  72 | e: ""
  73 |
  74 |
  75 | tln(""Your results are"");
  76 | r().println(
  77 | ESAPI.encoder().encodeForHTML(results.toString())
  78 |
  79 | tln(results.toString());
  80 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00600.java,86,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00600.java,"
   76 |           break;
   77 |     default:
   78 |           bar = ""bobs_your_uncle"";
   79 |           break;
   80 |   }
   81 |
   82 |
   83 |   try {
   84 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   85 |
>  86 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
   87 |    response.getWriter().println(
   88 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   89 |     + "" because the Spring batchUpdate method doesn't return results.""
   90 |    );
   91 |   } catch (org.springframework.dao.DataAccessException e) {
   92 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   93 |           response.getWriter().println(
   94 |      ""Error processing request.""
   95 |     );
   96 |          }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00603.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00603.java,"
  59 |
  60 |
  61 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  62 |   String bar = thing.doSomething(param);
  63 |
  64 |
  65 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00604.java,72,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00604.java,"
  62 |   if (param != null) {
  63 |    bar = new String( org.apache.commons.codec.binary.Base64.decodeBase64(
  64 |    org.apache.commons.codec.binary.Base64.encodeBase64( param.getBytes() ) ));
  65 |   }
  66 |
  67 |
  68 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  69 |
  70 |   try {
  71 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 72 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  73 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  74 |   } catch (java.sql.SQLException e) {
  75 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  76 |           response.getWriter().println(
  77 | ""Error processing request.""
  78 | );
  79 |           return;
  80 |          }
  81 |    else throw new ServletException(e);
  82 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00606.java,74,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00606.java,"
  64 |   int num = 196;
  65 |   if ( (500/42) + num > 200 )
  66 |      bar = param;
  67 |   else bar = ""This should never happen"";
  68 |
  69 |
  70 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  71 |
  72 |   try {
  73 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 74 |    int count = statement.executeUpdate( sql );
  75 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  76 |   } catch (java.sql.SQLException e) {
  77 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  78 |           response.getWriter().println(
  79 | ""Error processing request.""
  80 | );
  81 |           return;
  82 |          }
  83 |    else throw new ServletException(e);
  84 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00673.java,63,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00673.java,"
  53 |      bar = param;
  54 |   else bar = ""This should never happen"";
  55 |
  56 |
  57 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  58 |
  59 |   try {
  60 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  61 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql );
  62 |    statement.setString(1, ""foo"");
> 63 |    statement.execute();
  64 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  65 |   } catch (java.sql.SQLException e) {
  66 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  67 |           response.getWriter().println(
  68 | ""Error processing request.""
  69 | );
  70 |           return;
  71 |          }
  72 |    else throw new ServletException(e);
  73 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00677.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00677.java,"
  47 |
  48 | g bar = """";
  49 | aram != null) {
  50 | = new String( org.apache.commons.codec.binary.Base64.decodeBase64(
  51 | apache.commons.codec.binary.Base64.encodeBase64( param.getBytes() ) ));
  52 |
  53 |
  54 |
  55 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  56 | {
> 57 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
  58 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
  59 |           try {
  60 |            return rs.getString(""USERNAME"");
  61 |           } catch (java.sql.SQLException e) {
  62 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |       return ""Error processing query."";
  64 |      }
  65 | lse throw e;
  66 |
  67 |       }
     ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00678.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00678.java,"
  50 |   // Simple if statement that assigns param to bar on true condition
  51 |   int num = 196;
  52 |   if ( (500/42) + num > 200 )
  53 |      bar = param;
  54 |   else bar = ""This should never happen"";
  55 |
  56 |
  57 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  58 |   try {
  59 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 60 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  61 |    response.getWriter().println(
  62 |     ""Your results are: ""
  63 |    );
  64 |
  65 |  //  System.out.println(""your results are"");
  66 |    response.getWriter().println(
  67 |     results.toString()
  68 |    );
  69 |  //  System.out.println(results);
  70 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00679.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00679.java,"
  44 | .getTheParameter(""BenchmarkTest00679"");
  45 |  param = """";
  46 |
  47 |
  48 | k.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  49 | .doSomething(param);
  50 |
  51 |
  52 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  53 |
> 54 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  55 | r().println(
  56 | e: ""
  57 |
  58 |
  59 | tln(""Your results are"");
  60 | r().println(
  61 | ESAPI.encoder().encodeForHTML(results.toString())
  62 |
  63 | tln(results.toString());
  64 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00681.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00681.java,"
  45 |   if (param == null) param = """";
  46 |
  47 |
  48 |   String bar = param;
  49 |
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00760.java,63,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00760.java,"
  53 |  map18915.put(""keyB-18915"", param); // put it in a collection
  54 |  map18915.put(""keyC"", ""another-Value""); // put some stuff in the collection
  55 |  bar = (String)map18915.get(""keyB-18915""); // get it back out
  56 |
  57 |
  58 |  String sql = ""{call "" + bar + ""}"";
  59 |
  60 |  try {
  61 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  62 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 63 |      java.sql.ResultSet rs = statement.executeQuery();
  64 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  65 |
  66 |  } catch (java.sql.SQLException e) {
  67 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  68 |          response.getWriter().println(
  69 | Error processing request.""
  70 | ;
  71 |          return;
  72 |         }
  73 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00761.java,77,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00761.java,"
  67 |          bar = ""bobs_your_uncle"";
  68 |          break;
  69 |  }
  70 |
  71 |
  72 |  String sql = ""{call "" + bar + ""}"";
  73 |
  74 |  try {
  75 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  76 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 77 |      java.sql.ResultSet rs = statement.executeQuery();
  78 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  79 |
  80 |  } catch (java.sql.SQLException e) {
  81 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  82 |          response.getWriter().println(
  83 | Error processing request.""
  84 | ;
  85 |          return;
  86 |         }
  87 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00762.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00762.java,"
  55 |      bar = param;
  56 |   else bar = ""This should never happen"";
  57 |
  58 |
  59 |   String sql = ""{call "" + bar + ""}"";
  60 |
  61 |   try {
  62 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  63 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  64 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 65 |    java.sql.ResultSet rs = statement.executeQuery();
  66 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  67 |         } catch (java.sql.SQLException e) {
  68 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  69 |           response.getWriter().println(
  70 | ""Error processing request.""
  71 | );
  72 |           return;
  73 |          }
  74 |    else throw new ServletException(e);
  75 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00764.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00764.java,"
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |
  50 |   String bar = param;
  51 |
  52 |
  53 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  54 |   try {
  55 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 56 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  57 |    response.getWriter().println(
  58 |     ""Your results are: ""
  59 |    );
  60 |
  61 |  //  System.out.println(""your results are"");
  62 |    response.getWriter().println(
  63 |     results.toString()
  64 |    );
  65 |  //  System.out.println(results);
  66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00765.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00765.java,"
  47 |   else param = """";
  48 |
  49 |
  50 |   org.owasp.benchmark.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  51 |   String bar = thing.doSomething(param);
  52 |
  53 |
  54 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  55 |   try {
  56 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 57 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  58 |    response.getWriter().println(
  59 |     ""Your results are: ""
  60 |    );
  61 |
  62 |  //  System.out.println(""your results are"");
  63 |    response.getWriter().println(
  64 |     results.toString()
  65 |    );
  66 |  //  System.out.println(results);
  67 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00767.java,75,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00767.java,"
  65 |           break;
  66 |     default:
  67 |           bar = ""bobs_your_uncle"";
  68 |           break;
  69 |   }
  70 |
  71 |
  72 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  73 |   try {
  74 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 75 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  76 |    response.getWriter().println(
  77 |     ""Your results are: ""
  78 |    );
  79 |
  80 |  //  System.out.println(""your results are"");
  81 |    response.getWriter().println(
  82 |     results.toString()
  83 |    );
  84 |  //  System.out.println(results);
  85 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00768.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00768.java,"
  46 | ];
  47 |
  48 |
  49 |
  50 | k.helpers.ThingInterface thing = org.owasp.benchmark.helpers.ThingFactory.createThing();
  51 | .doSomething(param);
  52 |
  53 |
  54 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  55 |
> 56 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  57 | r().println(
  58 | e: ""
  59 |
  60 |
  61 | tln(""Your results are"");
  62 | r().println(
  63 | ESAPI.encoder().encodeForHTML(results.toString())
  64 |
  65 | tln(results.toString());
  66 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00769.java,61,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00769.java,"
  51 |   java.util.HashMap<String,Object> map29572 = new java.util.HashMap<String,Object>();
  52 |   map29572.put(""keyA-29572"", ""a-Value""); // put some stuff in the collection
  53 |   map29572.put(""keyB-29572"", param); // put it in a collection
  54 |   map29572.put(""keyC"", ""another-Value""); // put some stuff in the collection
  55 |   bar = (String)map29572.get(""keyB-29572""); // get it back out
  56 |
  57 |
  58 |   try {
  59 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  60 |
> 61 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  62 |    response.getWriter().println(
  63 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  64 |     + "" because the Spring batchUpdate method doesn't return results.""
  65 |    );
  66 |   } catch (org.springframework.dao.DataAccessException e) {
  67 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  68 |           response.getWriter().println(
  69 |      ""Error processing request.""
  70 |     );
  71 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00770.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00770.java,"
  57 |    valuesList.remove(0); // remove the 1st safe value
  58 |
  59 |    bar = valuesList.get(0); // get the param value
  60 |   }
  61 |
  62 |
  63 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  64 |
  65 |   try {
  66 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 67 |    statement.addBatch( sql );
  68 |    int[] counts = statement.executeBatch();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00771.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00771.java,"
  52 |   map49960.put(""keyA-49960"", ""a-Value""); // put some stuff in the collection
  53 |   map49960.put(""keyB-49960"", param); // put it in a collection
  54 |   map49960.put(""keyC"", ""another-Value""); // put some stuff in the collection
  55 |   bar = (String)map49960.get(""keyB-49960""); // get it back out
  56 |
  57 |
  58 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  59 |
  60 |   try {
  61 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 62 |    statement.execute( sql );
  63 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  64 |   } catch (java.sql.SQLException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 | ""Error processing request.""
  68 | );
  69 |           return;
  70 |          }
  71 |    else throw new ServletException(e);
  72 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00839.java,76,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00839.java,"
  66 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  67 |
  68 |
  69 |
  70 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  71 |
  72 |   try {
  73 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  74 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  75 |    statement.setString(1, ""foo"");
> 76 |    statement.execute();
  77 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  78 |   } catch (java.sql.SQLException e) {
  79 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  80 |           response.getWriter().println(
  81 | ""Error processing request.""
  82 | );
  83 |           return;
  84 |          }
  85 |    else throw new ServletException(e);
  86 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00840.java,73,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00840.java,"
  63 |   // Simple ? condition that assigns param to bar on false condition
  64 |   int num = 106;
  65 |
  66 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  67 |
  68 |
  69 |
  70 |   try {
  71 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  72 |
> 73 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  74 |    response.getWriter().println(
  75 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  76 |     + "" because the Spring batchUpdate method doesn't return results.""
  77 |    );
  78 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  79 |   } catch (org.springframework.dao.DataAccessException e) {
  80 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  81 |           response.getWriter().println(
  82 |      ""Error processing request.""
  83 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00841.java,86,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00841.java,"
   76 |           break;
   77 |     default:
   78 |           bar = ""bobs_your_uncle"";
   79 |           break;
   80 |   }
   81 |
   82 |
   83 |   try {
   84 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   85 |
>  86 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
   87 |    response.getWriter().println(
   88 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   89 |     + "" because the Spring batchUpdate method doesn't return results.""
   90 |    );
   91 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
   92 |   } catch (org.springframework.dao.DataAccessException e) {
   93 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   94 |           response.getWriter().println(
   95 |      ""Error processing request.""
   96 |     );
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00842.java,77,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00842.java,"
   67 |
   68 |    valuesList.remove(0); // remove the 1st safe value
   69 |
   70 |    bar = valuesList.get(0); // get the param value
   71 |   }
   72 |
   73 |
   74 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
   75 |   try {
   76 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
>  77 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
   78 |    response.getWriter().println(
   79 |     ""Your results are: ""
   80 |    );
   81 |
   82 |  //  System.out.println(""Your results are: "");
   83 |    response.getWriter().println(
   84 |     results.toString()
   85 |    );
   86 |  //  System.out.println(results);
   87 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00843.java,72,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00843.java,"
  62 |   java.util.HashMap<String,Object> map12983 = new java.util.HashMap<String,Object>();
  63 |   map12983.put(""keyA-12983"", ""a-Value""); // put some stuff in the collection
  64 |   map12983.put(""keyB-12983"", param); // put it in a collection
  65 |   map12983.put(""keyC"", ""another-Value""); // put some stuff in the collection
  66 |   bar = (String)map12983.get(""keyB-12983""); // get it back out
  67 |
  68 |
  69 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  70 |   try {
  71 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 72 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  73 |    response.getWriter().println(
  74 |     ""Your results are: ""
  75 |    );
  76 |
  77 |  //  System.out.println(""your results are"");
  78 |    response.getWriter().println(
  79 |     results.toString()
  80 |    );
  81 |  //  System.out.println(results);
  82 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00845.java,73,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00845.java,"
  63 |   // Simple ? condition that assigns param to bar on false condition
  64 |   int num = 106;
  65 |
  66 |   bar = (7*42) - num > 200 ? ""This should never happen"" : param;
  67 |
  68 |
  69 |
  70 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
  71 |   try {
  72 |          org.springframework.jdbc.support.rowset.SqlRowSet results
> 73 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
  74 |          response.getWriter().println(
  75 |     ""Your results are: ""
  76 |    );
  77 |
  78 |  //  System.out.println(""Your results are"");
  79 |    while (results.next()) {
  80 |     response.getWriter().println(
  81 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
  82 |     );
  83 |  //   System.out.println(results.getString(""USERNAME""));
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00846.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00846.java,"
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |
  61 |   String bar = param;
  62 |
  63 |
  64 |   try {
  65 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  66 |
> 67 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  68 |    response.getWriter().println(
  69 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  70 |     + "" because the Spring batchUpdate method doesn't return results.""
  71 |    );
  72 |   } catch (org.springframework.dao.DataAccessException e) {
  73 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  74 |           response.getWriter().println(
  75 |      ""Error processing request.""
  76 |     );
  77 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00847.java,78,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00847.java,"
  68 |    valuesList.remove(0); // remove the 1st safe value
  69 |
  70 |    bar = valuesList.get(0); // get the param value
  71 |   }
  72 |
  73 |
  74 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  75 |
  76 |   try {
  77 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 78 |    statement.addBatch( sql );
  79 |    int[] counts = statement.executeBatch();
  80 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  81 |   } catch (java.sql.SQLException e) {
  82 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  83 |           response.getWriter().println(
  84 | ""Error processing request.""
  85 | );
  86 |           return;
  87 |          }
  88 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00848.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00848.java,"
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |
  61 |   String bar = param;
  62 |
  63 |
  64 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  65 |
  66 |   try {
  67 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 68 |    statement.addBatch( sql );
  69 |    int[] counts = statement.executeBatch();
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00849.java,78,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00849.java,"
  68 |    valuesList.remove(0); // remove the 1st safe value
  69 |
  70 |    bar = valuesList.get(0); // get the param value
  71 |   }
  72 |
  73 |
  74 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  75 |
  76 |   try {
  77 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 78 |    statement.execute( sql, new int[] { 1, 2 } );
  79 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  80 |   } catch (java.sql.SQLException e) {
  81 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  82 |           response.getWriter().println(
  83 | ""Error processing request.""
  84 | );
  85 |           return;
  86 |          }
  87 |    else throw new ServletException(e);
  88 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00850.java,78,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00850.java,"
  68 |    valuesList.remove(0); // remove the 1st safe value
  69 |
  70 |    bar = valuesList.get(0); // get the param value
  71 |   }
  72 |
  73 |
  74 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  75 |
  76 |   try {
  77 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 78 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  79 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  80 |   } catch (java.sql.SQLException e) {
  81 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  82 |           response.getWriter().println(
  83 | ""Error processing request.""
  84 | );
  85 |           return;
  86 |          }
  87 |    else throw new ServletException(e);
  88 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00996.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00996.java,"
  60 |   }
  61 |  }
  62 |
  63 |  String bar = new Test().doSomething(request, param);
  64 |
  65 |  String sql = ""{call "" + bar + ""}"";
  66 |
  67 |  try {
  68 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  69 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 70 |      java.sql.ResultSet rs = statement.executeQuery();
  71 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  72 |
  73 |  } catch (java.sql.SQLException e) {
  74 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  75 |          response.getWriter().println(
  76 | Error processing request.""
  77 | ;
  78 |          return;
  79 |         }
  80 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00997.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00997.java,"
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""{call "" + bar + ""}"";
   66 |
   67 |   try {
   68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   69 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
   70 |        java.sql.ResultSet.CONCUR_READ_ONLY );
>  71 |    java.sql.ResultSet rs = statement.executeQuery();
   72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
   73 |   } catch (java.sql.SQLException e) {
   74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   75 |           response.getWriter().println(
   76 | ""Error processing request.""
   77 | );
   78 |           return;
   79 |          }
   80 |    else throw new ServletException(e);
   81 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00998.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00998.java,"
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""{call "" + bar + ""}"";
   66 |
   67 |   try {
   68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   69 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
   70 |        java.sql.ResultSet.CONCUR_READ_ONLY );
>  71 |    java.sql.ResultSet rs = statement.executeQuery();
   72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
   73 |   } catch (java.sql.SQLException e) {
   74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   75 |           response.getWriter().println(
   76 | ""Error processing request.""
   77 | );
   78 |           return;
   79 |          }
   80 |    else throw new ServletException(e);
   81 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01000.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01000.java,"
  61 |   }
  62 |
  63 |   String bar = new Test().doSomething(request, param);
  64 |
  65 |   String sql = ""{call "" + bar + ""}"";
  66 |
  67 |   try {
  68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  69 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  70 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 71 |    java.sql.ResultSet rs = statement.executeQuery();
  72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  73 |         } catch (java.sql.SQLException e) {
  74 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  75 |           response.getWriter().println(
  76 | ""Error processing request.""
  77 | );
  78 |           return;
  79 |          }
  80 |    else throw new ServletException(e);
  81 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01002.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01002.java,"
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   66 |
   67 |   try {
   68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   69 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new int[] { 1, 2 } );
   70 |    statement.setString(1, ""foo"");
>  71 |    statement.execute();
   72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   73 |   } catch (java.sql.SQLException e) {
   74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   75 |           response.getWriter().println(
   76 | ""Error processing request.""
   77 | );
   78 |           return;
   79 |          }
   80 |    else throw new ServletException(e);
   81 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01003.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01003.java,"
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   66 |
   67 |   try {
   68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   69 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
   70 |    statement.setString(1, ""foo"");
>  71 |    statement.execute();
   72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   73 |   } catch (java.sql.SQLException e) {
   74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   75 |           response.getWriter().println(
   76 | ""Error processing request.""
   77 | );
   78 |           return;
   79 |          }
   80 |    else throw new ServletException(e);
   81 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01004.java,71,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01004.java,"
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   66 |
   67 |   try {
   68 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   69 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
   70 |    statement.setString(1, ""foo"");
>  71 |    statement.execute();
   72 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   73 |   } catch (java.sql.SQLException e) {
   74 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   75 |           response.getWriter().println(
   76 | ""Error processing request.""
   77 | );
   78 |           return;
   79 |          }
   80 |    else throw new ServletException(e);
   81 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01005.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01005.java,"
   58 |      break;
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   try {
   66 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   67 |
>  68 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
   69 |    response.getWriter().println(
   70 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   71 |     + "" because the Spring batchUpdate method doesn't return results.""
   72 |    );
   73 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
   74 |   } catch (org.springframework.dao.DataAccessException e) {
   75 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   76 |           response.getWriter().println(
   77 |      ""Error processing request.""
   78 |     );
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01006.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01006.java,"
   58 |      break;
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   66 |   try {
   67 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
>  68 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
   69 |    response.getWriter().println(
   70 |     ""Your results are: ""
   71 |    );
   72 |
   73 |  //  System.out.println(""your results are"");
   74 |    response.getWriter().println(
   75 |     results.toString()
   76 |    );
   77 |  //  System.out.println(results);
   78 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01007.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01007.java,"
   57 | t.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
   58 |
   59 |
   60 |
   61 |
   62 |
   63 | est().doSomething(request, param);
   64 |
   65 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   66 |
>  67 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
   68 | r().println(
   69 | e: ""
   70 |
   71 |
   72 | tln(""Your results are"");
   73 | r().println(
   74 | ESAPI.encoder().encodeForHTML(results.toString())
   75 |
   76 | tln(results.toString());
   77 | gframework.dao.EmptyResultDataAccessException e) {
      ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01008.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01008.java,"
   58 |      break;
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   66 |   try {
   67 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  68 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   69 |          response.getWriter().println(
   70 |     ""Your results are: ""
   71 |    );
   72 |
   73 |  //  System.out.println(""Your results are"");
   74 |    while (results.next()) {
   75 |     response.getWriter().println(
   76 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   77 |     );
   78 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01009.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01009.java,"
   58 |      break;
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   66 |   try {
   67 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  68 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   69 |          response.getWriter().println(
   70 |     ""Your results are: ""
   71 |    );
   72 |
   73 |  //  System.out.println(""Your results are"");
   74 |    while (results.next()) {
   75 |     response.getWriter().println(
   76 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   77 |     );
   78 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01011.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01011.java,"
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = new Test().doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
   66 |
   67 |   try {
   68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  69 |    statement.addBatch( sql );
   70 |    int[] counts = statement.executeBatch();
   71 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
   72 |   } catch (java.sql.SQLException e) {
   73 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   74 |           response.getWriter().println(
   75 | ""Error processing request.""
   76 | );
   77 |           return;
   78 |          }
   79 |    else throw new ServletException(e);
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01083.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01083.java,"
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  58 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  59 |     statement.setString(1, ""foo"");
> 60 |    statement.execute();
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01084.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01084.java,"
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  58 |    statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01087.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01087.java,"
  46 |   }
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
  54 |   try {
  55 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
> 56 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
  57 |    response.getWriter().println(
  58 |     ""Your results are: ""
  59 |    );
  60 |
  61 |  //  System.out.println(""Your results are: "");
  62 |    response.getWriter().println(
  63 |     results.toString()
  64 |    );
  65 |  //  System.out.println(results);
  66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01088.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01088.java,"
  46 |   }
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  54 |   try {
  55 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 56 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  57 |    response.getWriter().println(
  58 |     ""Your results are: ""
  59 |    );
  60 |
  61 |  //  System.out.println(""your results are"");
  62 |    response.getWriter().println(
  63 |     results.toString()
  64 |    );
  65 |  //  System.out.println(results);
  66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01090.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01090.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.addBatch( sql );
  58 |    int[] counts = statement.executeBatch();
  59 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  60 |   } catch (java.sql.SQLException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 | ""Error processing request.""
  64 | );
  65 |           return;
  66 |          }
  67 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01091.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01091.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01093.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01093.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql, new int[] { 1, 2 } );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01094.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01094.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01097.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01097.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01208.java,61,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01208.java,"
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""{call "" + bar + ""}"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  60 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 61 |    java.sql.ResultSet rs = statement.executeQuery();
  62 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  63 |         } catch (java.sql.SQLException e) {
  64 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  65 |           response.getWriter().println(
  66 | ""Error processing request.""
  67 | );
  68 |           return;
  69 |          }
  70 |    else throw new ServletException(e);
  71 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01209.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01209.java,"
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  60 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  61 |        statement.setString(1, ""foo"");
> 62 |    statement.execute();
  63 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  64 |   } catch (java.sql.SQLException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 | ""Error processing request.""
  68 | );
  69 |           return;
  70 |          }
  71 |    else throw new ServletException(e);
  72 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01210.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01210.java,"
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  60 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  61 |     statement.setString(1, ""foo"");
> 62 |    statement.execute();
  63 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  64 |   } catch (java.sql.SQLException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 | ""Error processing request.""
  68 | );
  69 |           return;
  70 |          }
  71 |    else throw new ServletException(e);
  72 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01211.java,63,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01211.java,"
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  60 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  61 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  62 |     statement.setString(1, ""foo"");
> 63 |    statement.execute();
  64 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  65 |   } catch (java.sql.SQLException e) {
  66 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  67 |           response.getWriter().println(
  68 | ""Error processing request.""
  69 | );
  70 |           return;
  71 |          }
  72 |    else throw new ServletException(e);
  73 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01214.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01214.java,"
  48 |   }
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   try {
  56 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  57 |
> 58 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  59 |    response.getWriter().println(
  60 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  61 |     + "" because the Spring batchUpdate method doesn't return results.""
  62 |    );
  63 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  64 |   } catch (org.springframework.dao.DataAccessException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 |      ""Error processing request.""
  68 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01221.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01221.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01222.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01222.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = new Test().doSomething(request, param);
  54 |
  55 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01302.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01302.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""{call "" + bar + ""}"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  53 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 54 |    java.sql.ResultSet rs = statement.executeQuery();
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  56 |         } catch (java.sql.SQLException e) {
  57 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01304.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01304.java,"
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  53 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  54 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  55 |     statement.setString(1, ""foo"");
> 56 |    statement.execute();
  57 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  58 |   } catch (java.sql.SQLException e) {
  59 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  60 |           response.getWriter().println(
  61 | ""Error processing request.""
  62 | );
  63 |           return;
  64 |          }
  65 |    else throw new ServletException(e);
  66 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01306.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01306.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  53 |    statement.setString(1, ""foo"");
> 54 |    statement.execute();
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  56 |   } catch (java.sql.SQLException e) {
  57 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01308.java,51,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01308.java,"
  41 |   response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest01308"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  49 |   try {
  50 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 51 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  52 |    response.getWriter().println(
  53 |     ""Your results are: ""
  54 |    );
  55 |
  56 |  //  System.out.println(""your results are"");
  57 |    response.getWriter().println(
  58 |     results.toString()
  59 |    );
  60 |  //  System.out.println(results);
  61 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01311.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01311.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest01311"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    statement.execute( sql );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01312.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01312.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest01312"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01313.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01313.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest01313"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    int count = statement.executeUpdate( sql );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01314.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01314.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest01314"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = new Test().doSomething(request, param);
  47 |
  48 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    int count = statement.executeUpdate( sql );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01379.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01379.java,"
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""{call "" + bar + ""}"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  58 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 59 |    java.sql.ResultSet rs = statement.executeQuery();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  61 |         } catch (java.sql.SQLException e) {
  62 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01381.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01381.java,"
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  58 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  59 |        statement.setString(1, ""foo"");
> 60 |    statement.execute();
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01382.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01382.java,"
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  58 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  59 |        statement.setString(1, ""foo"");
> 60 |    statement.execute();
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01383.java,60,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01383.java,"
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  58 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  59 |     statement.setString(1, ""foo"");
> 60 |    statement.execute();
  61 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  62 |   } catch (java.sql.SQLException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 | ""Error processing request.""
  66 | );
  67 |           return;
  68 |          }
  69 |    else throw new ServletException(e);
  70 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01384.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01384.java,"
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new int[] { 1, 2 } );
  58 |    statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01388.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01388.java,"
   46 |    String[] values = map.get(""BenchmarkTest01388"");
   47 |    if (values != null) param = values[0];
   48 |   }
   49 |
   50 |
   51 |   String bar = new Test().doSomething(request, param);
   52 |
   53 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
   54 |   try {
   55 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
>  56 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
   57 |    response.getWriter().println(
   58 |     ""Your results are: ""
   59 |    );
   60 |
   61 |  //  System.out.println(""Your results are: "");
   62 |    response.getWriter().println(
   63 |     results.toString()
   64 |    );
   65 |  //  System.out.println(results);
   66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01390.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01390.java,"
  46 |    String[] values = map.get(""BenchmarkTest01390"");
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  54 |   try {
  55 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 56 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  57 |    response.getWriter().println(
  58 |     ""Your results are: ""
  59 |    );
  60 |
  61 |  //  System.out.println(""your results are"");
  62 |    response.getWriter().println(
  63 |     results.toString()
  64 |    );
  65 |  //  System.out.println(results);
  66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01391.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01391.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01394.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01394.java,"
   47 |    if (values != null) param = values[0];
   48 |   }
   49 |
   50 |
   51 |   String bar = new Test().doSomething(request, param);
   52 |
   53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
   54 |
   55 |   try {
   56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  57 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
   58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
   59 |   } catch (java.sql.SQLException e) {
   60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   61 |           response.getWriter().println(
   62 | ""Error processing request.""
   63 | );
   64 |           return;
   65 |          }
   66 |    else throw new ServletException(e);
   67 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01395.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01395.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01396.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01396.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = new Test().doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01460.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01460.java,"
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01462.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01462.java,"
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |         } catch (java.sql.SQLException e) {
  71 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01463.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01463.java,"
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |         } catch (java.sql.SQLException e) {
  71 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01464.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01464.java,"
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
   67 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
   68 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
   69 |     statement.setString(1, ""foo"");
>  70 |    statement.execute();
   71 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   72 |   } catch (java.sql.SQLException e) {
   73 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   74 |           response.getWriter().println(
   75 | ""Error processing request.""
   76 | );
   77 |           return;
   78 |          }
   79 |    else throw new ServletException(e);
   80 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01465.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01465.java,"
   55 |      }
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |    try {
   63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   64 |
>  65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
   66 |    response.getWriter().println(
   67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   68 |     + "" because the Spring execute method doesn't return results.""
   69 |    );
   70 |
   71 |   } catch (org.springframework.dao.DataAccessException e) {
   72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   73 |           response.getWriter().println(
   74 |      ""Error processing request.""
   75 |     );
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01466.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01466.java,"
   54 |   flag = false;
   55 |
   56 |
   57 |
   58 |
   59 |
   60 | g bar = new Test().doSomething(request, param);
   61 |
   62 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 | {
>  64 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   65 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   66 |           try {
   67 |            return rs.getString(""USERNAME"");
   68 |           } catch (java.sql.SQLException e) {
   69 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |       return ""Error processing query."";
   71 |      }
   72 | lse throw e;
   73 |
   74 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01470.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01470.java,"
  54 | e;
  55 |
  56 |
  57 |
  58 |
  59 |
  60 | est().doSomething(request, param);
  61 |
  62 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  63 |
> 64 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  65 | r().println(
  66 | e: ""
  67 |
  68 |
  69 | tln(""Your results are"");
  70 | r().println(
  71 | ESAPI.encoder().encodeForHTML(results.toString())
  72 |
  73 | tln(results.toString());
  74 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01471.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01471.java,"
   55 |      }
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   try {
   63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   64 |
>  65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
   66 |    response.getWriter().println(
   67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   68 |     + "" because the Spring batchUpdate method doesn't return results.""
   69 |    );
   70 |   } catch (org.springframework.dao.DataAccessException e) {
   71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   72 |           response.getWriter().println(
   73 |      ""Error processing request.""
   74 |     );
   75 |          }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01473.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01473.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.execute( sql, new int[] { 1, 2 } );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01474.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01474.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01475.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01475.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01476.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01476.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01477.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01477.java,"
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
   63 |
   64 |   try {
   65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  66 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
   67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
   68 |   } catch (java.sql.SQLException e) {
   69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |           response.getWriter().println(
   71 | ""Error processing request.""
   72 | );
   73 |           return;
   74 |          }
   75 |    else throw new ServletException(e);
   76 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01552.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01552.java,"
  47 |   String bar = new Test().doSomething(request, param);
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  53 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  54 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  55 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  56 |     statement.setString(1, ""foo"");
> 57 |    statement.execute();
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01554.java,51,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01554.java,"
   41 | text/html;charset=UTF-8"");
   42 |
   43 | rs.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
   44 | Parameter(""BenchmarkTest01554"");
   45 | = """";
   46 |
   47 | oSomething(request, param);
   48 |
   49 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   50 |
>  51 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   52 | ntln(
   53 | ""
   54 |
   55 |
   56 | ur results are"");
   57 |
   58 |
   59 | intln(
   60 | encoder().encodeForHTML(o.toString()) + ""<br>""
   61 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01557.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01557.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest01557"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = new Test().doSomething(request, param);
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01558.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01558.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest01558"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = new Test().doSomething(request, param);
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01559.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01559.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest01559"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = new Test().doSomething(request, param);
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    statement.execute( sql, new int[] { 1, 2 } );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01560.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01560.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest01560"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = new Test().doSomething(request, param);
  48 |
  49 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01620.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01620.java,"
   46 |    param = values[0];
   47 |  else param = """";
   48 |
   49 |  String bar = new Test().doSomething(request, param);
   50 |
   51 |  String sql = ""{call "" + bar + ""}"";
   52 |
   53 |  try {
   54 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   55 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
>  56 |      java.sql.ResultSet rs = statement.executeQuery();
   57 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
   58 |
   59 |  } catch (java.sql.SQLException e) {
   60 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   61 |          response.getWriter().println(
   62 | Error processing request.""
   63 | ;
   64 |          return;
   65 |         }
   66 |   else throw new ServletException(e);
      ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01621.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01621.java,"
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""{call "" + bar + ""}"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  56 |        java.sql.ResultSet.CONCUR_READ_ONLY );
> 57 |    java.sql.ResultSet rs = statement.executeQuery();
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01623.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01623.java,"
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""{call "" + bar + ""}"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  56 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 57 |    java.sql.ResultSet rs = statement.executeQuery();
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  59 |         } catch (java.sql.SQLException e) {
  60 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01624.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01624.java,"
  44 |   String param;
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   try {
  52 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  53 |
> 54 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  55 |    response.getWriter().println(
  56 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  57 |     + "" because the Spring batchUpdate method doesn't return results.""
  58 |    );
  59 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  60 |   } catch (org.springframework.dao.DataAccessException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 |      ""Error processing request.""
  64 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01625.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01625.java,"
  44 |   String param;
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  52 |   try {
  53 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 54 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  55 |    response.getWriter().println(
  56 |     ""Your results are: ""
  57 |    );
  58 |
  59 |  //  System.out.println(""your results are"");
  60 |    response.getWriter().println(
  61 |     results.toString()
  62 |    );
  63 |  //  System.out.println(results);
  64 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01626.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01626.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    statement.addBatch( sql );
  56 |    int[] counts = statement.executeBatch();
  57 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  58 |   } catch (java.sql.SQLException e) {
  59 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  60 |           response.getWriter().println(
  61 | ""Error processing request.""
  62 | );
  63 |           return;
  64 |          }
  65 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01627.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01627.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01630.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01630.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01631.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01631.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = new Test().doSomething(request, param);
  50 |
  51 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01712.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01712.java,"
  57 |  }
  58 |  param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |  String bar = new Test().doSomething(request, param);
  61 |
  62 |  String sql = ""{call "" + bar + ""}"";
  63 |
  64 |  try {
  65 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 67 |      java.sql.ResultSet rs = statement.executeQuery();
  68 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  69 |
  70 |  } catch (java.sql.SQLException e) {
  71 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |          response.getWriter().println(
  73 | Error processing request.""
  74 | ;
  75 |          return;
  76 |         }
  77 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01715.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01715.java,"
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  67 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  68 |     statement.setString(1, ""foo"");
> 69 |    statement.execute();
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01716.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01716.java,"
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  67 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  68 |     statement.setString(1, ""foo"");
> 69 |    statement.execute();
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01718.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01718.java,"
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
   67 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
   68 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
   69 |     statement.setString(1, ""foo"");
>  70 |    statement.execute();
   71 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   72 |   } catch (java.sql.SQLException e) {
   73 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   74 |           response.getWriter().println(
   75 | ""Error processing request.""
   76 | );
   77 |           return;
   78 |          }
   79 |    else throw new ServletException(e);
   80 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01720.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01720.java,"
  55 |   if (ampersandLoc != -1) {
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |    try {
  63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  64 |
> 65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  66 |    response.getWriter().println(
  67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  68 |     + "" because the Spring execute method doesn't return results.""
  69 |    );
  70 |
  71 |   } catch (org.springframework.dao.DataAccessException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 |      ""Error processing request.""
  75 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01721.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01721.java,"
   54 | mpersandLoc = queryString.indexOf(""&"", paramLoc);
   55 | mpersandLoc != -1) {
   56 | m = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |
   58 |  = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 | g bar = new Test().doSomething(request, param);
   61 |
   62 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 | {
>  64 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   65 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   66 |           try {
   67 |            return rs.getString(""USERNAME"");
   68 |           } catch (java.sql.SQLException e) {
   69 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |       return ""Error processing query."";
   71 |      }
   72 | lse throw e;
   73 |
   74 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01723.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01723.java,"
   55 |   if (ampersandLoc != -1) {
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
   63 |   try {
   64 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
>  65 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
   66 |    response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""Your results are: "");
   71 |    response.getWriter().println(
   72 |     results.toString()
   73 |    );
   74 |  //  System.out.println(results);
   75 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01724.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01724.java,"
   54 | tring.indexOf(""&"", paramLoc);
   55 |
   56 | tring(paramLoc + paramval.length(), ampersandLoc);
   57 |
   58 | er.decode(param, ""UTF-8"");
   59 |
   60 | oSomething(request, param);
   61 |
   62 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |
>  64 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   65 | ntln(
   66 | ""
   67 |
   68 |
   69 | ur results are"");
   70 |
   71 |
   72 | intln(
   73 | encoder().encodeForHTML(o.toString()) + ""<br>""
   74 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01725.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01725.java,"
   54 |   int ampersandLoc = queryString.indexOf(""&"", paramLoc);
   55 |   if (ampersandLoc != -1) {
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT TOP 1 USERNAME from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |   try {
>  64 |          Object results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql,new Object[]{}, Stri
   65 |    response.getWriter().println(
   66 |     ""Your results are: ""
   67 |    );
   68 |
   69 |  //  System.out.println(""Your results are"");
   70 |    response.getWriter().println(
   71 |     org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.toString())
   72 |    );
   73 |  //  System.out.println(results.toString());
   74 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01726.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01726.java,"
   55 |   if (ampersandLoc != -1) {
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   63 |   try {
   64 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  65 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   66 |          response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""Your results are"");
   71 |    while (results.next()) {
   72 |     response.getWriter().println(
   73 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   74 |     );
   75 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01727.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01727.java,"
  55 |   if (ampersandLoc != -1) {
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   try {
  63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  64 |
> 65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  66 |    response.getWriter().println(
  67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  68 |     + "" because the Spring batchUpdate method doesn't return results.""
  69 |    );
  70 |   } catch (org.springframework.dao.DataAccessException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 |      ""Error processing request.""
  74 |     );
  75 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01728.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01728.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.addBatch( sql );
  67 |    int[] counts = statement.executeBatch();
  68 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  69 |   } catch (java.sql.SQLException e) {
  70 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  71 |           response.getWriter().println(
  72 | ""Error processing request.""
  73 | );
  74 |           return;
  75 |          }
  76 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01730.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01730.java,"
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  66 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
   67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   68 |   } catch (java.sql.SQLException e) {
   69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |           response.getWriter().println(
   71 | ""Error processing request.""
   72 | );
   73 |           return;
   74 |          }
   75 |    else throw new ServletException(e);
   76 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01731.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01731.java,"
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = new Test().doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  66 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
   67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   68 |   } catch (java.sql.SQLException e) {
   69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |           response.getWriter().println(
   71 | ""Error processing request.""
   72 | );
   73 |           return;
   74 |          }
   75 |    else throw new ServletException(e);
   76 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01733.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01733.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = new Test().doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01881.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01881.java,"
  58 |      break;
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   try {
  66 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  67 |
> 68 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  69 |    response.getWriter().println(
  70 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  71 |     + "" because the Spring batchUpdate method doesn't return results.""
  72 |    );
  73 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  74 |   } catch (org.springframework.dao.DataAccessException e) {
  75 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  76 |           response.getWriter().println(
  77 |      ""Error processing request.""
  78 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01882.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01882.java,"
   57 | ram = java.net.URLDecoder.decode(theCookie.getValue(), ""UTF-8"");
   58 | eak;
   59 |
   60 |
   61 |
   62 |
   63 | g bar = doSomething(request, param);
   64 |
   65 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   66 | {
>  67 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   68 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   69 |           try {
   70 |            return rs.getString(""USERNAME"");
   71 |           } catch (java.sql.SQLException e) {
   72 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   73 |       return ""Error processing query."";
   74 |      }
   75 | lse throw e;
   76 |
   77 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01883.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01883.java,"
   58 |      break;
   59 |     }
   60 |    }
   61 |   }
   62 |
   63 |   String bar = doSomething(request, param);
   64 |
   65 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   66 |   try {
   67 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  68 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   69 |          response.getWriter().println(
   70 |     ""Your results are: ""
   71 |    );
   72 |
   73 |  //  System.out.println(""Your results are"");
   74 |    while (results.next()) {
   75 |     response.getWriter().println(
   76 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   77 |     );
   78 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01887.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01887.java,"
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    int count = statement.executeUpdate( sql );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01888.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01888.java,"
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    int count = statement.executeUpdate( sql );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01889.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01889.java,"
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01890.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01890.java,"
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01891.java,69,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01891.java,"
  59 |     }
  60 |    }
  61 |   }
  62 |
  63 |   String bar = doSomething(request, param);
  64 |
  65 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  66 |
  67 |   try {
  68 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 69 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  70 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  71 |   } catch (java.sql.SQLException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 | ""Error processing request.""
  75 | );
  76 |           return;
  77 |          }
  78 |    else throw new ServletException(e);
  79 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01962.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01962.java,"
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  58 |    statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01963.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01963.java,"
  46 |   }
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   try {
  54 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  55 |
> 56 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  57 |    response.getWriter().println(
  58 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  59 |     + "" because the Spring batchUpdate method doesn't return results.""
  60 |    );
  61 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  62 |   } catch (org.springframework.dao.DataAccessException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 |      ""Error processing request.""
  66 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01964.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01964.java,"
   45 | m = request.getHeader(""BenchmarkTest01964"");
   46 |
   47 |
   48 | L Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
   49 |  = java.net.URLDecoder.decode(param, ""UTF-8"");
   50 |
   51 | g bar = doSomething(request, param);
   52 |
   53 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   54 | {
>  55 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   56 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   57 |           try {
   58 |            return rs.getString(""USERNAME"");
   59 |           } catch (java.sql.SQLException e) {
   60 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   61 |       return ""Error processing query."";
   62 |      }
   63 | lse throw e;
   64 |
   65 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01970.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01970.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.addBatch( sql );
  58 |    int[] counts = statement.executeBatch();
  59 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  60 |   } catch (java.sql.SQLException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 | ""Error processing request.""
  64 | );
  65 |           return;
  66 |          }
  67 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01971.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01971.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql, new int[] { 1, 2 } );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01972.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01972.java,"
  47 |
  48 |   // URL Decode the header value since req.getHeader() doesn't. Unlike req.getParameter().
  49 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02087.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02087.java,"
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  60 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  61 |        statement.setString(1, ""foo"");
> 62 |    statement.execute();
  63 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  64 |   } catch (java.sql.SQLException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 | ""Error processing request.""
  68 | );
  69 |           return;
  70 |          }
  71 |    else throw new ServletException(e);
  72 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02088.java,62,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02088.java,"
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  59 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  60 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  61 |     statement.setString(1, ""foo"");
> 62 |    statement.execute();
  63 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  64 |   } catch (java.sql.SQLException e) {
  65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  66 |           response.getWriter().println(
  67 | ""Error processing request.""
  68 | );
  69 |           return;
  70 |          }
  71 |    else throw new ServletException(e);
  72 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02090.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02090.java,"
   48 |   }
   49 |
   50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
   51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   52 |
   53 |   String bar = doSomething(request, param);
   54 |
   55 |    try {
   56 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   57 |
>  58 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
   59 |    response.getWriter().println(
   60 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
   61 |     + "" because the Spring execute method doesn't return results.""
   62 |    );
   63 |
   64 |   } catch (org.springframework.dao.DataAccessException e) {
   65 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   66 |           response.getWriter().println(
   67 |      ""Error processing request.""
   68 |     );
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02091.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02091.java,"
   47 | m = headers.nextElement(); // just grab first element
   48 |
   49 |
   50 | L Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
   51 |  = java.net.URLDecoder.decode(param, ""UTF-8"");
   52 |
   53 | g bar = doSomething(request, param);
   54 |
   55 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   56 | {
>  57 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   58 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   59 |           try {
   60 |            return rs.getString(""USERNAME"");
   61 |           } catch (java.sql.SQLException e) {
   62 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   63 |       return ""Error processing query."";
   64 |      }
   65 | lse throw e;
   66 |
   67 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02092.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02092.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    statement.execute( sql );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02094.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02094.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    statement.execute( sql );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02096.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02096.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    statement.execute( sql, new int[] { 1, 2 } );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02099.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02099.java,"
  49 |
  50 |   // URL Decode the header value since req.getHeaders() doesn't. Unlike req.getParameters().
  51 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  52 |
  53 |   String bar = doSomething(request, param);
  54 |
  55 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  56 |
  57 |   try {
  58 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 59 |    int count = statement.executeUpdate( sql );
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02169.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02169.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""{call "" + bar + ""}"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  53 |        java.sql.ResultSet.CONCUR_READ_ONLY );
> 54 |    java.sql.ResultSet rs = statement.executeQuery();
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  56 |   } catch (java.sql.SQLException e) {
  57 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02170.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02170.java,"
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""{call "" + bar + ""}"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  53 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 54 |    java.sql.ResultSet rs = statement.executeQuery();
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  56 |         } catch (java.sql.SQLException e) {
  57 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
  64 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02171.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02171.java,"
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  52 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  53 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  54 |     statement.setString(1, ""foo"");
> 55 |    statement.execute();
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02177.java,50,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02177.java,"
   40 |  void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
   41 | nse.setContentType(""text/html;charset=UTF-8"");
   42 |
   43 | g param = request.getParameter(""BenchmarkTest02177"");
   44 | aram == null) param = """";
   45 |
   46 | g bar = doSomething(request, param);
   47 |
   48 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   49 | {
>  50 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   51 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   52 |           try {
   53 |            return rs.getString(""USERNAME"");
   54 |           } catch (java.sql.SQLException e) {
   55 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   56 |       return ""Error processing query."";
   57 |      }
   58 | lse throw e;
   59 |
   60 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02178.java,50,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02178.java,"
  40 | vletRequest request, HttpServletResponse response) throws ServletException, IOException {
  41 | text/html;charset=UTF-8"");
  42 |
  43 | tParameter(""BenchmarkTest02178"");
  44 | = """";
  45 |
  46 | request, param);
  47 |
  48 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  49 |
> 50 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
  51 | ntln(
  52 | ""
  53 |
  54 |
  55 | ur results are"");
  56 |
  57 |
  58 | intln(
  59 | encoder().encodeForHTML(o.toString()) + ""<br>""
  60 |
     ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02179.java,51,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02179.java,"
  41 |   response.setContentType(""text/html;charset=UTF-8"");
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest02179"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  49 |   try {
  50 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
> 51 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
  52 |    response.getWriter().println(
  53 |     ""Your results are: ""
  54 |    );
  55 |
  56 |  //  System.out.println(""your results are"");
  57 |    response.getWriter().println(
  58 |     results.toString()
  59 |    );
  60 |  //  System.out.println(results);
  61 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02181.java,50,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02181.java,"
  40 | HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  41 | tType(""text/html;charset=UTF-8"");
  42 |
  43 | uest.getParameter(""BenchmarkTest02181"");
  44 |  param = """";
  45 |
  46 | ething(request, param);
  47 |
  48 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  49 |
> 50 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  51 | r().println(
  52 | e: ""
  53 |
  54 |
  55 | tln(""Your results are"");
  56 | r().println(
  57 | ESAPI.encoder().encodeForHTML(results.toString())
  58 |
  59 | tln(results.toString());
  60 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02182.java,50,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02182.java,"
  40 | HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  41 | tType(""text/html;charset=UTF-8"");
  42 |
  43 | uest.getParameter(""BenchmarkTest02182"");
  44 |  param = """";
  45 |
  46 | ething(request, param);
  47 |
  48 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  49 |
> 50 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  51 | r().println(
  52 | e: ""
  53 |
  54 |
  55 | tln(""Your results are"");
  56 | r().println(
  57 | ESAPI.encoder().encodeForHTML(results.toString())
  58 |
  59 | tln(results.toString());
  60 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02186.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02186.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest02186"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    statement.execute( sql );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02187.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02187.java,"
  42 |
  43 |   String param = request.getParameter(""BenchmarkTest02187"");
  44 |   if (param == null) param = """";
  45 |
  46 |   String bar = doSomething(request, param);
  47 |
  48 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  49 |
  50 |   try {
  51 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 52 |    statement.execute( sql );
  53 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  54 |   } catch (java.sql.SQLException e) {
  55 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  56 |           response.getWriter().println(
  57 | ""Error processing request.""
  58 | );
  59 |           return;
  60 |          }
  61 |    else throw new ServletException(e);
  62 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02264.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02264.java,"
  48 |  }
  49 |
  50 |
  51 |  String bar = doSomething(request, param);
  52 |
  53 |  String sql = ""{call "" + bar + ""}"";
  54 |
  55 |  try {
  56 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 58 |      java.sql.ResultSet rs = statement.executeQuery();
  59 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  60 |
  61 |  } catch (java.sql.SQLException e) {
  62 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |          response.getWriter().println(
  64 | Error processing request.""
  65 | ;
  66 |          return;
  67 |         }
  68 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02269.java,61,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02269.java,"
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  58 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  59 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  60 |     statement.setString(1, ""foo"");
> 61 |    statement.execute();
  62 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  63 |   } catch (java.sql.SQLException e) {
  64 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  65 |           response.getWriter().println(
  66 | ""Error processing request.""
  67 | );
  68 |           return;
  69 |          }
  70 |    else throw new ServletException(e);
  71 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02270.java,61,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02270.java,"
   51 |   String bar = doSomething(request, param);
   52 |
   53 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   54 |
   55 |   try {
   56 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   57 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
   58 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
   59 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
   60 |     statement.setString(1, ""foo"");
>  61 |    statement.execute();
   62 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   63 |   } catch (java.sql.SQLException e) {
   64 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   65 |           response.getWriter().println(
   66 | ""Error processing request.""
   67 | );
   68 |           return;
   69 |          }
   70 |    else throw new ServletException(e);
   71 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02272.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02272.java,"
  46 |    String[] values = map.get(""BenchmarkTest02272"");
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   try {
  54 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  55 |
> 56 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  57 |    response.getWriter().println(
  58 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  59 |     + "" because the Spring batchUpdate method doesn't return results.""
  60 |    );
  61 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  62 |   } catch (org.springframework.dao.DataAccessException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 |      ""Error processing request.""
  66 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02273.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02273.java,"
  46 |    String[] values = map.get(""BenchmarkTest02273"");
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   try {
  54 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  55 |
> 56 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  57 |    response.getWriter().println(
  58 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  59 |     + "" because the Spring batchUpdate method doesn't return results.""
  60 |    );
  61 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  62 |   } catch (org.springframework.dao.DataAccessException e) {
  63 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  64 |           response.getWriter().println(
  65 |      ""Error processing request.""
  66 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02275.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02275.java,"
  46 |    String[] values = map.get(""BenchmarkTest02275"");
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT  TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"" ;
  54 |   try {
  55 |    //int results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForInt(sql);
> 56 |    Integer results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Integer.class);
  57 |    response.getWriter().println(
  58 |     ""Your results are: ""
  59 |    );
  60 |
  61 |  //  System.out.println(""Your results are: "");
  62 |    response.getWriter().println(
  63 |     results.toString()
  64 |    );
  65 |  //  System.out.println(results);
  66 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02277.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02277.java,"
  45 |
  46 | t(""BenchmarkTest02277"");
  47 | m = values[0];
  48 |
  49 |
  50 |
  51 | request, param);
  52 |
  53 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  54 |
> 55 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
  56 | ntln(
  57 | ""
  58 |
  59 |
  60 | ur results are"");
  61 |
  62 |
  63 | intln(
  64 | encoder().encodeForHTML(o.toString()) + ""<br>""
  65 |
     ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02281.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02281.java,"
  45 | ) {
  46 |  map.get(""BenchmarkTest02281"");
  47 | l) param = values[0];
  48 |
  49 |
  50 |
  51 | ething(request, param);
  52 |
  53 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  54 |
> 55 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  56 | r().println(
  57 | e: ""
  58 |
  59 |
  60 | tln(""Your results are"");
  61 | r().println(
  62 | ESAPI.encoder().encodeForHTML(results.toString())
  63 |
  64 | tln(results.toString());
  65 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02284.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02284.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02286.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02286.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02287.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02287.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02288.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02288.java,"
  47 |    if (values != null) param = values[0];
  48 |   }
  49 |
  50 |
  51 |   String bar = doSomething(request, param);
  52 |
  53 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  54 |
  55 |   try {
  56 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 57 |    int count = statement.executeUpdate( sql, new String[] {""USERNAME"",""PASSWORD""} );
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  59 |   } catch (java.sql.SQLException e) {
  60 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02354.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02354.java,"
  58 |   }
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new int[] { 1, 2 } );
  67 |    statement.setString(1, ""foo"");
> 68 |    statement.execute();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02355.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02355.java,"
  58 |   }
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql, new String[] {""Column1"",""Column2""} );
  67 |    statement.setString(1, ""foo"");
> 68 |    statement.execute();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02356.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02356.java,"
  55 |      }
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |    try {
  63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  64 |
> 65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  66 |    response.getWriter().println(
  67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  68 |     + "" because the Spring execute method doesn't return results.""
  69 |    );
  70 |
  71 |   } catch (org.springframework.dao.DataAccessException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 |      ""Error processing request.""
  75 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02357.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02357.java,"
   54 |   flag = false;
   55 |
   56 |
   57 |
   58 |
   59 |
   60 | g bar = doSomething(request, param);
   61 |
   62 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 | {
>  64 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   65 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   66 |           try {
   67 |            return rs.getString(""USERNAME"");
   68 |           } catch (java.sql.SQLException e) {
   69 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |       return ""Error processing query."";
   71 |      }
   72 | lse throw e;
   73 |
   74 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02358.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02358.java,"
   54 |
   55 |
   56 |
   57 |
   58 |
   59 |
   60 | request, param);
   61 |
   62 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |
>  64 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   65 | ntln(
   66 | ""
   67 |
   68 |
   69 | ur results are"");
   70 |
   71 |
   72 | intln(
   73 | encoder().encodeForHTML(o.toString()) + ""<br>""
   74 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02359.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02359.java,"
   55 |      }
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |   try {
   64 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
>  65 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
   66 |    response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""your results are"");
   71 |    response.getWriter().println(
   72 |     results.toString()
   73 |    );
   74 |  //  System.out.println(results);
   75 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02360.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02360.java,"
   55 |      }
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |   try {
   64 |    //Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForLong(sql);
>  65 |    Long results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForObject(sql, Long.class);
   66 |    response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""your results are"");
   71 |    response.getWriter().println(
   72 |     results.toString()
   73 |    );
   74 |  //  System.out.println(results);
   75 |   } catch (org.springframework.dao.EmptyResultDataAccessException e) {
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02362.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02362.java,"
   55 |      }
   56 |     }
   57 |    }
   58 |   }
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   63 |   try {
   64 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  65 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   66 |          response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""Your results are"");
   71 |    while (results.next()) {
   72 |     response.getWriter().println(
   73 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   74 |     );
   75 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02364.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02364.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.execute( sql );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02369.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02369.java,"
  56 |     }
  57 |    }
  58 |   }
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, new int[] {1,2} );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02449.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02449.java,"
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = doSomething(request, param);
  48 |
  49 |   String sql = ""{call "" + bar + ""}"";
  50 |
  51 |   try {
  52 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  53 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  54 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 55 |    java.sql.ResultSet rs = statement.executeQuery();
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  57 |         } catch (java.sql.SQLException e) {
  58 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02451.java,52,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02451.java,"
  42 |
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest02451"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = doSomething(request, param);
  48 |
  49 |    try {
  50 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  51 |
> 52 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.execute(sql);
  53 |    response.getWriter().println(
  54 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  55 |     + "" because the Spring execute method doesn't return results.""
  56 |    );
  57 |
  58 |   } catch (org.springframework.dao.DataAccessException e) {
  59 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  60 |           response.getWriter().println(
  61 |      ""Error processing request.""
  62 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02453.java,51,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02453.java,"
  41 | tType(""text/html;charset=UTF-8"");
  42 |
  43 | k.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 | .getTheParameter(""BenchmarkTest02453"");
  45 |  param = """";
  46 |
  47 | ething(request, param);
  48 |
  49 | CT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  50 |
> 51 | ap<String, Object> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForMap(sql);
  52 | r().println(
  53 | e: ""
  54 |
  55 |
  56 | tln(""Your results are"");
  57 | r().println(
  58 | ESAPI.encoder().encodeForHTML(results.toString())
  59 |
  60 | tln(results.toString());
  61 | gframework.dao.EmptyResultDataAccessException e) {
     ^ Col 20
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02454.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02454.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest02454"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = doSomething(request, param);
  48 |
  49 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    statement.addBatch( sql );
  54 |    int[] counts = statement.executeBatch();
  55 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  56 |   } catch (java.sql.SQLException e) {
  57 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  58 |           response.getWriter().println(
  59 | ""Error processing request.""
  60 | );
  61 |           return;
  62 |          }
  63 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02455.java,53,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02455.java,"
  43 |   org.owasp.benchmark.helpers.SeparateClassRequest scr = new org.owasp.benchmark.helpers.SeparateClassRequest( request );
  44 |   String param = scr.getTheParameter(""BenchmarkTest02455"");
  45 |   if (param == null) param = """";
  46 |
  47 |   String bar = doSomething(request, param);
  48 |
  49 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  50 |
  51 |   try {
  52 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 53 |    int count = statement.executeUpdate( sql );
  54 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  55 |   } catch (java.sql.SQLException e) {
  56 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  57 |           response.getWriter().println(
  58 | ""Error processing request.""
  59 | );
  60 |           return;
  61 |          }
  62 |    else throw new ServletException(e);
  63 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02528.java,56,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02528.java,"
  46 |    param = values[0];
  47 |  else param = """";
  48 |
  49 |  String bar = doSomething(request, param);
  50 |
  51 |  String sql = ""{call "" + bar + ""}"";
  52 |
  53 |  try {
  54 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 56 |      java.sql.ResultSet rs = statement.executeQuery();
  57 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  58 |
  59 |  } catch (java.sql.SQLException e) {
  60 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |          response.getWriter().println(
  62 | Error processing request.""
  63 | ;
  64 |          return;
  65 |         }
  66 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02530.java,57,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02530.java,"
  47 |   else param = """";
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""{call "" + bar + ""}"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  56 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 57 |    java.sql.ResultSet rs = statement.executeQuery();
  58 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  59 |         } catch (java.sql.SQLException e) {
  60 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  61 |           response.getWriter().println(
  62 | ""Error processing request.""
  63 | );
  64 |           return;
  65 |          }
  66 |    else throw new ServletException(e);
  67 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02531.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02531.java,"
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  56 |        java.sql.Statement.RETURN_GENERATED_KEYS );
  57 |        statement.setString(1, ""foo"");
> 58 |    statement.execute();
  59 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  60 |   } catch (java.sql.SQLException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 | ""Error processing request.""
  64 | );
  65 |           return;
  66 |          }
  67 |    else throw new ServletException(e);
  68 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02532.java,58,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02532.java,"
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  56 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY );
  57 |     statement.setString(1, ""foo"");
> 58 |    statement.execute();
  59 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  60 |   } catch (java.sql.SQLException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 | ""Error processing request.""
  64 | );
  65 |           return;
  66 |          }
  67 |    else throw new ServletException(e);
  68 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02533.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02533.java,"
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  56 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  57 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  58 |     statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02534.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02534.java,"
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  56 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  57 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  58 |     statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02535.java,59,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02535.java,"
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  55 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
  56 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
  57 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
  58 |     statement.setString(1, ""foo"");
> 59 |    statement.execute();
  60 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  61 |   } catch (java.sql.SQLException e) {
  62 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  63 |           response.getWriter().println(
  64 | ""Error processing request.""
  65 | );
  66 |           return;
  67 |          }
  68 |    else throw new ServletException(e);
  69 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02537.java,54,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02537.java,"
  44 |   String param;
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   try {
  52 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  53 |
> 54 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  55 |    response.getWriter().println(
  56 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  57 |     + "" because the Spring batchUpdate method doesn't return results.""
  58 |    );
  59 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  60 |   } catch (org.springframework.dao.DataAccessException e) {
  61 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  62 |           response.getWriter().println(
  63 |      ""Error processing request.""
  64 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02542.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02542.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    statement.execute( sql );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02543.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02543.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    statement.execute( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02545.java,55,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02545.java,"
  45 |   if (values != null && values.length > 0)
  46 |     param = values[0];
  47 |   else param = """";
  48 |
  49 |   String bar = doSomething(request, param);
  50 |
  51 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  52 |
  53 |   try {
  54 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 55 |    int count = statement.executeUpdate( sql );
  56 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  57 |   } catch (java.sql.SQLException e) {
  58 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  59 |           response.getWriter().println(
  60 | ""Error processing request.""
  61 | );
  62 |           return;
  63 |          }
  64 |    else throw new ServletException(e);
  65 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02625.java,67,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02625.java,"
  57 |  }
  58 |  param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |  String bar = doSomething(request, param);
  61 |
  62 |  String sql = ""{call "" + bar + ""}"";
  63 |
  64 |  try {
  65 |   java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |   java.sql.CallableStatement statement = connection.prepareCall( sql );
> 67 |      java.sql.ResultSet rs = statement.executeQuery();
  68 |            org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  69 |
  70 |  } catch (java.sql.SQLException e) {
  71 |   if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |          response.getWriter().println(
  73 | Error processing request.""
  74 | ;
  75 |          return;
  76 |         }
  77 |   else throw new ServletException(e);
     ^ Col 1
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02627.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02627.java,"
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02628.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02628.java,"
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |   } catch (java.sql.SQLException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02630.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02630.java,"
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""{call "" + bar + ""}"";
  63 |
  64 |   try {
  65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
  66 |    java.sql.CallableStatement statement = connection.prepareCall( sql, java.sql.ResultSet.TYPE_FORWARD_ONLY,
  67 |        java.sql.ResultSet.CONCUR_READ_ONLY, java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
> 68 |    java.sql.ResultSet rs = statement.executeQuery();
  69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  70 |         } catch (java.sql.SQLException e) {
  71 |          if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 | ""Error processing request.""
  74 | );
  75 |           return;
  76 |          }
  77 |    else throw new ServletException(e);
  78 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02632.java,68,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02632.java,"
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql );
   67 |    statement.setString(1, ""foo"");
>  68 |    statement.execute();
   69 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   70 |   } catch (java.sql.SQLException e) {
   71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   72 |           response.getWriter().println(
   73 | ""Error processing request.""
   74 | );
   75 |           return;
   76 |          }
   77 |    else throw new ServletException(e);
   78 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02635.java,70,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02635.java,"
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME=? and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Connection connection = org.owasp.benchmark.helpers.DatabaseHelper.getSqlConnection();
   66 |    java.sql.PreparedStatement statement = connection.prepareStatement( sql,
   67 |     java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY,
   68 |     java.sql.ResultSet.CLOSE_CURSORS_AT_COMMIT );
   69 |     statement.setString(1, ""foo"");
>  70 |    statement.execute();
   71 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   72 |   } catch (java.sql.SQLException e) {
   73 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   74 |           response.getWriter().println(
   75 | ""Error processing request.""
   76 | );
   77 |           return;
   78 |          }
   79 |    else throw new ServletException(e);
   80 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02638.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02638.java,"
  55 |   if (ampersandLoc != -1) {
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   try {
  63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  64 |
> 65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  66 |    response.getWriter().println(
  67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  68 |     + "" because the Spring batchUpdate method doesn't return results.""
  69 |    );
  70 |  //  System.out.println(""no results for query: "" + sql + "" because the Spring batchUpdate method doesn't return results.""
  71 |   } catch (org.springframework.dao.DataAccessException e) {
  72 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  73 |           response.getWriter().println(
  74 |      ""Error processing request.""
  75 |     );
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02641.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02641.java,"
   54 | mpersandLoc = queryString.indexOf(""&"", paramLoc);
   55 | mpersandLoc != -1) {
   56 | m = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |
   58 |  = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 | g bar = doSomething(request, param);
   61 |
   62 | ng sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 | {
>  64 | .util.List<String> results = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.query(sql,  new org.springframework.
   65 |       public String mapRow(java.sql.ResultSet rs, int rowNum) throws java.sql.SQLException {
   66 |           try {
   67 |            return rs.getString(""USERNAME"");
   68 |           } catch (java.sql.SQLException e) {
   69 |            if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |       return ""Error processing query."";
   71 |      }
   72 | lse throw e;
   73 |
   74 |       }
      ^ Col 7
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02642.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02642.java,"
   54 | tring.indexOf(""&"", paramLoc);
   55 |
   56 | tring(paramLoc + paramval.length(), ampersandLoc);
   57 |
   58 | er.decode(param, ""UTF-8"");
   59 |
   60 | request, param);
   61 |
   62 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |
>  64 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   65 | ntln(
   66 | ""
   67 |
   68 |
   69 | ur results are"");
   70 |
   71 |
   72 | intln(
   73 | encoder().encodeForHTML(o.toString()) + ""<br>""
   74 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02643.java,64,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02643.java,"
   54 | tring.indexOf(""&"", paramLoc);
   55 |
   56 | tring(paramLoc + paramval.length(), ampersandLoc);
   57 |
   58 | er.decode(param, ""UTF-8"");
   59 |
   60 | request, param);
   61 |
   62 | om USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
   63 |
>  64 | .Map<String, Object>> list = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForList(sql);
   65 | ntln(
   66 | ""
   67 |
   68 |
   69 | ur results are"");
   70 |
   71 |
   72 | intln(
   73 | encoder().encodeForHTML(o.toString()) + ""<br>""
   74 |
      ^ Col 27
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02644.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02644.java,"
  55 |   if (ampersandLoc != -1) {
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
  63 |   try {
  64 |          org.springframework.jdbc.support.rowset.SqlRowSet results
> 65 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
  66 |          response.getWriter().println(
  67 |     ""Your results are: ""
  68 |    );
  69 |
  70 |  //  System.out.println(""Your results are"");
  71 |    while (results.next()) {
  72 |     response.getWriter().println(
  73 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
  74 |     );
  75 |  //   System.out.println(results.getString(""USERNAME""));
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02645.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02645.java,"
   55 |   if (ampersandLoc != -1) {
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT  * from USERS where USERNAME='foo' and PASSWORD='""+ bar + ""'"";
   63 |   try {
   64 |          org.springframework.jdbc.support.rowset.SqlRowSet results
>  65 |           = org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.queryForRowSet(sql);
   66 |          response.getWriter().println(
   67 |     ""Your results are: ""
   68 |    );
   69 |
   70 |  //  System.out.println(""Your results are"");
   71 |    while (results.next()) {
   72 |     response.getWriter().println(
   73 |      org.owasp.esapi.ESAPI.encoder().encodeForHTML(results.getString(""USERNAME"")) + "" ""
   74 |     );
   75 |  //   System.out.println(results.getString(""USERNAME""));
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02646.java,65,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02646.java,"
  55 |   if (ampersandLoc != -1) {
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   try {
  63 |          String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='"" + bar + ""'"";
  64 |
> 65 |    org.owasp.benchmark.helpers.DatabaseHelper.JDBCtemplate.batchUpdate(sql);
  66 |    response.getWriter().println(
  67 |     ""No results can be displayed for query: "" + org.owasp.esapi.ESAPI.encoder().encodeForHTML(sql) + ""<br>""
  68 |     + "" because the Spring batchUpdate method doesn't return results.""
  69 |    );
  70 |   } catch (org.springframework.dao.DataAccessException e) {
  71 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  72 |           response.getWriter().println(
  73 |      ""Error processing request.""
  74 |     );
  75 |          }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02647.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02647.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.addBatch( sql );
  67 |    int[] counts = statement.executeBatch();
  68 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(sql, counts, response);
  69 |   } catch (java.sql.SQLException e) {
  70 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  71 |           response.getWriter().println(
  72 | ""Error processing request.""
  73 | );
  74 |           return;
  75 |          }
  76 |    else throw new ServletException(e);
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02649.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02649.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.execute( sql, new int[] { 1, 2 } );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02650.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02650.java,"
   56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
   57 |   }
   58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
   59 |
   60 |   String bar = doSomething(request, param);
   61 |
   62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
   63 |
   64 |   try {
   65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
>  66 |    statement.execute( sql, new int[] { 1, 2 } );
   67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
   68 |   } catch (java.sql.SQLException e) {
   69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
   70 |           response.getWriter().println(
   71 | ""Error processing request.""
   72 | );
   73 |           return;
   74 |          }
   75 |    else throw new ServletException(e);
   76 |   }
      ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02651.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02651.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement =  org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    statement.execute( sql, new String[] { ""username"", ""password"" } );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(statement, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02653.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02653.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""SELECT * from USERS where USERNAME='foo' and PASSWORD='""+ bar +""'"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    java.sql.ResultSet rs = statement.executeQuery( sql );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.printResults(rs, sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02654.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02654.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02655.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02655.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
F112,lines,OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02656.java,66,89,skims,112. SQL injection - Java SQL API,Use of attacker controlled parameters for querying the data base in OWASP/src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02656.java,"
  56 |    param = queryString.substring(paramLoc + paramval.length(), ampersandLoc);
  57 |   }
  58 |   param = java.net.URLDecoder.decode(param, ""UTF-8"");
  59 |
  60 |   String bar = doSomething(request, param);
  61 |
  62 |   String sql = ""INSERT INTO users (username, password) VALUES ('foo','""+ bar + ""')"";
  63 |
  64 |   try {
  65 |    java.sql.Statement statement = org.owasp.benchmark.helpers.DatabaseHelper.getSqlStatement();
> 66 |    int count = statement.executeUpdate( sql, java.sql.Statement.RETURN_GENERATED_KEYS );
  67 |             org.owasp.benchmark.helpers.DatabaseHelper.outputUpdateComplete(sql, response);
  68 |   } catch (java.sql.SQLException e) {
  69 |    if (org.owasp.benchmark.helpers.DatabaseHelper.hideSQLErrors) {
  70 |           response.getWriter().println(
  71 | ""Error processing request.""
  72 | );
  73 |           return;
  74 |          }
  75 |    else throw new ServletException(e);
  76 |   }
     ^ Col 0
",get_vulnerabilities_from_syntax
