:slug: rules/173/
:category: rules
:description: En el presente documento se detallan los requerimientos de seguridad relacionados al código fuente que compone a las aplicaciones de la compañía. En este requerimiento se establece la importancia de descartar la información potencialmente insegura recibida por entradas de la aplicación.
:keywords: Requerimiento, Seguridad, Código Fuente, Descartar, Información, Insegura.
:rules: yes

= REQ.173 Descartar información insegura

== Requisito

El sistema debe descartar toda la información
potencialmente insegura que sea recibida por entradas de datos.

== Descripción

Los artefactos tecnológicos y en particular las aplicaciones
deben ser capaces de identificar la información ingresada o recibida
que no corresponda con sus propósitos operativos,
con el fin de darle un tratamiento adecuado
(por ejemplo, rechazándola y/o generando alertas oportunas)
y que no impacte negativamente la operación.
Ejemplos típicos de esto son:
sentencias +SQL+, código +JavaScript+, comandos de sistema operativo
o consultas +LDAP+ en campos y parámetros de aplicaciones;
texto con caracteres especiales no requeridos
y sus combinaciones en campos y parámetros;
archivos manipulados en estructura y extensión
a ser cargados en una aplicación o artefacto de tecnología,
y en general cualquier tipo de información
que no corresponda con el formato solicitado.
Una gran cantidad de tráfico entrante a un artefacto tecnológico
puede ser considerado igual (que no corresponde con los propósitos operativos)
e igualmente debe ser sujeto de controles y un adecuado tratamiento.

== Implementación

. Preferir listas blancas sobre negras:
Al utilizar este principio la implementación del control
definirá que todo será rechazado sino esta explícitamente aprobado,
por ende descarta todo el universo posible
y obliga a la enumeración de lo estrictamente permitido.
Por ejemplo, solo permitir: +a-z+, +A-Z+ y +0-9+.

. Utilizar manchado de variables:
De ser soportado, lenguaje y compilador
puede ayudar a detectar variables provenientes del exterior
que no pasan por un filtro de validación.
Para ello se pueden utilizar técnicas que manchen dichas variables
y compiladores o pre-procesadores ayuden a detectar
que ellas no están siento validadas.

. Validación de entrada no solo de usuario:
Cualquier entrada proveniente del exterior
debe ser considerada como no confiable,
es decir, no solo el usuario
esta en capacidad de ingresar información incorrecta
y potencialmente peligrosa,
también sistemas externos pueden ser comprometidos
y por ende esta información debe ser validada.

== Soluciones

. +ASPNET+ link:../../defends/aspnet/redireccion-paginas-web/[Validar redirecciones a páginas web].
. +ASPNET+ link:../../defends/aspnet/prevenir-sqli/[Prevenir inyección SQL].
. +ASPNET+ link:../../defends/aspnet/evitar-sqli-parametrizacion/[Prevenir Inyección SQL Mediante Parametrización].
. +ASPNET+ link:../../defends/aspnet/filtrar-campos-entrada/[Filtrar campos de entrada].
. +COBOL+ link:../../defends/cobol/sqli-sentencia-parametrizada/[Prevenir SQLi Mediante Sentencias Parametrizadas].
. +COBOL+ link:../../defends/cobol/validar-datos-variables/[Validar Datos en Variables].
. +Java+ link:../../defends/java/prevenir-sqli/[Prevenir Inyección SQL].
. +Java+ link:../../defends/java/filtrar-entrada-datos-regex/[Filtrar Entrada de Datos Usando Expresión Regular].
. +PHP+ link:../../defends/php/filtrar-entradas-regex/[Filtrar Entradas con Expresiones Regulares].

== Ataques

. Inyectar software o código malicioso.
. Indisponer un sistema por inundación de registros.
. Cross-Site Scripting (+XSS+).
. Redireccionar a páginas no seguras.

== Atributos

* Capa: aplicación
* Activo: código fuente
* Alcance: madurez
* Fase: construcción
* Tipo control: recomendación.

== Referencias

. [[r1]] link:https://www.owasp.org/index.php/Top_10_2013-A1-Injection[+A1+ Injection +OWASP+ - Top 10 2013]
. [[r2]] link:https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)[A3 Cross-site Scripting (+XSS+) +OWASP+ - TOP 10 2013].
. [[r3]] link:https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards[+A10+ Unvalidated Redirects and Forwards +OWASP+ - TOP 10 2013].
. [[r4]] link:https://cwe.mitre.org/data/definitions/20.html[​+CWE-20+: Improper Input Validation].
. [[r5]] link:https://cwe.mitre.org/data/definitions/74.html[+CWE-74+: Injection].
. [[r6]] link:https://cwe.mitre.org/data/definitions/78.html[+CWE-78+: OS Command Injection].
. [[r7]] link:https://cwe.mitre.org/data/definitions/79.html[​+CWE-79+: Cross-site Scripting].
. [[r8]] link:https://cwe.mitre.org/data/definitions/80.html[+CWE-80+: Basic +XSS+].
. [[r9]] link:https://cwe.mitre.org/data/definitions/89.html[+CWE-89+: +SQL+ Injection].
. [[r10]] link:https://cwe.mitre.org/data/definitions/89.html[Taint checking - Wikipedia].
