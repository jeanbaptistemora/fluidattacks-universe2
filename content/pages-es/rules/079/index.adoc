:slug: rules/079/
:category: rules
:description: En el presente documento se detallan los requerimientos de seguridad relacionados con las bitácoras que registran eventos relevantes. En este requerimiento se establece la importancia de registrar los niveles de severidad para los eventos excepcionales y de seguridad.
:keywords: Requerimiento, Seguridad, Bitácoras, Registrar, Momento, Ocurrencia.
:rules: yes

= REQ.079 Registrar momento de ocurrencia de eventos

== Requisito

El sistema debe registrar el momento exacto de ocurrencia
(Fecha, hora, segundos, milisegundos, y zona horaria)
para cada evento excepcional y de seguridad.

== Descripción

Los +logs+ de eventos deben contener el detalle exacto de la ocurrencia
a fin de tener los detalles necesarios en una posible investigación.

== Implementación

. Definidos los eventos que van a ser registrados,
se debe configurar que estos registros
contengan el detalle de Fecha, hora, segundos, milisegundos y zona horaria.

== Soluciones

. +COBOL+ link:../../defends/cobol/registrar-excepciones-ile/[Registrar Excepciones ILE].
. +Exchange 2010+ link:../../defends/exchange/activar-bitacoras-smtp/[Activar Bitácoras de Conectores SMTP].
. +GlassFish+ link:../../defends/glassfish/configurar-bitacoras/[Configurar Bitácoras].
. +Programación+ link:../../defends/programacion/crear-bitacoras-cond/[Crear Bitácoras Condicionales].
. +RPG+ link:../../defends/rpg/manejar-bitacoras/[Definir Manejo de Bitácoras].
. +Scala+ link:../../defends/scala/registrar-eventos-bitacoras/[Registrar Eventos en Bitácoras].
. +SharePoint 2010+ link:../../defends/sharepoint/configurar-bitacoras/[Configurar Registro en Bitácoras].

== Ataques

Ocurre un incidente, no se identifica con claridad
desde que momento se presentan los eventos
al no tener el detalle claro en los registros.

== Atributos

* Capa: Capa de Aplicación
* Activo: Bitácoras
* Alcance: Responsabilidad
* Fase: Operación
* Tipo de Control: Procedimiento

== Referencias

. [[r1]] link:https://www.owasp.org/index.php/Codereview-Error-Handling[OWASP - CodeReview-Error-Handling].
. [[r2]] link:https://www.owasp.org/index.php/OWASP_Proactive_Controls[OWASP - Proactive Controls].
. [[r3]] link:https://www.owasp.org/index.php/Exception_Handling#Logging_Exception_Details[OWASP - Exception Handling].
. [[r4]] link:https://cwe.mitre.org/data/definitions/778.html[CWE - Insufficient logging].
. [[r5]] link:https://www.owasp.org/index.php/ASVS_V8_Error_Handling[+OWASP-ASVS v3.1-8.3+]
Verificar que cada evento registrado incluya la información necesaria
que permita una investigación detallada
de la línea de tiempo cuando se presente la ocurrencia de un evento.
. [[r6]] link:https://www.owasp.org/index.php/ASVS_V8_Error_Handling[+OWASP-ASVS v3.1-8.13+]
Las fuentes de tiempo deben estar sincronizadas
para asegurar que las bitácoras registren la hora correcta.
