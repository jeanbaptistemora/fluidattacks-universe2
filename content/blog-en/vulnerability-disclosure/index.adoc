:slug: vulnerability-disclosure/
:date: 2018-10-25
:category: hacking
:subtitle: Responsible vulnerability disclosure
:tags: security, bug, vulnerability, pentesting
:image: hackers.png
:alt: Vulnerability disclosure
:description: When an information security analyst finds a new vulnerability in a system or application, either be intentionally or randomly, how he can procede to report it for further remediation? Here we are going to explain good practices of vulnerability disclosure.
:keywords: Security, CVE, Vulnerability, Pentesting, Disclosure, Policies.
:author: Jonathan Armas
:writer: johna
:name: Jonathan Armas
:about1: Systems Engineer, Security+
:about2: "Be formless, shapeless like water" Bruce Lee

= Vulnerability disclosure ecosystem

An information security vulnerability is
a flaw or a weakness in a system or application
that a malicious attacker could exploit
and result in a compromise of
the confidentiality, integrity or availability of
both software and hardware systems.

We as Security Testers
(or pentesters, white hat hackers)
found every day new vulnerabilities on
our clients software, systems and procedures
that if someone discloses them before the patch
it could result in a great problem
as much as for the users
as for the company.

Even though identifying and fixing vulnerabilities is crucial
and the process of disclosure of vulnerabilities is a part of this ecosystem,
performing security tests on systems
that we do not have the authorization for
could end on legal issues for the researcher,
this risk might be reduced
if we apply good practices
when we are going to disclose a vulnerability.

To understand how we should disclose vulnerabilities
we need to know who are the actors
that participate in this process:

Discoverers::
This include individuals or organizations
that find vulnerabilities,
this could be researchers, security companies, users, among others.

Vendors::
They develop and maintain information system products
that may be vulnerable,
this includes both large vendors of software
and small open-software development groups

Coordinators::
They manage the vendor's response to vulnerabilities,
they serve as unbiased, independent evaluators of severity
and my act as a medium for communicating with the public

Users::
Is everyone using a vendor's product
that could be affected by the vulnerability.

== Responsible vulnerability disclosure

In order to avoid jail
and to have a well-meaned resolution of vulnerabilities
we need to follow an structured plan,
the life cicle of a vulnerability disclosure is as follows:

["graphviz", "vulnlifecicle.png"]
----
digraph G {
rankdir=TD;
  subgraph cluster_0 {
    style=filled;
    color=lightgrey;
    node [style=filled,color=white];
    "Find" -> "Report" -> "Investigate" -> "Vulnerability confirmed" -> "Patch" -> "Release" -> "Stop";
  };

"Stop"[shape=square, color=salmon2];
"Vulnerability confirmed"[color=greenyellow]
"Find"[shape=square];
"Investigate"-> "Vulnerability not confirmed" -> "Stop"[color=red];
label="Vulnerability disclosure life cicle";
labelloc=top;
  size="8,5";
}
----

A security researcher, organization or an individual
tries to discover new vulnerabilities
on a system or application,
they test and validate the vulnerability
by developing a a repeatable process
to verify its effects.

Then communicates their discoveries
to the vendor of the software,
this could be directly to the vendor
or by a coordinator (like CSIRTs).

Later the vendor investigates the vulnerability,
if its ok confirms it,
and then they start to work
in a patch or countermeasure.
When is finished,
they release the new fix
and the information about the vulnerability.

The communication of the vulnerability
is the most important part of the process,
on this step is tested the maturity of the researcher and the vendor,
here we can establish some good practices
for a security tester
in order to report a vulnerability:

* Alert the company
* If the communication fails,
try multiple times
and with multiple persons on the chain of command
* If the communication with the vendor fails
try with the national CSIRT
* If nothing works, with the CSIRT procede with a full disclosure

Each step has a time interval,
there are multiple methodologies
on at what time do what.
Some has a 45 day disclosure policy,
others 90 days since the notification
(this is the one we recommend),
but you need to be flexible,
this times might change,
communication is key on this events.

The vendor should provide status updates about the vulnerability
and try to resolve it within the time frame,
they could ask to allow a grace period
on which the finder and the coordinator
wont release the details of the vulnerability,
it depends of the severity of the flaw
or the difficulty to resolve it.

When the vulnerability is fixed
the vendor must provide credit to the finder,
they usually put them on the notes of the patch,
some of them have bug bounty rewards
where they give money to the researchers.

The vulnerability disclosure is a delicate process,
but also a very rewarding for all parties.
Is well known that now at days
there are multiple security vulnerabilities
and customer/company information disclosure
exploited by malicious attackers.
A benign environment where
security researchers and vendors could collaborate
in order to find and fix critical vulnerabilities
before could affect someone is a win-win situation.

== Resources

* link:https://tools.ietf.org/html/draft-christey-wysopal-vuln-disclosure-00#section-3.3[IETF Responsible Vulnerability Disclosure Process]
* link:https://googleprojectzero.blogspot.com/2015/02/feedback-and-data-driven-updates-to.html[Google Project Zero]
* link:https://www.microsoft.com/en-us/msrc/cvd?rtc=1[Microsoft Coordinated Vulnerability Disclosure]
* link:https://vuls.cert.org/confluence/display/Wiki/Vulnerability+Disclosure+Policy[US CERT Vulnerability Disclosure Policy]
* link:https://www.owasp.org/index.php/Vulnerability_Disclosure_Cheat_Sheet[OWASP Vulnerability Disclosure Cheat Sheet]
* link:https://www.enisa.europa.eu/publications/vulnerability-disclosure[ENISA Guide on Vulnerability Disclosure]
* link:https://www.rapid7.com/security/disclosure/[Rapid7 Vulnerability Disclosure Policy]
