:slug: que-ruta-mas-insegura/
:date: 2017-12-21
:category: retos
:subtitle: Solución al reto Main 4 de Hackthis
:description: Las rutas presentes en los directorios de nuestro sitio web pueden ser un medio para que los atacantes accedan a información confidencial. En el siguiente artículo hablaremos sobre la importancia de las rutas y resolveremos un reto de hacking utilizando rutas relativas.
:keywords: Seguridad, Web, Rutas, Credenciales, Reto, Hacking.
:author: Luis Arteaga
:tags: solucionar, web, reto
:image: road.png
:alt: Carro deportivo rojo arrojándose por un barranco
:writer: stiwar
:name: Luis Arteaga
:about1: Ingeniero en Electrónica y Telecomunicaciones.
:about2: Apasionado por el desarrollo de aplicaciones web/móviles, la seguridad informática y los videojuegos.
:figure-caption: Imagen

= ¡Qué ruta mas insegura!

En el mundo de la +Web+, es habitual encontrar sitios
con enlaces que redireccionan tanto a páginas o a recursos dentro del mismo,
como a páginas que se encuentran fuera de él.
Los primeros se conocen como *enlaces internos*
y los segundos como *enlaces externos*.

En cuanto a los enlaces internos, estos pueden ser referenciados
mediante rutas absolutas o relativas.
De lo cual hablaremos más adelante en secciones posteriores.
No hay duda alguna que los sitios +Web+ actuales hacen uso
de estas rutas relativas, sin embargo, existen desarrolladores +Web+ novatos
(y otros no tan novatos) que hacen mal uso de este recurso,
facilitando así, el trabajo de un hacker, que fácilmente
puede aprovecharse de esta vulnerabilidad y, en el peor de los casos,
anular completamente dicho servicio.

Por lo tanto hoy, continuando con nuestras sesiones sobre soluciones
a retos de *link:https://www.hackthis.co.uk[+hackthis+]*,
daremos solución a un reto en el cual debemos interpretar una ruta relativa.

== Rutas Relativas y Absolutas

Antes de resolver el reto, debemos conocer un poco
sobre cómo trabajan las rutas relativas y absolutas en una +URL+:

.Sistema de archivos de ejemplo
image::folders.png[ejemplo]

Todo servidor, al igual que nuestra computadora,
organiza los archivos y carpetas en un sistema denominado sistema de archivos.
Imaginemos que tenemos un sitio +Web+ cuyo dominio o dirección es:
+https://www.mipagina.com+ y que contiene los directorios mostrados
en la anterior imagen.

Por ejemplo, las páginas _pagina2.html_ y _pagina3.html_ se encuentran
a un mismo nivel, dado que ambas se encuentran en el directorio _a2_.
En este caso, si _pagina2.html_ dentro de su contenido referencia mediante un
enlace a _pagina3.html_, las +URL+ absoluta y relativa
(respecto a _pagina2.html_) para _pagina3.html_
quedarían de la siguiente manera:

* +URL+ absoluta: +https://www.mipagina.com/a/a2/pagina3.html+
* +URL+ relativa: pagina3.html

Como podemos ver, para este caso, fue mucho más sencillo
definir una ruta relativa para _pagina3.html_ que una absoluta.

Veamos otro ejemplo.
Si observamos los archivos _pagina1.html_ y _pagina4.html_,
estos se encuentran en los directorios _a_ y _c_ respectivamente.
Sin embargo, si queremos referenciar a _pagina4.html_ desde _pagina1.html_
mediante una ruta relativa, debemos indicar en la +URL+
que debemos subir un nivel en la jerarquía de carpetas
y luego acceder a la carpeta _c_ dado que ahí
se encuentra el archivo _pagina4.html_.
Para hacer esto, debemos utilizar el siguiente conjunto de caracteres
dentro la +URL+ relativa: +../+ .

Por lo tanto, las +URL+ absoluta y relativa (respecto a _pagina1.html_)
para _pagina4.html_ quedarían de la siguiente manera:

* +URL+ absoluta: +https://www.mipagina.com/c/pagina4.html+
* +URL+ relativa: ../c/pagina4.html

Podemos subir los niveles que queramos en la jerarquía de carpetas,
simplemente anidando expresiones +../+ .
El siguiente ejemplo aclara esta situación:

Supongamos que deseamos enlazar a _pagina4.html_ desde _pagina2.html_ .
En este caso, la +URL+ absoluta y relativa (respecto a _pagina2.html_)
para _pagina4.html_ quedarían así:

* +URL+ absoluta: +https://www.mipagina.com/c/pagina4.html+
* +URL+ relativa: ../../c/pagina4.html

== Reto: Main Level 4

Ahora que ya conocemos un poco sobre rutas absolutas y relativas en las +URL+,
podemos solucionar el *reto 4* de la categoría _Main_ del sitio +hackthis+.
Para ello, presionamos la siguiente combinación de teclas:
`ctrl+U` en tu navegador.
Una vez desplegado el código fuente del reto,
debemos buscar el siguiente formulario +HTML+:

image::html-code.png[codigo]

De la anterior imagen podemos ver que el formulario
contiene una etiqueta de tipo _hidden_
(un tipo de etiqueta cuyo contenido no es desplegado por el navegador,
pero que sin embargo podemos ver desde su código fuente).
En la propiedad _value_ de dicha etiqueta tenemos la siguiente información:
+../../extras/ssap.xml+ .

Al analizar dicha información podemos intuir que se trata de una +URL+ relativa,
tal y como vimos en la sección anterior.
Si nos fijamos al inicio de dicha ruta, podemos ver que sube dos niveles
y luego accede a la carpeta _extras_, donde se encuentra
un archivo llamado _ssap.xml_.
Por lo tanto, si la ruta del reto es
+https://www.hackthis.co.uk/levels/main/4+, al aplicar la ruta relativa
debemos subir desde las carpetas _4_ y _main_ hasta la carpeta _levels_.
Una vez estando ahí, podemos completar la ruta de la siguiente manera:
+https://www.hackthis.co.uk/levels/extras/ssap.xml+

Accedemos a dicha +URL+ para obtener:

.HackThis: solución al reto 4 de la categoría Main
image::answer-level-4.png[respuesta]

De la anterior imagen podemos ver que las credenciales de acceso son:
*999* y *911* para el usuario y contraseña, respectivamente.
Ingresamos dichas credenciales y el reto es resuelto.

A continuación dejo una animación resumiendo el proceso anterior:

.hackthis: animación y solución al reto MAIN 4
image::main4.gif[solucion]

Como podemos ver, tampoco es recomendable (y de hecho, nunca se debe hacer)
almacenar credenciales de acceso mediante rutas ocultas, y sobre todo,
con permisos para que cualquier usuario pueda visualizar su contenido.
Dado que estas pueden ser descubiertas por personas con intenciones maliciosas.
