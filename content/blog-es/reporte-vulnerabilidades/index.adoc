:slug: reporte-vulnerabilidades/
:date: 2018-10-25
:category: hacking
:subtitle: Reportando vulnerabilidades de forma responsable
:tags: seguridad, bug, vulnerabilidad, pentesting
:image: hackers.png
:alt: Vulnerability disclosure
:description: Cuando un analista de seguridad encuentra una nueva vulnerabilidad en un sistema o aplicación, ya sea de forma intencional o aleatoria, ¿Cómo puede proceder a reportarla para su futura remediación? Aqui explicamos las prácticas adecuadas para el reporte de vulnerabilidades.
:keywords: Securidad, CVE, Vulnerabilidad, Pentesting, Reporte, Políticas
:author: Jonathan Armas
:writer: johna
:name: Jonathan Armas
:about1: Systems Engineer, Security+
:about2: "Be formless, shapeless like water" Bruce Lee
:translate: vulnerability-disclosure/

= Ecosistema de vulnerabilidades

Una vulnerabilidad de seguridad
es una falencia o debilidad en un sistema o aplicación
que puede ser aprovechada por un atacante malicioso,
comprometiendo la confidencialidad, integridad o disponibilidad
tanto el +hardware+ como el +software+ de un sistema.

Nosotros como analistas de seguridad
(+pentesters+, Hackers de sombrero blanco)
encontramos cada día nuevas vulnerabilidades
en el software, los sistemas y procedimientos de nuestros clientes
que si son explotadas antes de ser arregladas
puede resultar en un gran problema,
tanto para los usuarios como para la compañía.

A pesar de que es crucial identificar y corregir vulnerabilidades,
y el proceso de reporte de vulnerabilidades
es parte de este ecosistema,
ejecutar pruebas de seguridad en sistemas sin permiso
puede acarrear problemas legales para el investigador.
Este riesgo puede ser reducido si aplicamos buenas prácticas
cuando vamos a reportar una vulnerabilidad.

Para entender como deberíamos reportar las vulnerabilidades
necesitamos conocer los actores que intervienen en el proceso:

*Descubridores*::
Individuos u organizaciones que encuentran las vulnerabilidades,
pueden ser investigadores, compañías de seguridad, usuarios, entre otros.

*Vendedores*::
Desarrollan y mantienen los productos del sistema que pueden ser vulnerables,
esto incluye grandes vendedores de software
así como pequeños grupos de desarrollo de software libre.

*Coordinadores*::
Administran la respuesta del vendedor frente a las vulnerabilidades,
ellos sirven como evaluadores de severidad independientes e imparciales
y pueden actuar como un intermediario entre los vendedores y el público.

*Usuarios*::
Cualquiera que utilice el producto del vendedor
que puede ser afectado por la vulnerabilidad.

== Reporte responsable de vulnerabilidades

Para evitar problemas legales
y tener una resolución de vulnerabilidades bien intencionada
debemos seguir un plan estructurado.
El ciclo de vida del reporte de vulnerabilidades se muestra a continuación:

["graphviz", "vulnlifecycle.png"]
----
digraph G {
rankdir=TD;
  subgraph cluster_0 {
    label="Analista de Seguridad";
    style=filled;
    color=lightgrey;
    node [style=filled,color=white];
    "Descubrimiento" -> "Notificación"
  };

  subgraph cluster_1 {
    label="Vendedor";
    style=filled;
    color=lightblue;
    node [style=filled,color=white];
    "Investigar" -> "Vulnerabilidad Confirmada" -> "Arreglar"
    "Vulnerabilidad no confirmada"
  };
"Arreglar" -> "Liberar" -> "Parar";
"Notificación" -> "Investigar"
"Parar"[shape=square, color=salmon2];
"Descubrimiento"[shape=square];
"Investigar"-> "Vulnerabilidad no confirmada" -> "Parar"[color=red];
label="Ciclo de vida de reporte de vulnerabilidades";
labelloc=top;
  size="8,5";
}
----

Un investigador de seguridad,
ya sea una organización o un individuo
intenta descubrir nuevas vulnerabilidades
en un sistema o aplicación.
Ellos prueban y validan la vulnerabilidad
al desarrollar un proceso reproducible
para verificar sus efectos.

Luego el/ella comunica sus descubrimientos
al vendedor del software.
Esto podría hacerse directamente con el vendedor
o con un coordinador como un +CSIRT+
(Computer Security Incident Response Team).

A continuación, el vendedor investiga la vulnerabilidad
y si existe, empieza a trabajar en una nueva versión o una contramedida.
Cuando termina de arreglarlo libera la nueva versión
junto con la información de la vulnerabilidad.

Comunicar la vulnerabilidad es la parte más importante del proceso.
En este paso se pone a prueba la madurez
tanto del vendedor como del investigador.
Aquí podemos establecer algunas buenas prácticas
que un analista de seguridad puede utilizar
en el momento de reportar una vulnerabilidad:

* Notificar la compañía
* Si la comunicación falla,
intentarlo varias veces con varias personas en la cadena de mando
* Si la comunicación con el vendedor falla,
intentar con el +CSIRT+ nacional
* Si nada de lo anterior funciona,
reportar la vulnerabilidad con ayuda del +CSIRT+

Cada paso tiene un periodo de tiempo,
hay muchas metodologías que sugieren diferentes periodos de espera.
Algunas presentan una política de reporte de +45+ días,
otras +90+ días a partir de la notificación
(*nosotros recomendamos ésta última*).
En cualquier caso, es necesario ser flexible,
ya que estos periodos pueden cambiar.
La comunicación es clave en estos casos.

El vendedor debería proveer actualizaciones de estado de la vulnerabilidad
e intentar resolverla dentro del periodo de tiempo.
Pueden pedir una prórroga,
en donde el descrubridor y el coordinador
no darán a conocer detalles de la vulnerabilidad.
Todo depende de la severidad de la misma
o de la dificultad para resolverla.

Cuando la vulnerabilidad es arreglada,
es común que el vendedor le dé crédito al descubridor,
usualmente colocándolo en las notas de la nueva versión,
algunos de ellos reciben recompensas por el hallazgo
donde se les entrega dinero a los investigadores.

El reporte de vulnerabilidades es un proceso delicado,
pero también muy gratificante para todas las partes involucradas.
Es bien conocido que hoy en día
existen muchas vulnerabilidades de seguridad y fugas de información
que son aprovechadas por atacantes maliciosos.
Un entorno benigno donde investigadores y vendedores
puedan trabajar en conjunto para para encontrar y corregir
las vulnerabilidades críticas
antes de que puedan afectar a alguien
es una situación donde todos ganan.

== Referencias

* link:https://tools.ietf.org/html/draft-christey-wysopal-vuln-disclosure-00#section-3.3[IETF Responsible Vulnerability Disclosure Process]
* link:https://googleprojectzero.blogspot.com/2015/02/feedback-and-data-driven-updates-to.html[Google Project Zero]
* link:https://www.microsoft.com/en-us/msrc/cvd?rtc=1[Microsoft Coordinated Vulnerability Disclosure]
* link:https://vuls.cert.org/confluence/display/Wiki/Vulnerability+Disclosure+Policy[US CERT Vulnerability Disclosure Policy]
* link:https://www.owasp.org/index.php/Vulnerability_Disclosure_Cheat_Sheet[OWASP Vulnerability Disclosure Cheat Sheet]
* link:https://www.enisa.europa.eu/publications/vulnerability-disclosure[ENISA Guide on Vulnerability Disclosure]
* link:https://www.rapid7.com/security/disclosure/[Rapid7 Vulnerability Disclosure Policy]
