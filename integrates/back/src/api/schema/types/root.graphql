"Root interface definition"
interface IRoot {
  "ID of the root"
  id: ID!
  "Nickname for the root"
  nickname: String!
  "Whether the root is active or not"
  state: ResourceState!
}

"Git Root cloning status definition"
type GitRootCloningStatus {
  "Full SHA-1 hash of the cloned repo"
  commit: String
  "Message after repository cloning"
  message: String!
  "Cloning status of GitRoot"
  status: CloningStatus!
}

"Git Root environment url definition"
type GitEnvironmentUrl {
  "Environment url"
  url: String!
}

"Credentials associated to a root"
type Credentials {
  "ID of the credential"
  id: String!
  "Name of the credential"
  name: String!
  "Type of authentication of the credential"
  type: String!
}

"Git Root type definition"
type GitRoot implements IRoot {
  "Repository branch to be tested"
  branch: String!
  "Cloning status of GitRoot"
  cloningStatus: GitRootCloningStatus!
  "Credentials used to clone the repository"
  credentials: Credentials!
  "Kind of environment to test. E.g. production, QA, etc."
  environment: String!
  "URLs to access the environment"
  environmentUrls: [String!]!
  "URLs to access the environment"
  gitEnvironmentUrls: [GitEnvironmentUrl]!
  "Repository paths to be ignored"
  gitignore: [String!]!
  "ID of the root"
  id: ID!
  "Analyze already existing code"
  includesHealthCheck: Boolean!
  "Last time the root cloning state was modified"
  lastCloningStatusUpdate: DateTime!
  "Machine executions for the root"
  lastMachineExecutions: LastMachineExecutions!
  "Last time the root status was modified"
  lastStateStatusUpdate: DateTime!
  "Last time the root status was modified"
  lastStatusUpdate: DateTime!
    @deprecated(
      reason: """
      This field will be removed
      after 2022/02/03. Use `lastStateStatusUpdate`.
      """
    )
  "Nickname for the repository"
  nickname: String!
  "Whether the root is active or not"
  state: ResourceState!
  "Repository URL"
  url: String!
  "Vulnerabilities associated to the root"
  vulnerabilities: [Vulnerability!]
}

"IP Root type definition"
type IPRoot implements IRoot {
  "IP address of the environment to test"
  address: String!
  "ID of the root"
  id: ID!
  "Nickname for the root"
  nickname: String!
  "Indicates the port to test. Zero means all ports"
  port: Int!
  "Whether the root is active or not"
  state: ResourceState!
  "Vulnerabilities associated to the root"
  vulnerabilities: [Vulnerability!]
}

"URL Root type definition"
type URLRoot implements IRoot {
  "Domain name or IP of the environment to test"
  host: String!
  "ID of the root"
  id: ID!
  "Nickname for the root"
  nickname: String!
  "URL path"
  path: String!
  "URL port"
  port: Int!
  "URL protocol"
  protocol: URLProtocol!
  "Whether the root is active or not"
  state: ResourceState!
  "Vulnerabilities associated to the root"
  vulnerabilities: [Vulnerability!]
}
