from api.resolvers.vulnerability import (
    analyst,
    historic_verification,
    historic_zero_risk,
    last_reattack_requester,
)
from ariadne import (
    ObjectType,
)

VULNERABILITY = ObjectType("Vulnerability")
VULNERABILITY.set_alias("externalBugTrackingSystem", "external_bts")

VULNERABILITY.set_field("hacker", analyst.resolve)
VULNERABILITY.set_field("historicVerification", historic_verification.resolve)
VULNERABILITY.set_field("historicZeroRisk", historic_zero_risk.resolve)
VULNERABILITY.set_field(
    "lastReattackRequester", last_reattack_requester.resolve
)

# --------------------------- Deprecated fields -------------------------------
VULNERABILITY.set_field("analyst", analyst.resolve)
