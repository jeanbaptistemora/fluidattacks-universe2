from db_model.findings.types import (
    Finding,
)
from db_model.vulnerabilities.types import (
    Vulnerability,
)
from graphql.type.definition import (
    GraphQLResolveInfo,
)
import newrelic.agent


@newrelic.agent.function_trace()
async def resolve(
    parent: Vulnerability,
    info: GraphQLResolveInfo,
    **_kwargs: None,
) -> str:
    finding: Finding = await info.context.loaders.finding.load(
        parent.finding_id
    )

    return finding.group_name
