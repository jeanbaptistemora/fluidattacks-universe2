{% extends "layouts/common.html" %}
{% from 'layouts/components/forms.html' import banner_group %}

{% block layout %}
<div class="container">
  {% include 'layouts/components/logo_header.html' %}
  {{ banner_group('Progress Report') }}

  <div class="main-content">
    <p>Hello {{ name }},</p>
    <p>
      Enumerated: {{ count_var_report["enumerated"]["count"] }} inputs.
      ({{ count_var_report["enumerated"]["variation"] }})<br />

      Verified: {{ count_var_report["verified"]["count"] }} inputs,

      {{ "%.1f"|format(count_var_report["loc"]["count"] / 1000) }}k lines.
      ({{ count_var_report["verified"]["variation"] }})<br />

      Reatacked: {{ count_var_report["reattacked"]["count"] }} vulnerabilities.
      ({{ count_var_report["reattacked"]["variation"] }})<br />

      Drafts: {{ count_var_report["draft_created"]["count"] }} vulnerabilities.
      (oldest: {{ oldest_draft["age"] }} days,
      max: {{ oldest_draft["max_cvss"] }} severity)<br />

      Released: {{ count_var_report["released"]["count"] }} vulnerabilities.
      ({{ count_var_report["released"]["variation"] }},
      max: {{ max_cvss }} severity)
    </p>
    <p>
      Group details:<br />
      {% if groups %}
        {% for group, fields in groups.items() %}
          <strong>{{ group }}</strong>:
          {{ fields["enumerated"] }} inputs enumerated,
          {{ fields["verified"] }} inputs verified,
          {{ "%.1f"|format(fields["loc"] / 1000) }}k lines verified,
          {{ fields["reattacked"] }} reattacked,
          {{ fields["draft_created"] }} drafts,
          {{ fields["released"] }} released.<br />
        {% endfor %}
      {% endif %}
    </p>
    <p>Regards,<br />Fluid Attacks Team</p>
  </div>

  {% include 'layouts/components/footer.html' %}
</div>
{% endblock %}
