<!--
SPDX-FileCopyrightText: 2022 Fluid Attacks <development@fluidattacks.com>

SPDX-License-Identifier: MPL-2.0
-->

{% extends "layouts/common.html" %}
  {% from 'layouts/components/forms.html' import banner_finding, go_to_button %}
  {% block layout %}
    <div class="container">
      {% include 'layouts/components/dark_logo_header.html' %}

      {% include 'layouts/components/arm_banner.html' %}
      {{ banner_finding('Vulnerability Alert') }}
      <div class="main-content">
        <p>Hi {{ name }},</p>
        <p>
          A vulnerability
          {% if is_escape %}
          with escape(s)
          {% endif %}
          in the group <strong>{{ group }}</strong>
          has been <strong>{{ state }}</strong>
          {%- if is_escape %}
          by
          <strong><a
            href="mailto:{{ responsible }}"
            target="_blank"
            rel="noopener noreferrer"
            style="color: #ff3435;"
          >
            {{ responsible -}}
          </a></strong>
          {%- endif -%}:
        </p>
        <p>
          <strong>Type of vulnerability:</strong> {{ finding }}.<br/>
          <strong>Severity (CVSS):</strong> {{ severity_score }} - {{ severity_level }}.
        </p>
        <ul style="padding: 1rem;line-height: 30px;">
          {% for prop_key, prop_value in vulns_props.items() %}
          <li>
            <strong>Location:</strong>
            {{ prop_value["location"] }}
            {% if prop_value["specific"] %}
            ({{ prop_value["specific"] }})
            {% endif %}
            {% if is_escape and prop_value["source"] == "ESCAPE" %}
            <strong>({{ prop_value["source"].lower() }})</strong>
            {% endif %}
          </li>
          <ul>
            {% for key, value in prop_value.items() %}
              {% if key not in ["location", "specific", "source"] %}
            <li><strong>{{ key.capitalize() }}:</strong> {{ value }}</li>
              {% endif %}
            {% endfor %}
          </ul>
          {% endfor %}
        </ul>
        <p>
          Regards,<br>
          Fluid Attacks Team
        </p>
        {{ go_to_button('Go to type of vulnerability', finding_url, 'primary-button') }}
        <br />
      </div>
      {% include 'layouts/components/footer.html' %}

    </div>
  {% endblock %}
