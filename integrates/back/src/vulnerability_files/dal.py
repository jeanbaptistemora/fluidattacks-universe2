# SPDX-FileCopyrightText: 2022 Fluid Attacks <development@fluidattacks.com>
#
# SPDX-License-Identifier: MPL-2.0

from context import (
    FI_AWS_S3_MAIN_BUCKET as VULNS_BUCKET,
)
from s3 import (
    operations as s3_ops,
)
from starlette.datastructures import (
    UploadFile,
)


async def sign_vuln_file_url(vuln_file_name: str) -> str:
    return await s3_ops.sign_url(f"reports/{vuln_file_name}", 10, VULNS_BUCKET)


async def upload_vuln_file_to_s3(vuln_file: UploadFile) -> str:
    file_path: str = vuln_file.filename
    file_name: str = file_path.split("/")[-1]
    await s3_ops.upload_memory_file(
        VULNS_BUCKET,
        vuln_file,
        f"reports/{file_name}",
    )
    return file_name
