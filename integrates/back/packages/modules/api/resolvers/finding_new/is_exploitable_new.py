from decimal import Decimal

from graphql.type.definition import GraphQLResolveInfo

from db_model.findings.types import (
    Finding,
    Finding31Severity,
)


def resolve(
    parent: Finding, _info: GraphQLResolveInfo, **_kwargs: None
) -> bool:
    if isinstance(parent.severity, Finding31Severity):
        is_exploitable = parent.severity.exploitability >= Decimal("0.97")
    else:
        is_exploitable = parent.severity.exploitability in {
            Decimal("1.0"),
            Decimal("0.95"),
        }
    return is_exploitable
