{
  "ModelName": "database-design",
  "ModelMetadata": {
    "Author": "development@fluidattacks.com",
    "DateCreated": "Feb 08, 2021, 10:37 AM",
    "DateLastModified": "Feb 19, 2021, 07:28 AM",
    "Description": "",
    "AWSService": "Amazon DynamoDB",
    "Version": "2.0"
  },
  "DataModel": [
    {
      "TableName": "integrates_vms",
      "KeyAttributes": {
        "PartitionKey": {
          "AttributeName": "pk",
          "AttributeType": "S"
        },
        "SortKey": {
          "AttributeName": "sk",
          "AttributeType": "S"
        }
      },
      "NonKeyAttributes": [
        {
          "AttributeName": "access_token",
          "AttributeType": "M"
        },
        {
          "AttributeName": "push_tokens",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "registered_date",
          "AttributeType": "S"
        },
        {
          "AttributeName": "last_login_date",
          "AttributeType": "S"
        },
        {
          "AttributeName": "name",
          "AttributeType": "S"
        },
        {
          "AttributeName": "legal_remember",
          "AttributeType": "BOOL"
        },
        {
          "AttributeName": "email",
          "AttributeType": "S"
        },
        {
          "AttributeName": "role",
          "AttributeType": "S"
        },
        {
          "AttributeName": "responsibility",
          "AttributeType": "S"
        },
        {
          "AttributeName": "subscription_period",
          "AttributeType": "N"
        },
        {
          "AttributeName": "settings",
          "AttributeType": "M"
        },
        {
          "AttributeName": "description",
          "AttributeType": "S"
        },
        {
          "AttributeName": "type",
          "AttributeType": "S"
        },
        {
          "AttributeName": "status",
          "AttributeType": "S"
        },
        {
          "AttributeName": "language",
          "AttributeType": "S"
        },
        {
          "AttributeName": "tags",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "change_reason",
          "AttributeType": "S"
        },
        {
          "AttributeName": "has_drills",
          "AttributeType": "BOOL"
        },
        {
          "AttributeName": "has_forces",
          "AttributeType": "BOOL"
        },
        {
          "AttributeName": "modified_date",
          "AttributeType": "S"
        },
        {
          "AttributeName": "exit_code",
          "AttributeType": "S"
        },
        {
          "AttributeName": "branch",
          "AttributeType": "S"
        },
        {
          "AttributeName": "commit",
          "AttributeType": "S"
        },
        {
          "AttributeName": "origin",
          "AttributeType": "S"
        },
        {
          "AttributeName": "repo",
          "AttributeType": "S"
        },
        {
          "AttributeName": "strictness",
          "AttributeType": "S"
        },
        {
          "AttributeName": "results",
          "AttributeType": "M"
        },
        {
          "AttributeName": "url",
          "AttributeType": "S"
        },
        {
          "AttributeName": "environment",
          "AttributeType": "S"
        },
        {
          "AttributeName": "environment_urls",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "gitignore",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "includes_health_check",
          "AttributeType": "BOOL"
        },
        {
          "AttributeName": "modified_by",
          "AttributeType": "S"
        },
        {
          "AttributeName": "cloning_status",
          "AttributeType": "S"
        },
        {
          "AttributeName": "cloning_message",
          "AttributeType": "S"
        },
        {
          "AttributeName": "context",
          "AttributeType": "S"
        },
        {
          "AttributeName": "evidences",
          "AttributeType": "M"
        },
        {
          "AttributeName": "action_before_blocking",
          "AttributeType": "S"
        },
        {
          "AttributeName": "action_after_blocking",
          "AttributeType": "S"
        },
        {
          "AttributeName": "blocking_hours_expected",
          "AttributeType": "N"
        },
        {
          "AttributeName": "blocking_hours",
          "AttributeType": "N"
        },
        {
          "AttributeName": "affected_components",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "accessibility",
          "AttributeType": "S"
        },
        {
          "AttributeName": "parent_id",
          "AttributeType": "S"
        },
        {
          "AttributeName": "content",
          "AttributeType": "S"
        },
        {
          "AttributeName": "cvss",
          "AttributeType": "M"
        },
        {
          "AttributeName": "recommendation",
          "AttributeType": "S"
        },
        {
          "AttributeName": "requirements",
          "AttributeType": "SS"
        },
        {
          "AttributeName": "threat",
          "AttributeType": "S"
        },
        {
          "AttributeName": "source",
          "AttributeType": "S"
        },
        {
          "AttributeName": "using_sorts",
          "AttributeType": "BOOL"
        },
        {
          "AttributeName": "cwe",
          "AttributeType": "S"
        },
        {
          "AttributeName": "attack_vector",
          "AttributeType": "S"
        },
        {
          "AttributeName": "consult_id",
          "AttributeType": "S"
        },
        {
          "AttributeName": "where",
          "AttributeType": "S"
        },
        {
          "AttributeName": "specific",
          "AttributeType": "S"
        },
        {
          "AttributeName": "deletion_reason",
          "AttributeType": "S"
        },
        {
          "AttributeName": "accepted_until",
          "AttributeType": "S"
        },
        {
          "AttributeName": "accepted_reason",
          "AttributeType": "S"
        },
        {
          "AttributeName": "manager",
          "AttributeType": "S"
        }
      ],
      "TableFacets": [
        {
          "FacetName": "user_metadata",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "USER#email",
            "SortKeyAlias": "USER#email"
          },
          "TableData": [
            {
              "pk": {
                "S": "USER#test@fluidattacks.com"
              },
              "sk": {
                "S": "USER#test@fluidattacks.com"
              },
              "access_token": {
                "M": {
                  "iat": {
                    "N": "123"
                  },
                  "jti": {
                    "S": "123"
                  },
                  "salt": {
                    "S": "123"
                  }
                }
              },
              "push_tokens": {
                "SS": [
                  "ExponentPushToken[123]"
                ]
              },
              "registered_date": {
                "S": "2020-06-10 08:00:26"
              },
              "last_login_date": {
                "S": "2021-02-12 17:36:42"
              },
              "name": {
                "S": "Test user"
              },
              "legal_remember": {
                "BOOL": false
              },
              "email": {
                "S": "test@fluidattacks.com"
              }
            }
          ],
          "NonKeyAttributes": [
            "access_token",
            "push_tokens",
            "registered_date",
            "last_login_date",
            "name",
            "legal_remember",
            "email"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "organization_membership",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "USER#email",
            "SortKeyAlias": "ORG#name"
          },
          "TableData": [
            {
              "pk": {
                "S": "USER#test@fluidattacks.com"
              },
              "sk": {
                "S": "ORG#okada"
              },
              "role": {
                "S": "group_manager"
              },
              "subscription_period": {
                "N": "86400"
              }
            }
          ],
          "NonKeyAttributes": [
            "role",
            "subscription_period"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "group_membership",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "USER#email",
            "SortKeyAlias": "GROUP#name"
          },
          "TableData": [
            {
              "pk": {
                "S": "USER#test@fluidattacks.com"
              },
              "sk": {
                "S": "GROUP#unittesting"
              },
              "role": {
                "S": "group_manager"
              },
              "responsibility": {
                "S": "Product owner"
              },
              "subscription_period": {
                "N": "86400"
              }
            }
          ],
          "NonKeyAttributes": [
            "role",
            "responsibility",
            "subscription_period"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "organization_metadata",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "ORG#name#METADATA"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "ORG#okada#METADATA"
              },
              "name": {
                "S": "okada"
              }
            }
          ],
          "NonKeyAttributes": [
            "name"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "organization_historic",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name#HISTORIC#iso8601utc",
            "SortKeyAlias": "ORG#name"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada#HISTORIC#2021-02-15T14:01:16Z"
              },
              "sk": {
                "S": "ORG#okada"
              },
              "settings": {
                "M": {
                  "max_acceptance_days": {
                    "N": "0"
                  },
                  "max_acceptance_severity": {
                    "N": "0.0"
                  },
                  "min_acceptance_severity": {
                    "N": "0.0"
                  },
                  "max_number_acceptations": {
                    "N": "0"
                  }
                }
              },
              "modified_date": {
                "S": "2021-02-15T14:01:16Z"
              },
              "modified_by": {
                "S": "USER#test@fluidattacks.com"
              }
            }
          ],
          "NonKeyAttributes": [
            "settings",
            "modified_date",
            "modified_by"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "group_metadata",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "GROUP#name#METADATA"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#METADATA"
              },
              "name": {
                "S": "unittesting"
              },
              "description": {
                "S": "Test group"
              },
              "language": {
                "S": "en"
              }
            }
          ],
          "NonKeyAttributes": [
            "name",
            "description",
            "language"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "group_historic",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "GROUP#name#HISTORIC#iso8601utc",
            "SortKeyAlias": "GROUP#name"
          },
          "TableData": [
            {
              "pk": {
                "S": "GROUP#unittesting#HISTORIC#2021-02-15T14:01:16Z"
              },
              "sk": {
                "S": "GROUP#unittesting"
              },
              "type": {
                "S": "CONTINUOUS"
              },
              "status": {
                "S": "ACTIVE"
              },
              "tags": {
                "SS": [
                  "test"
                ]
              },
              "change_reason": {
                "S": "BUDGET"
              },
              "has_drills": {
                "BOOL": true
              },
              "has_forces": {
                "BOOL": false
              },
              "modified_date": {
                "S": "2021-02-15T14:01:16Z"
              },
              "modified_by": {
                "S": "USER#test@fluidattacks.com"
              }
            }
          ],
          "NonKeyAttributes": [
            "type",
            "status",
            "tags",
            "change_reason",
            "has_drills",
            "has_forces",
            "modified_date",
            "modified_by"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "forces_execution",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "GROUP#name#EXEC#uuid"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#EXE#b68e1063-18da-44d1-9d1a-295299a9fee7"
              },
              "type": {
                "S": "all"
              },
              "modified_date": {
                "S": "2021-02-15T14:01:16Z"
              },
              "exit_code": {
                "S": "1"
              },
              "branch": {
                "S": "unable to retrieve"
              },
              "commit": {
                "S": "76bd6dbbba2d1864c09ba9af5be134728de8bdd2"
              },
              "origin": {
                "S": "https://gitlab-ci-token:test@gitlab.com/company/test.git"
              },
              "repo": {
                "S": "test"
              },
              "strictness": {
                "S": "strict"
              },
              "results": {
                "M": {
                  "M": {
                    "num_of_accepted_vulnerabilities": {
                      "N": "0"
                    },
                    "num_of_closed_vulnerabilities": {
                      "N": "238"
                    },
                    "num_of_open_vulnerabilities": {
                      "N": "8"
                    }
                  }
                }
              }
            }
          ],
          "NonKeyAttributes": [
            "type",
            "modified_date",
            "exit_code",
            "branch",
            "commit",
            "origin",
            "repo",
            "strictness",
            "results"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "root",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "GROUP#name",
            "SortKeyAlias": "ROOT#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "type",
            "status",
            "modified_date",
            "branch",
            "url",
            "environment",
            "environment_urls",
            "gitignore",
            "includes_health_check",
            "modified_by",
            "cloning_status",
            "cloning_message"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "event_metadata",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "GROUP#name#EVENT#uuid"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#EVENT#01405804-4c10-400f-97b4-87661af5f0ae"
              },
              "description": {
                "S": "Después de iniciar sesión, el servidor devuelve error"
              },
              "type": {
                "S": "INCORRECT_MISSING_SUPPLIES"
              },
              "context": {
                "S": "TELECOMMUTING"
              },
              "evidences": {
                "M": {}
              },
              "action_before_blocking": {
                "S": "EXECUTE_OTHER_PROJECT_SAME_CLIENT"
              },
              "action_after_blocking": {
                "S": "OTHER"
              },
              "blocking_hours_expected": {
                "N": "1"
              },
              "blocking_hours": {
                "N": "2"
              },
              "affected_components": {
                "SS": [
                  "Inestabilidad del ToE",
                  "Indisponibilidad del ToE"
                ]
              },
              "accessibility": {
                "S": "Ambiente"
              }
            }
          ],
          "NonKeyAttributes": [
            "description",
            "type",
            "context",
            "evidences",
            "action_before_blocking",
            "action_after_blocking",
            "blocking_hours_expected",
            "blocking_hours",
            "affected_components",
            "accessibility"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "group_comment",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "GROUP#name#CMNT#uuid"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#CMNT#8207c89a-27e2-4abe-9367-3ffea7856a4d"
              },
              "type": {
                "S": "CONSULT"
              },
              "modified_date": {
                "S": "2021-02-15T14:01:16Z"
              },
              "modified_by": {
                "S": "USER#test@fluidattacks.com"
              },
              "content": {
                "S": "comment"
              }
            },
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#CMNT#851cbc02-416e-43c7-ad30-a2af6328f748"
              },
              "type": {
                "S": "OBSERVATION"
              },
              "modified_date": {
                "S": "2021-02-15T14:01:16Z"
              },
              "modified_by": {
                "S": "USER#test@fluidattacks.com"
              },
              "content": {
                "S": "comment"
              }
            }
          ],
          "NonKeyAttributes": [
            "type",
            "modified_date",
            "modified_by",
            "parent_id",
            "content"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "finding_metadata",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "ORG#name",
            "SortKeyAlias": "GROUP#name#FIN#uuid"
          },
          "TableData": [
            {
              "pk": {
                "S": "ORG#okada"
              },
              "sk": {
                "S": "GROUP#unittesting#FIN#a0fddb36-ac0d-4a58-969f-b13194af61c2"
              },
              "name": {
                "S": "F035. Weak credential policy"
              },
              "description": {
                "S": "Passwords set as date-user could be easily guessed"
              },
              "type": {
                "S": "SECURITY"
              },
              "evidences": {
                "M": {}
              },
              "affected_components": {
                "SS": [
                  "web app"
                ]
              },
              "cvss": {
                "M": {}
              },
              "recommendation": {
                "S": "Consider changing the date-user standard."
              },
              "requirements": {
                "SS": [
                  "REQ.0132. The system must require passphrases to be at least 4 words long and allow them to have 64 characters or more."
                ]
              },
              "threat": {
                "S": "External attacker with access"
              },
              "using_sorts": {
                "BOOL": false
              },
              "cwe": {
                "S": "521"
              },
              "attack_vector": {
                "S": "Guess passwords"
              }
            }
          ],
          "NonKeyAttributes": [
            "name",
            "description",
            "type",
            "evidences",
            "affected_components",
            "cvss",
            "recommendation",
            "requirements",
            "threat",
            "using_sorts",
            "cwe",
            "attack_vector"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "reattack",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "FINDING#uuid",
            "SortKeyAlias": "REATTACK#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "status",
            "modified_date",
            "modified_by",
            "consult_id"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "reattack_vulnerabilities",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "FINDING#uuid",
            "SortKeyAlias": "VULN#uuid"
          },
          "TableData": [],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "vulnerability",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "FINDING#uuid",
            "SortKeyAlias": "VULN#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "type",
            "status",
            "tags",
            "modified_date",
            "modified_by",
            "source",
            "where",
            "specific",
            "deletion_reason"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "treatment",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "VULN#uuid",
            "SortKeyAlias": "TREATMENT#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "status",
            "modified_date",
            "modified_by",
            "accepted_until",
            "accepted_reason",
            "manager"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "finding_historic",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "FIN#uuid#HISTORIC#iso8601utc",
            "SortKeyAlias": "FIN#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "status",
            "change_reason",
            "modified_date",
            "modified_by",
            "source"
          ],
          "DataAccess": {
            "MySql": {}
          }
        },
        {
          "FacetName": "event_historic",
          "KeyAttributeAlias": {
            "PartitionKeyAlias": "EVENT#uuid#HISTORIC#iso8601utc",
            "SortKeyAlias": "EVENT#uuid"
          },
          "TableData": [],
          "NonKeyAttributes": [
            "status",
            "modified_date",
            "modified_by"
          ],
          "DataAccess": {
            "MySql": {}
          }
        }
      ],
      "GlobalSecondaryIndexes": [
        {
          "IndexName": "inverted_index",
          "KeyAttributes": {
            "PartitionKey": {
              "AttributeName": "sk",
              "AttributeType": "S"
            },
            "SortKey": {
              "AttributeName": "pk",
              "AttributeType": "S"
            }
          },
          "Projection": {
            "ProjectionType": "ALL"
          }
        }
      ],
      "DataAccess": {
        "MySql": {}
      }
    }
  ]
}