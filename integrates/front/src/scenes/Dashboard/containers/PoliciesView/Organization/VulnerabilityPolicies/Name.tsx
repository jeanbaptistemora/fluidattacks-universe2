/*
 * SPDX-FileCopyrightText: 2022 Fluid Attacks <development@fluidattacks.com>
 *
 * SPDX-License-Identifier: MPL-2.0
 */

import _ from "lodash";
import type { FC } from "react";
import React from "react";

import type { IVulnerabilityPoliciesData } from "./types";

import { ExternalLink } from "components/ExternalLink";
import type { ICellHelper } from "components/Table/types";

type TPoliciesName = ICellHelper<IVulnerabilityPoliciesData>;

const baseUrl = "https://docs.fluidattacks.com/criteria/vulnerabilities/";

const PoliciesName: FC<TPoliciesName> = ({
  getValue,
}: Readonly<TPoliciesName>): JSX.Element => {
  const name = getValue<string>();

  return (
    <ExternalLink href={`${baseUrl}${_.first(name.split(".")) ?? ""}`}>
      {name}
    </ExternalLink>
  );
};

export { PoliciesName as policiesName };
