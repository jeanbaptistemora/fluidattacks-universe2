/* eslint-disable react/require-default-props */
import _ from "lodash";
import React from "react";

import { Container } from "components/Container";
import { Col, Gap, Row } from "components/Layout";
import {
  formatState,
  formatStatus,
} from "scenes/Dashboard/containers/GroupFindingsView/utils";

interface IVulnFormatProps {
  specific: string;
  where: string;
  reattack?: string;
  source?: string;
  status?: string;
  treatment?: string;
}

const VulnerabilityFormat: React.FC<IVulnFormatProps> = ({
  where,
  specific,
  status,
  source,
  reattack,
  treatment,
}: IVulnFormatProps): JSX.Element => {
  return (
    <Container minHeight={"54px"} minWidth={"550px"}>
      <Row>
        <Col>
          {where}
          {"|"}
          {specific}
        </Col>
      </Row>
      <Row align={"center"} justify={"between"}>
        <Col lg={80} md={80} sm={80}>
          <Gap>
            {!_.isUndefined(status) && formatState(status)}
            {!_.isUndefined(source) && formatStatus(source)}
            {!_.isUndefined(treatment) && formatStatus(treatment)}
            {!_.isUndefined(reattack) && formatStatus(reattack)}
          </Gap>
        </Col>
      </Row>
    </Container>
  );
};

const vulnerabilityFormatter = ({
  specific,
  where,
  reattack,
  source,
  status,
  treatment,
}: IVulnFormatProps): JSX.Element => {
  return (
    <VulnerabilityFormat
      reattack={reattack}
      source={source}
      specific={specific}
      status={status}
      treatment={treatment}
      where={where}
    />
  );
};

export { VulnerabilityFormat, vulnerabilityFormatter };
